!function(B,t,Z){"use strict";var s="ht",g=B[s],U=g.Default,c=g.graph,R=U.getInternal(),i=R.ui(),C=i.NodeUI.prototype,P=i.ShapeUI.prototype,n=c.GraphView,S=n.prototype,M=i.EdgeUI.prototype,E=g.Node,L=g.Shape,T=g.Edge,G=g.Group,A=U.isTouchable,o=U.preventDefault,x=B.setTimeout,e=U.grow,l=U.isDragging,X=U.getDistance,O=null,p=g.List,D="undefined"!=typeof Float32Array?Float32Array:Array,u=Math,W=u.PI,F="Crossing",$="No Crossing",k=W/2,m=2*W,_=u.atan2,V=u.sqrt,r=u.pow,N=u.sin,q=u.cos,a=u.min,I=u.max,z=u.abs,Q=u.ceil,f=u.round,K=U.unionPoint,y=U.unionRect,h=U.containsPoint,b=U.clone,H="rgb(52, 152, 219)",J="red",w={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},Y={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var $=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],M=0;M<$.length;M++){var C=$[M];C=0===M%2?C/400*Y.width:C/100*Y.height,$[M]=C}return Y.width>120&&($[4]=Y.width-26,$[6]=Y.width-40,$[10]=Y.width-40,$[12]=Y.width-26,$[18]=33),$}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},j={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:H,rotation:.61},{type:"circle",rect:[200,120,70,70],background:H,rotation:.61},{type:"circle",rect:[200,220,70,70],background:H,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:H},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:H}]},v={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:J,rotation:.61}]},d={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:H},{type:"circle",rect:[0,210,90,90],background:H},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:H}]},qm={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:J},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:J}]},dg={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:H}]},hh={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:J}]},bg={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Qr={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Sr=function(R){var u=R.touches[0];return u?u:R.changedTouches[0]},me=function(y,k,G,F){return _(F-k,G-y)},Rl=function(Z,z){return{x:Z.x*z,y:Z.y*z}},pb=function(F,h){var p,L,v,K,R=F._layers,U=F.sm().getSelection()._as,Q=U.length;if(R)for(p=0;p<R.length;p++){K=R[p];for(var c=0;Q>c;c++)if(L=U[c],L._layer===K&&(v=h(L),v===!1))return}else for(p=0;Q>p;p++)if(L=U[p],v=h(L),v===!1)return},Zg=function(H,a,d){var T,j,U,k,n,u=this,K=a,z=u.gv;if(H instanceof L){U=H.getSegments();var w=z.getDataUI(H);n=w._55O.$15l,U||(U=vb(n)),H.isClosePath()&&U.indexOf(5)<0&&(U=new p(U._as),U.add(5)),T=Un(H,w,K),j=n[T]}else{var x=z.getDataUI(H);n=Wq(x,H.s("edge.points")),U=H.s("edge.segments"),U||(U=vb(n)),n=n._as,T=Un(H,x,K),j=n[T]}if(U&&(k=U.get(K)),2===k||1===k||5===k){var t=n[T+1];5===k&&(t=n[0]);var o=sl(j,d,t);return o}return d},Mg=function(f,H){var N,w,J,d,e=f._layers,G=f.sm().getSelection()._as,c=G.length;if(e)for(N=e.length-1;N>=0;N--){d=e[N];for(var b=c-1;b>=0;b--)if(w=G[b],w._layer===d&&(J=H(w),J===!1))return}else for(N=c-1;N>=0;N--)if(w=G[N],J=H(w),J===!1)return},_n=function(t,y,Q,d){var w=y/2,F=Q/2,c=sr(t,-w,-F,d),U=sr(t,w,-F,d),k=sr(t,-w,F,d),Y=sr(t,w,F,d),n=sr(t,0,-F,d),T=sr(t,w,0,d),p=sr(t,0,F,d),G=sr(t,-w,0,d);return[c,U,k,Y,n,T,p,G]},sl=function(W,N,H){var n={x:N.x-W.x,y:N.y-W.y},e={x:H.x-W.x,y:H.y-W.y},L=V(r(H.x-W.x,2)+r(H.y-W.y,2)),D={x:e.x/L,y:e.y/L},F=n.x*D.x+n.y*D.y,k={x:D.x*F,y:D.y*F};return{x:W.x+k.x,y:W.y+k.y}},sr=function(J,i,v,U){var T=q(U)*i-N(U)*v,j=N(U)*i+q(U)*v;return J?{x:J.x+T,y:J.y+j}:{x:T,y:j}},Nk=function(A,P){return P>2*A?A:P/2},vg=function(I,w,e,m){var $=X(I,w);return e=m?a(e,$):Nk(e,$),$?e/=$:e=0,{x:I.x+(w.x-I.x)*e,y:I.y+(w.y-I.y)*e}},sp=function(I,e,v,Y,y){return e?(v=R.getPosition(v,R.getNodeRect(I,e)),v.x+=Y||0,v.y+=y||0,v):O},hi=function(J,g){var b,F,P=J.gv,M=J._data,q=M._40I,x=M._41I,h=M.s("edge.offset"),w=M.s("edge.source.position"),K=M.s("edge.target.position"),T=M.s("edge.source.offset.x"),j=M.s("edge.source.offset.y"),t=M.s("edge.target.offset.x"),l=M.s("edge.target.offset.y");if(g?(b=sp(P,q,w,T,j),F=sp(P,x,K,t,l)):(b=sp(P,q,w),F=sp(P,x,K)),"points"===M.s("edge.type")&&h&&!M.s("edge.center")&&b){var N=M.s("edge.points")||new p,d=N.size(),D=vg(b,d?N.get(0):F,h,d),U=vg(F,d?N.get(d-1):b,h,d);b=D,F=U}return[b,F]},Wq=function(y,L,M){var B=y._78o,Z=y._data,a=Z.s("edge.type"),C=[B._69o,B._70o];return"points"===a?M&&(C=hi(y)):C=B.center?a?M?hi(y):hi(y,!0):M?hi(y):[B.c1,B.c2]:M?hi(y):hi(y,!0),L=new p(L?L._as:O),L.add(C[0],0),L.add(C[1]),L},Ef=function(b){return b=new p(b._as),b.removeAt(0),b.removeAt(b.size()-1),b},vb=function(F){F._as||(F=new p(F));var m=new p;m.add(1);for(var H=1;H<F.size();H++)m.add(2);return m},ql=function(X,I){return{x:(X.x+I.x)/2,y:(X.y+I.y)/2}},Qg=function(X,Q){return{x:X.x+1*(Q.x-X.x)/4,y:X.y+1*(Q.y-X.y)/4}},Dn=function(b,a){return{x:b.x+3*(a.x-b.x)/4,y:b.y+3*(a.y-b.y)/4}},ik=function(I,t,y,T){var R=t.x+t.width/2,X=t.y+t.height/2,K=V(R*R+X*X),H=_(X,R)+y;return{x:T.x+K*q(H),y:T.y+K*N(H)}},Qi=S.validateImpl,ii=S.isRectEditable,Yq=S.isPointEditable,pn=S._42,_o=P._79o,yj=M._79o,fq=P._48O,ef=P._47O,Bg=C._48O,cl=C._80o,fr=P._80o,pe=C._2o,pd=C._47O,Ke=M._47O,Xi=S.isEditable,og=["northwest","north","northeast","east","southeast","south","southwest","west"],we=function(m,W,N,G,U,x,C,P,f,c){var j=m.x,M=m.y,S=m.width,Y=m.height,v={x:j+S/2,y:M+Y/2};G=G||0,W=sr(v,W.x-v.x,W.y-v.y,-G),C&&!P&&(W.x+=f,W.y+=c);var o=.01;if("northwest"===N?(W.x+U>j+S-o&&(W.x=j+S-U-o),W.y+U>M+Y-o&&(W.y=M+Y-U-o),m=K(W,{x:j+S,y:M+Y})):"north"===N?(W.y+U>M+Y-o&&(W.y=M+Y-U-o),m=K({x:j,y:W.y},{x:j+S,y:M+Y})):"northeast"===N?(W.x<j+U+o&&(W.x=j+U+o),W.y+U>M+Y-o&&(W.y=M+Y-U-o),m=K({x:j,y:W.y},{x:W.x,y:M+Y})):"west"===N?(W.x+U>j+S-o&&(W.x=j+S-U-o),m=K({x:W.x,y:M},{x:j+S,y:M+Y})):"east"===N?(W.x<j+U+o&&(W.x=j+U+o),m=K({x:j,y:M},{x:W.x,y:M+Y})):"southwest"===N?(W.x+U>j+S-o&&(W.x=j+S-U-o),W.y<M+U+o&&(W.y=M+U+o),m=K({x:W.x,y:M},{x:j+S,y:W.y})):"south"===N?(W.y<M+U+o&&(W.y=M+U+o),m=K({x:j,y:M},{x:j+S,y:W.y})):"southeast"===N&&(W.x<j+U+o&&(W.x=j+U+o),W.y<M+U+o&&(W.y=M+U+o),m=K({x:j,y:M},W)),"keepRatio"===x&&(!C&&P||C&&!P)&&("northeast"===N||"southeast"===N||"northwest"===N||"southwest"===N)){var n=m.width,t=m.height,g=n/S,H=t/Y,d=a(g,H);m.width=S*d,m.height=Y*d,"northeast"===N?m.y=M+(Y-m.height):"northwest"===N?(m.y=M+(Y-m.height),m.x=j+(S-m.width)):"southwest"===N&&(m.x=j+(S-m.width))}m.x-=v.x,m.y-=v.y;var E=ik(O,m,G,v);return m.x=E.x-m.width/2,m.y=E.y-m.height/2,m},Md=function(t,W,e,F){var j=t.getRotation(),r=W,i=r.x,L=r.y,M=r.width,A=r.height,l={x:i+r.width/2,y:L+r.height/2};F=sr(l,F.x-l.x,F.y-l.y,-j),"northwest"===e?r=K(F,{x:i+M,y:L+A}):"north"===e?r=K({x:i,y:F.y},{x:i+M,y:L+A}):"northeast"===e?r=K({x:i,y:F.y},{x:F.x,y:L+A}):"west"===e?r=K({x:F.x,y:L},{x:i+M,y:L+A}):"east"===e?r=K({x:i,y:L},{x:F.x,y:L+A}):"southwest"===e?r=K({x:F.x,y:L},{x:i+M,y:F.y}):"south"===e?r=K({x:i,y:L},{x:i+M,y:F.y}):"southeast"===e&&(r=K({x:i,y:L},F)),t.setRect(r),r.x-=l.x,r.y-=l.y;var q=ik(t,r,j,l);t.p(q.x,q.y)},wq=function(m,W,i,$,w,X,T,c){var N=O;X?(N=sr(O,w.x-W.x,w.y-W.y,-i),N.x-=T.x,N.y-=T.y):N=sr(O,w.x-W.x,w.y-W.y,0);var Y={x:W.x+N.x,y:W.y+N.y};c&&(Y=c(Y.x,Y.y)),Y.e=m.getPoints().get($).e,m.setPoint($,Y);var _=m.getWidth(),j=m.getHeight(),S=m.p().x-_/2,L=m.p().y-j/2;S-=W.x,L-=W.y;var C=ik(m,{x:S,y:L,width:_,height:j},i,W);m.p(C.x,C.y)},Un=function(h,S,y){var D,W;if(h instanceof L?(D=h.getPoints(),W=h.getSegments()):h instanceof T&&"points"===h.s("edge.type")&&(D=h.s("edge.points"),W=h.s("edge.segments"),D=Wq(S,D)),W||(W=vb(D)),h instanceof L&&h.isClosePath()&&W.indexOf(5)<0&&(W=new p(W._as),W.add(5)),W)for(var l=-1,j=0;j<W.size();j++){if(j===y)return l;var I=W.get(j);1===I?l+=1:2===I?l+=1:3===I?l+=2:4===I&&(l+=3)}},ip=function(V,G,$){var X,y;if(V instanceof L?(X=V.getPoints(),y=V.getSegments()):V instanceof T&&"points"===V.s("edge.type")&&(X=V.s("edge.points"),y=V.s("edge.segments"),X=Wq(G,X)),y||(y=vb(X)),y)for(var P=-1,B=0;B<y.size();B++){var i=y.get(B);if(1===i?P+=1:2===i?P+=1:3===i?P+=2:4===i&&(P+=3),P===$)return B}},Sb=function(I,j){var $=[I[0]-j[0],I[1]-j[1],I[2]-j[2]];return $},io=function(){var P=new D(16);return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},Zq=function(H,i){var E=H[0],r=H[1],$=H[2];return H[0]=i[0]*E+i[4]*r+i[8]*$+i[12],H[1]=i[1]*E+i[5]*r+i[9]*$+i[13],H[2]=i[2]*E+i[6]*r+i[10]*$+i[14],H},eo=function(r,K){if(K){var E=N(K),C=q(K),R=r[0],f=r[1],Y=r[2],S=r[3],G=r[8],Z=r[9],U=r[10],d=r[11];r[0]=R*C-G*E,r[1]=f*C-Z*E,r[2]=Y*C-U*E,r[3]=S*C-d*E,r[8]=R*E+G*C,r[9]=f*E+Z*C,r[10]=Y*E+U*C,r[11]=S*E+d*C}},Pq=function(Z,n){for(var z=Z.s("grid.row.count"),M=Z.s("grid.column.count"),T=0;z>T;T++)for(var p=0;M>p;p++){var _=Z.getCellRect(T,p);if(h(_,n))return{rowIndex:T,columnIndex:p,rect:_,grid:Z}}return null},Pk=function(H,V,z,X,K,$){var L={},E=z-H,B=X-V,I=u.sqrt(E*E+B*B),A=E/I,J=B/I,l=(-H+K)*A+(-V+$)*J;return 0>=l?(L.x=H,L.y=V):l>=I?(L.x=z,L.y=X):(L.x=H+l*A,L.y=V+l*J),E=K-L.x,B=$-L.y,L.z=u.sqrt(E*E+B*B),L},Tb=function(h,z){var W,I,Q,b,_,f,F,Y,y=h.getPoints(),l=h.getSegments(),D=h.p(),H=h.getRotation();if(!l||!(l.indexOf(3)>0||l.indexOf(4)>0)){for(Y=0;Y<=y.size()-1;Y++)if(Y===y.size()-1?(_=y.get(0),b=y.get(Y)):(b=y.get(Y),_=y.get(Y+1)),b=sr(D,b.x-D.x,b.y-D.y,H),_=sr(D,_.x-D.x,_.y-D.y,H),f=Pk(b.x,b.y,_.x,_.y,z.x,z.y),F=f.z,F<(h.s("shape.border.width")||10)){I=b,Q=_,W=Y;break}if(W!=O){var x=Pk(I.x,I.y,Q.x,Q.y,z.x,z.y),p=X(I,x);return{attachIndex:W,attachOffset:p}}}},Kp=function(k){for(var q=k._data,d=q.p(),E=q.getRotation(),K=q.getPoints(),w=O,m=[],Y=0;Y<K.size();Y++)w=K.get(Y),m.push(sr(d,w.x-d.x,w.y-d.y,E));k._55O.$15l=m};S._editPointSize=A?24:9,S._edgeHelpers=["parent","remove","source","target"],S._leftTopHelpers=["parent"],S._rightTopHelpers=["host"],S._leftBottomHelpers=["edge"],S._rightBottomHelpers=["remove"],og=og.concat(og).concat(og),M._79o=function(){var p=this,L=p.gv,Q=L.getZoom(),H=L._editInteractor,j=yj.call(p),Y=hi(p,!0),r=Y[0],V=Y[1],t={x:j.x,y:j.y,width:j.width,height:j.height},X=K(r,V);if(H instanceof c.XEditInteractor){t=y(t,X);var U=p._55O,v=L.getEditPointSize()/Q+2,x=0;U&&U._43O&&(x+=v/2,e(t,x))}return t},M._47O=function(Z){var X=this,H=X.gv,R=H._editInteractor;R instanceof c.XEditInteractor||Ke.call(X,Z)},M.rectIntersects=function(L){var w=this,U=w._data,h=w.gv,T=h.getZoom(),y=w._55O,s=h._editInteractor;if(s instanceof c.XEditInteractor&&h.isEditable(U)&&y&&y._43O&&"points"===U.s("edge.type")){var G=U.s("edge.points"),W=U.s("edge.segments");G=Wq(w,G),W||(W=vb(G)),G=G._as;var p=!1,k=A?5:1,D=L.x+k,q=L.y+k,S={x:D,y:q};if(s._edge===U&&s._hoverSegmentIndex>=0){var e=h._editInteractor._hoverSegmentIndex,u=W.get(e),z=Un(U,w,e),X=O;if(z!=O&&z>=0){var C=G[z],E=h.getSegmentHoverWidth()/T;if(2===u||1===u){var K=G[z+1];X=Vg(new Tq(C.x,C.y),new Tq(K.x,K.y),new Tq(S.x-E,S.y-E),new Tq(S.x+2*E,S.y+2*E)),X.$62l===F&&(p=!0)}else if(3===u){var J=G[z+1],K=G[z+2];X=hm(new Tq(C.x,C.y),new Tq(J.x,J.y),new Tq(K.x,K.y),new Tq(S.x-E,S.y-E),new Tq(S.x+2*E,S.y+2*E)),X.$62l===F&&(p=!0)}else if(4===u){var g=G[z+1],t=G[z+2];K=G[z+3],X=Yi(new Tq(C.x,C.y),new Tq(g.x,g.y),new Tq(t.x,t.y),new Tq(K.x,K.y),new Tq(S.x-E,S.y-E),new Tq(S.x+2*E,S.y+2*E)),X.$62l===F&&(p=!0)}}}if(p)return!0}return O},P._47O=function(B){var s=this,b=s.gv,H=b._editInteractor;H instanceof c.XEditInteractor||ef.call(s,B)},P.rectIntersects=function(B){var Z=this,r=Z._data,S=Z.gv,E=S.getZoom(),v=Z._55O,n=S._editInteractor;if(n instanceof c.XEditInteractor&&S.isEditable(r)&&v&&v._43O){var T=v.$15l,o=!1,D=A?5:1,x=B.x+D,L=B.y+D,s={x:x,y:L};if(T&&T.length===r.getPoints().size()||(Kp(Z),T=v.$15l),n._shape===r&&n._hoverSegmentIndex>=0){var G=r.getSegments();G||(G=vb(T));var _=S._editInteractor._hoverSegmentIndex,p=G.get(_),H=Un(r,Z,_),g=O;if(H!=O&&H>=0){var Q=T[H],m=S.getSegmentHoverWidth()/E;if(2===p||1===p){var t=T[H+1];g=Vg(new Tq(Q.x,Q.y),new Tq(t.x,t.y),new Tq(s.x-m,s.y-m),new Tq(s.x+2*m,s.y+2*m)),g.$62l===F&&(o=!0)}else if(3===p){var u=T[H+1],t=T[H+2];g=hm(new Tq(Q.x,Q.y),new Tq(u.x,u.y),new Tq(t.x,t.y),new Tq(s.x-m,s.y-m),new Tq(s.x+2*m,s.y+2*m)),g.$62l===F&&(o=!0)}else if(4===p){var R=T[H+1],k=T[H+2];t=T[H+3],g=Yi(new Tq(Q.x,Q.y),new Tq(R.x,R.y),new Tq(k.x,k.y),new Tq(t.x,t.y),new Tq(s.x-m,s.y-m),new Tq(s.x+2*m,s.y+2*m)),g.$62l===F&&(o=!0)}}}if(o)return!0}return O},P._48O=function(){var x=this,k=x.gv,f=k._editInteractor;f instanceof c.XEditInteractor?(C._48O.call(x),x._55O._43O&&Kp(x)):fq.call(x)},P._79o=function(){var P=this,U=P.gv,G=U.getZoom(),s=U._editInteractor,E=_o.call(P);if(E){var S={x:E.x,y:E.y,width:E.width,height:E.height};if(s instanceof c.XEditInteractor){var b=P._55O,m=U.getEditPointSize()/G+2,A=0;b&&b._43O&&(A+=m/2,e(S,A))}return S}},C._47O=function(t){var G=this,j=G.gv,U=j._editInteractor;if(U instanceof c.XEditInteractor);else{var x=G._55O;x&&x._98o&&pd.call(G,t)}},C._2o=function(){var G=this,e=G.gv,p=e._editInteractor,t=G._data;return e.isEditable(t)&&p instanceof c.XEditInteractor?0:pe.call(G)},C._80o=function(Y){var S=this,l=S.gv._editInteractor;if(cl.call(S,Y),l&&l._debug){Y.save(),Y.beginPath(),Y.lineWidth=1,Y.strokeStyle="green";var w=S._79o();w&&(Y.rect(w.x,w.y,w.width,w.height),Y.stroke()),Y.restore()}},P._80o=function(E){var p=this,B=p.gv._editInteractor;if(fr.call(p,E),B&&B._debug){E.save(),E.beginPath(),E.lineWidth=1,E.strokeStyle="green";var h=p._79o();E.rect(h.x,h.y,h.width,h.height),E.stroke(),E.restore()}},C._48O=function(){var _=this,y=_.gv,W=_._data,L=y._editInteractor,X=_._55O,S=W.p(),N=W.getRotation();if(L instanceof c.XEditInteractor){if(X._42O){var E=_n(S,W.getWidth(),W.getHeight(),N),k=E[0],h=E[1],x=E[2],n=E[3],g=E[4],Q=E[5],Z=E[6],Y=E[7];X.$45l=[k,g,h,Q,n,Z,x,Y]}}else Bg.call(_)},S.getResizeMode=function(){return this.$25l||"normal"},S.setResizeMode=function(m){var A=this.$25l;this.$25l=m,this.fp("resizeMode",A,m)},S.getSnapAngle=function(){return this.$26l||Math.PI/36},S.setSnapAngle=function(U){var s=this.$26l;this.$26l=U,this.fp("snapAngle",s,U)},S.getSnapSpacing=function(){return this.$27l},S.setSnapSpacing=function(q){var C=this.$27l;this.$27l=q,this.fp("snapSpacing",C,q)},S.getPointSnapSpacing=function(){return this._pointSnapSpacing},S.setPointSnapSpacing=function(B){var U=this._pointSnapSpacing;this._pointSnapSpacing=B,this.fp("pointSnapSpacing",U,B)},S.setHelperEditableFunc=function(P){var i=this._helperEditableFunc;this._helperEditableFunc=P,this.fp("helperEditableFunc",i,P)},S.getHelperEditableFunc=function(){return this._helperEditableFunc},S.setLeftTopHelpers=function(E){var M=this._leftTopHelpers;this._leftTopHelpers=E,this.fp("leftTopHelpers",M,E)},S.getLeftTopHelpers=function(){return this._leftTopHelpers},S.setLeftTopHelpersAlign=function(z){var I=this._leftTopHelpersAlign;this._leftTopHelpersAlign=z,this.fp("leftTopHelpersAlign",I,z)},S.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},S.setRightTopHelpers=function(o){var S=this._rightTopHelpers;this._rightTopHelpers=o,this.fp("rightTopHelpers",S,o)},S.getRightTopHelpers=function(){return this._rightTopHelpers},S.setRightTopHelpersAlign=function(F){var e=this._rightTopHelpersAlign;this._rightTopHelpersAlign=F,this.fp("rightTopHelpersAlign",e,F)},S.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},S.setLeftBottomHelpers=function(i){var N=this._leftBottomHelpers;this._leftBottomHelpers=i,this.fp("leftBottomHelpers",N,i)},S.getLeftBottomHelpers=function(){return this._leftBottomHelpers},S.setLeftBottomHelpersAlign=function(h){var U=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=h,this.fp("leftBottomHelpersAlign",U,h)},S.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},S.setRightBottomHelpers=function(P){var k=this._rightBottomHelpers;this._rightBottomHelpers=P,this.fp("rightBottomHelpers",k,P)},S.getRightBottomHelpers=function(){return this._rightBottomHelpers},S.setRightBottomHelpersAlign=function(V){var b=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=V,this.fp("rightBottomHelpersAlign",b,V)},S.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},S.setEdgeHelpers=function(t){var f=this._edgeHelpers;this._edgeHelpers=t,this.fp("edgeHelpers",f,t)},S.getEdgeHelpers=function(){return this._edgeHelpers},S.isHelperEditable=function(h,q){return h instanceof T&&("host"===q||"edge"===q||"elevation"===q||"tall"===q)?!1:h instanceof E&&("source"===q||"target"===q)?!1:"pointElevation"===q?this._helperEditableFunc?this._helperEditableFunc(h,q):!1:this._helperEditableFunc?this._helperEditableFunc(h,q):!0},S.getEditHelperSize=function(){return this._editHelperSize||(A?28:16)},S.setEditHelperSize=function(F){var j=this._editHelperSize;this._editHelperSize=F,this.fp("editHelperSize",j,F)},S.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},S.setEditRectBorderColor=function(t){var G=this.$28l;this.$28l=t,this.fp("editRectBorderColor",G,t)},S.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},S.setNodeBorderColor=function(c){var M=this.$29l;this.$29l=c,this.fp("nodeBorderColor",M,c)},S.getEditRectBorderStyle=function(){return this.$30l||"dashed"},S.setEditRectBorderStyle=function(v){var k=this.$30l;this.$30l=v,this.fp("editRectBorderStyle",k,v)},S.getControlPointBackground=function(){return this.$31l||"#ff0"},S.setControlPointBackground=function(h){var d=this.$31l;this.$31l=h,this.fp("controlPointBackground",d,h)},S.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},S.setControlPointBorderColor=function(n){var O=this.$32l;this.$32l=n,this.fp("controlPointBorderColor",O,n)},S.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},S.setJoinPointBackground=function(n){var U=this.$33l;this.$33l=n,this.fp("joinPointBackground",U,n)},S.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},S.setJoinPointBorderColor=function(z){var o=this.$34l;this.$34l=z,this.fp("joinPointBorderColor",o,z)},S.getDirectionLineColor=function(){return this.$35l||"#888"},S.setDirectionLineColor=function(U){var E=this.$35l;this.$35l=U,this.fp("directionLineColor",E,U)},S.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},S.setSegmentHoverColor=function(p){var X=this.$36l;this.$36l=p,this.fp("segmentHoverColor",X,p)},S.getSegmentHoverWidth=function(){return this.$22l||(A?16:8)},S.setSegmentHoverWidth=function(h){var N=this.$22l;this.$22l=h,this.fp("segmentHoverWidth",N,h)},S.getSnapPointBorderColor=function(){return this.$38l||"#f00"},S.setSnapPointBorderColor=function(W){var q=this.$38l;this.$38l=W,this.fp("snapPointBorderColor",q,W)},S.getEditRectPadding=function(){return this.$39l!=O?this.$39l:6},S.setEditRectPadding=function(E){var Z=this.$39l;this.$39l=E,this.fp("editRectPading",Z,E)},S.isRectEditable=function(Y){var h=this,W=h._editInteractor;return W instanceof c.XEditInteractor?h._rectEditableFunc?h._rectEditableFunc(Y):!0:ii.call(h,Y)},S.isPointEditable=function(U){var R=this,x=R._editInteractor;return x instanceof c.XEditInteractor?R._pointEditableFunc?R._pointEditableFunc(U):!0:Yq.call(R,U)},S.validateImpl=function(){var e=this,Y=e.$14l,r=e._editInteractor;if(Y){var $=e.getWidth(),z=e.getHeight();($!==Y.clientWidth||z!==Y.clientHeight)&&(r&&(r._68I=1),R.setCanvas(Y,$,z),e._32I=1)}Qi.call(this)},S.isEditable=function(w){var V=Xi.call(this,w),Y=this._editInteractor;if(Y instanceof c.XEditInteractor&&w instanceof T){w.getSource()==w.getTarget()&&(V=!1);var i=this.getEditableFunc();V=i?i(w):!0}return V},S._42=function(v,C){var T=this,Q=T._editInteractor;pn.call(T,v,C),Q instanceof c.XEditInteractor&&Q._68I&&Q._42()},S.isSnapPoint=function(){return!0};var Le=function(F){arguments.length>0&&this.$58l(F)},wo=Le.prototype;wo.$58l=function(S){this.$62l=S,this.points=new Array},wo.$56l=function(b){this.points.push(b)},wo.$57l=function(X){this.points=this.points.concat(X)};var Tq=function(u,$){arguments.length>0&&this.$58l(u,$)},Cd=Tq.prototype;Cd.$58l=function(M,p){this.x=M,this.y=p},Cd.add=function(t){return new Tq(this.x+t.x,this.y+t.y)},Cd.addEquals=function(f){return this.x+=f.x,this.y+=f.y,this},Cd.$55l=function(k){return new Tq(this.x*k,this.y*k)},Cd.eq=function(Q){return this.x==Q.x&&this.y==Q.y},Cd.lt=function(f){return this.x<f.x&&this.y<f.y},Cd.lte=function(U){return this.x<=U.x&&this.y<=U.y},Cd.gt=function(O){return this.x>O.x&&this.y>O.y},Cd.gte=function(t){return this.x>=t.x&&this.y>=t.y},Cd.lerp=function(u,h){return new Tq(this.x+(u.x-this.x)*h,this.y+(u.y-this.y)*h)},Cd.distanceFrom=function(g){var k=this.x-g.x,A=this.y-g.y;return V(k*k+A*A)},Cd.min=function(s){return new Tq(a(this.x,s.x),a(this.y,s.y))},Cd.max=function(J){return new Tq(I(this.x,J.x),I(this.y,J.y))},Cd.toString=function(){return this.x+","+this.y};var lm=function(){this.$58l(arguments)},Ub=lm.prototype;lm.TO=1e-6,lm.AC=6,Ub.$58l=function(g){this.co=new Array;for(var r=g.length-1;r>=0;r--)this.co.push(g[r])},Ub.$55l=function(l){for(var X=new lm,n=0;n<=this.$50l()+l.$50l();n++)X.co.push(0);for(var n=0;n<=this.$50l();n++)for(var u=0;u<=l.$50l();u++)X.co[n+u]+=this.co[n]*l.co[u];return X},Ub.$59l=function(){for(var O=this.$50l();O>=0&&z(this.co[O])<=lm.TO;O--)this.co.pop()},Ub.$50l=function(){return this.co.length-1},Ub.$51l=function(){var W;switch(this.$59l(),this.$50l()){case 0:W=new Array;break;case 1:W=this.$52l();break;case 2:W=this.$53l();break;case 3:W=this.$54l();break;case 4:W=this.$63l();break;default:W=new Array}return W},Ub.$52l=function(){var c=new Array,k=this.co[1];return 0!=k&&c.push(-this.co[0]/k),c},Ub.$53l=function(){var $=new Array;if(2==this.$50l()){var o=this.co[2],K=this.co[1]/o,u=this.co[0]/o,c=K*K-4*u;if(c>0){var H=V(c);$.push(.5*(-K+H)),$.push(.5*(-K-H))}else 0==c&&$.push(.5*-K)}return $},Ub.$63l=function(){var r=new Array;if(4==this.$50l()){var U=this.co[4],I=this.co[3]/U,l=this.co[2]/U,k=this.co[1]/U,H=this.co[0]/U,A=new lm(1,-l,I*k-4*H,-I*I*H+4*l*H-k*k).$54l(),$=A[0],B=I*I/4-l+$;if(z(B)<=lm.TO&&(B=0),B>0){var i=V(B),v=3*I*I/4-i*i-2*l,D=(4*I*l-8*k-I*I*I)/(4*i),F=v+D,s=v-D;if(z(F)<=lm.TO&&(F=0),z(s)<=lm.TO&&(s=0),F>=0){var K=V(F);r.push(-I/4+(i+K)/2),r.push(-I/4+(i-K)/2)}if(s>=0){var K=V(s);r.push(-I/4+(K-i)/2),r.push(-I/4-(K+i)/2)}}else if(0>B);else{var D=$*$-4*H;if(D>=-lm.TO){if(0>D&&(D=0),D=2*V(D),v=3*I*I/4-2*l,v+D>=lm.TO){var y=V(v+D);r.push(-I/4+y/2),r.push(-I/4-y/2)}if(v-D>=lm.TO){var y=V(v-D);r.push(-I/4+y/2),r.push(-I/4-y/2)}}}}return r},Ub.$54l=function(){var Q=new Array;if(3==this.$50l()){var A=this.co[3],S=this.co[2]/A,E=this.co[1]/A,X=this.co[0]/A,p=(3*E-S*S)/3,d=(2*S*S*S-9*E*S+27*X)/27,e=S/3,W=d*d/4+p*p*p/27,k=d/2;if(z(W)<=lm.TO&&(W=0),W>0){var H,n,f=V(W);H=-k+f,n=H>=0?r(H,1/3):-r(-H,1/3),H=-k-f,H>=0?n+=r(H,1/3):n-=r(-H,1/3),Q.push(n-e)}else if(0>W){var g=V(-p/3),Y=_(V(-W),-k)/3,I=q(Y),F=N(Y),x=V(3);Q.push(2*g*I-e),Q.push(-g*(I+x*F)-e),Q.push(-g*(I-x*F)-e)}else{var H;H=k>=0?-r(k,1/3):r(-k,1/3),Q.push(2*H-e),Q.push(-H-e)}}return Q};var ke=function(u,Q){arguments.length>0&&this.$58l(u,Q)},Fc=ke.prototype;Fc.$58l=function(q,L){this.x=q,this.y=L},Fc.length=function(){return V(this.x*this.x+this.y*this.y)},Fc.$60l=function(U){return this.x*U.x+this.y*U.y};var Kf=function(t,v,b,O){var l,w=(O.x-b.x)*(t.y-b.y)-(O.y-b.y)*(t.x-b.x),G=(v.x-t.x)*(t.y-b.y)-(v.y-t.y)*(t.x-b.x),E=(O.y-b.y)*(v.x-t.x)-(O.x-b.x)*(v.y-t.y);if(0!=E){var a=w/E,D=G/E;a>=0&&1>=a&&D>=0&&1>=D?(l=new Le(F),l.points.push(new Tq(t.x+a*(v.x-t.x),t.y+a*(v.y-t.y)))):l=new Le($)}else l=0==w||0==G?new Le("C"):new Le("P");return l},ye=function(E,v,T,S,c){var Y,y,f,r,U,R,G,Z=S.min(c),l=S.max(c),g=new Le($);Y=v.$55l(-2),f=E.add(Y.add(T)),Y=E.$55l(-2),y=v.$55l(2),r=Y.add(y),U=new Tq(E.x,E.y),G=new ke(S.y-c.y,c.x-S.x),R=S.x*c.y-c.x*S.y;for(var H=new lm(G.$60l(f),G.$60l(r),G.$60l(U)+R).$51l(),w=0;w<H.length;w++){var W=H[w];if(W>=0&&1>=W){var h=E.lerp(v,W),q=v.lerp(T,W),p=h.lerp(q,W);S.x==c.x?Z.y<=p.y&&p.y<=l.y&&(g.$62l=F,g.$56l(p)):S.y==c.y?Z.x<=p.x&&p.x<=l.x&&(g.$62l=F,g.$56l(p)):p.gte(Z)&&p.lte(l)&&(g.$62l=F,g.$56l(p))}}return g},hm=function(J,T,N,U,x){var q=U.min(x),e=U.max(x),H=new Tq(e.x,q.y),D=new Tq(q.x,e.y),f=ye(J,T,N,q,H),M=ye(J,T,N,H,e),o=ye(J,T,N,e,D),y=ye(J,T,N,D,q),s=new Le($);return s.$57l(f.points),s.$57l(M.points),s.$57l(o.points),s.$57l(y.points),s.points.length>0&&(s.$62l=F),s},Hj=function(v,g,Y,N,C,P){var c,L,_,V,t,h,I,o,p,j,q=C.min(P),e=C.max(P),n=new Le($);c=v.$55l(-1),L=g.$55l(3),_=Y.$55l(-3),V=c.add(L.add(_.add(N))),t=new ke(V.x,V.y),c=v.$55l(3),L=g.$55l(-6),_=Y.$55l(3),V=c.add(L.add(_)),h=new ke(V.x,V.y),c=v.$55l(-3),L=g.$55l(3),_=c.add(L),I=new ke(_.x,_.y),o=new ke(v.x,v.y),j=new ke(C.y-P.y,P.x-C.x),p=C.x*P.y-P.x*C.y;for(var X=new lm(j.$60l(t),j.$60l(h),j.$60l(I),j.$60l(o)+p).$51l(),E=0;E<X.length;E++){var f=X[E];if(f>=0&&1>=f){var K=v.lerp(g,f),i=g.lerp(Y,f),w=Y.lerp(N,f),m=K.lerp(i,f),k=i.lerp(w,f),y=m.lerp(k,f);C.x==P.x?q.y<=y.y&&y.y<=e.y&&(n.$62l=F,n.$56l(y)):C.y==P.y?q.x<=y.x&&y.x<=e.x&&(n.$62l=F,n.$56l(y)):y.gte(q)&&y.lte(e)&&(n.$62l=F,n.$56l(y))}}return n},Yi=function(G,g,H,T,r,D){var d=r.min(D),o=r.max(D),w=new Tq(o.x,d.y),k=new Tq(d.x,o.y),B=Hj(G,g,H,T,d,w),A=Hj(G,g,H,T,w,o),O=Hj(G,g,H,T,o,k),W=Hj(G,g,H,T,k,d),m=new Le($);return m.$57l(B.points),m.$57l(A.points),m.$57l(O.points),m.$57l(W.points),m.points.length>0&&(m.$62l=F),m},Vg=function(D,H,J,U){var Q=J.min(U),i=J.max(U),q=new Tq(i.x,Q.y),I=new Tq(Q.x,i.y),Y=Kf(Q,q,D,H),c=Kf(q,i,D,H),G=Kf(i,I,D,H),k=Kf(I,Q,D,H),L=new Le($);return L.$57l(Y.points),L.$57l(c.points),L.$57l(G.points),L.$57l(k.points),L.points.length>0&&(L.$62l=F),L},Jm=c.XEditInteractor=function(B){var r=this,P=r._view=document.createElement("canvas");P.className="editCanvas",P.style.position="absolute",Jm.superClass.constructor.call(r,B)};U.def(Jm,c.Interactor,{ms_edit:1,setUp:function(){var b=this,q=b.gv,y=q.getView(),Z=b._view;Jm.superClass.setUp.call(b),q.setEditInteractor(b),q.$14l=Z,q._79O?y.insertBefore(Z,q._79O):y.appendChild(Z);var v=b.$49l=b.$11l.bind(b);q.dm().md(v),q.sm().ms(v),q.mp(v)},tearDown:function(){var p=this,L=p.gv,D=L.getView(),r=p.$49l;Jm.superClass.tearDown.call(p),L.setEditInteractor(O),L.$14l=O,D.removeChild(p._view),L.dm().umd(r),L.sm().ums(r),L.ump(r)},clear:function(){var p=this,M=p.gv;delete p._hoverSegmentIndex,delete p._edge,delete p._shape,delete M._editing,delete p.$10l,delete p.$13l,delete p.$9l,delete p._removePointIndex,delete p._lp,p.$12l="",delete p.$40l,delete p.$67l,delete p.$72l,delete p.$73l,delete p.$75l,delete p.$1l,delete p.$3l,delete p.$2l,delete p.$92l,delete p.$93l,delete p.$94l,p.clearDragging()},handle_keydown:function(y){this.$48l!==y.shiftKey&&(this.$48l=y.shiftKey,this.handle_mousemove(y,Z,!0))},handle_keyup:function(w){this.$48l!==w.shiftKey&&(this.$48l=w.shiftKey,this.handle_mousemove(w,Z,!0))},handle_touchstart:function(P){this.handle_mousemove(P),this.handle_mousedown(P)},handle_mousedown:function(J){o(J);var m=this,T=m.$13l,W=m.gv,B=W.dm(),C=B.getHistoryManager(),_=W.sm(),u=W.getZoom(),F=W.lp(J),A=U.isDoubleClick(J),Q=U.isLeftButton(J),N=m.$7l,I=m._shape,L=m._hoverSegmentIndex,V=m._edge,Y=m.$87l,Z=m.$88l,n=function(){m._68I||Y===m.$87l&&Z===m.$88l||m.$43l()};if(7!==m.$67l&&(delete m.$87l,delete m.$88l),Q&&(I||V)&&L>=0&&A&&(I&&_.contains(I)||V&&_.contains(V))){var X=Zg.call(m,I||V,L,F);return m.addShapePoint(I||V,L,X),x(function(){m.handle_mousemove(J)},40),void 0}if(Q&&(I||V)&&m._removePointIndex>=0&&A)return m.removeShapePoint(),m.$5l=1,x(function(){m.handle_mousemove(J)},40),void 0;if(!Q||!W._editing)return n(),void 0;if(I&&T>=0){var S=I.getPoints().get(T),g=I.p(),i=sr(g,S.x-g.x,S.y-g.y,-N+I.getRotation());v=sr(g,F.x-g.x,F.y-g.y,-N),m.$24l={x:v.x-i.x,y:v.y-i.y},m.startDragging(J),C&&C.beginInteraction(),m.fi({kind:"beginEditPoint",event:J,data:I,index:T}),m.$88l=T,m.$87l=I}else if(m.$10l){var y=W.sm().getSelection(),a=m.$6l,h=m.$1l={},M=m.$3l={},q=m.$16l[w[m.$10l]],P={x:a.x,y:a.y},H={x:a.x+a.width/2,y:a.y+a.height/2};m.$24l={x:F.x-q.x/u,y:F.y-q.y/u},m.$2l=b(m.$8l),m.$4l=b(a),y.each(function(d){if(d instanceof E){var X=d.p(),g=d.getWidth(),Q=d.getHeight(),R=sr(H,X.x-H.x,X.y-H.y,-N);h[d.getId()]={x:X.x-g/2,y:X.y-Q/2,width:g,height:Q},M[d.getId()]={x:(R.x-P.x)/a.width,y:(R.y-P.y)/a.height}}}),m.startDragging(J),C&&C.beginInteraction(),m.fi({kind:"beginEditRect",event:J,direction:m.$10l})}else if(V&&T>=0){var K=Wq(W.getDataUI(V),V.s("edge.points")),S=K.get(T);m.$24l={x:F.x-S.x,y:F.y-S.y},m.startDragging(J),C&&C.beginInteraction(),m.fi({kind:"beginEditPoint",event:J,data:V,index:T}),m.$88l=T,m.$87l=V}else if(m.$40l){var a=m.$6l,H={x:a.x+a.width/2,y:a.y+a.height/2},c=b(m.$23l);c.x/=u,c.y/=u;var l=sr(H,c.x-H.x,c.y-H.y,-N),v=sr(H,F.x-H.x,F.y-H.y,-N);m.$24l={x:v.x-l.x,y:v.y-l.y},m.startDragging(J),C&&C.beginInteraction(),m.fi({kind:"beginEditRotation",event:J,data:m._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(m.$67l)>=0)m.startDragging(J);else if(m.$71l&&A&&m.$79l(m.$71l,F)){var p=_.toSelection();C&&C.beginInteraction(),p.each(function(W){B.remove(W)}),C&&C.endInteraction()}n()},$11l:function(){var c=this,B=c.gv;B._editing&&(c.$13l==O||c._shape==O&&c._edge==O)&&(c.$73l==O||1!==c.$67l&&5!==c.$67l&&6!==c.$67l)||(c.$5l=1),c._68I=1},$46l:function(g){var u=this,M=u.gv,$=M.lp(g),y=[];return Mg(M,function(Q){var z=M.getDataUI(Q);if(z){var p=z._79o();h(p,$)&&y.push(Q)}}),y},$47l:function(y){var i=this,r=i.$13l,c=i.gv.dm(),h=c.getHistoryManager();i.$10l?(i.fi({kind:"endEditRect",event:y,direction:i.$10l}),h&&h.endInteraction()):i._shape&&r>=0?(i.fi({kind:"endEditPoint",event:y,data:i._shape,index:r}),h&&h.endInteraction()):i._edge&&r>=0?(i.fi({kind:"endEditPoint",event:y,data:i._edge,index:r}),h&&h.endInteraction()):i.$23l&&i.$40l&&(i.fi({kind:"endEditRotation",event:y}),h&&h.endInteraction())},handleWindowTouchEnd:function(g){this.handleWindowMouseUp(g)},handleWindowMouseUp:function(N){var w=this,b=w.gv,f=b.dm(),J=f.getHistoryManager(),t=w._shape,d=w._edge,j=w.$13l,h=w.$40l,c=w.$9l,D=w.$10l,H=w.$67l;if((t||d)&&j>=0&&c>=0){var $,L;if(t){var v=t.p(),i=t.getRotation();$=t.getPoints(),L=$.get(c),wq(t,v,i,j,L,!1)}else if($=Wq(b.getDataUI(d),d.s("edge.points"),!0),L=$.get(c),0===j){var X=$.get(0);d.s("edge.source.offset.x",L.x-X.x),d.s("edge.source.offset.y",L.y-X.y)}else if(j===$.size()-1){var q=$.get($.size()-1);d.s("edge.target.offset.x",L.x-q.x),d.s("edge.target.offset.y",L.y-q.y)}else"points"===d.s("edge.type")&&($.set(j,L),d.s("edge.points",Ef($)))}w.$47l(N);var r=w.$73l;1===H?(J&&J.beginInteraction(),r?b.sm().each(function(E){if(E.setHost&&b.isHelperEditable(E,"host")){E.setHost(r);var x=w.$75l,f=w.$74l;x&&(E.s("attach.row.index",x.rowIndex),E.s("attach.column.index",x.columnIndex)),f&&(E.s("attach.index",f.attachIndex),E.s("attach.offset",f.attachOffset),E.s("attach.offset.relative",!1),E.s("attach.offset.opposite",!1))
}}):b.sm().each(function(l){l.setHost&&b.isHelperEditable(l,"host")&&(l.setHost(O),l.s("attach.row.index",Z),l.s("attach.column.index",Z),l.s("attach.index",Z),l.s("attach.offset",Z),l.s("attach.offset.relative",!1),l.s("attach.offset.opposite",!1))}),J&&J.endInteraction()):2===H?(J&&J.beginInteraction(),r?b.sm().each(function(J){J.setParent&&b.isHelperEditable(J,"parent")&&J.setParent(r)}):b.sm().each(function(y){y.setParent&&b.isHelperEditable(y,"parent")&&y.setParent(O)}),J&&J.endInteraction()):3===H?r&&(J&&J.beginInteraction(),b.sm().each(function(v){if(b.isHelperEditable(v,"edge")&&v instanceof E&&r instanceof E){var G=new g.Edge;f.add(G),G.setSource(v),G.setTarget(r),w.onEdgeCreated&&w.onEdgeCreated(N,G)}}),J&&J.endInteraction()):(5===H||6===H)&&r&&(J&&J.beginInteraction(),b.sm().each(function(c){c instanceof T&&r instanceof E&&(5===H&&b.isHelperEditable(c,"source")?c.setSource(r):6===H&&b.isHelperEditable(c,"source")&&c.setTarget(r))}),J&&J.endInteraction()),(D||h)&&w.$43l(!0),A?(w.clear(),delete w.$64l,w._68I||w.$43l()):(w.handle_mousemove(N,!0),H&&!w._68I&&w.$43l())},handleWindowTouchMove:function(S){this.handleWindowMouseMove(S)},handleWindowMouseMove:function(K){this._78I(K)},handle_mousemove:function(c,X,f){if(!this._pause){if(!f){var Q=A?Sr(c):c;this.$61l={clientX:Q.clientX,clientY:Q.clientY}}if(X===!0||!l()){var $=this,N=$.gv,r=!1,s=O;$.clear(),N.sm().size()>0&&(s=N.lp(f?$.$61l:c),r=$._79I(c,s)),r&&(N._editing=1),$.$12l!==$.$65l&&($.$65l=$.$12l,$.setCursor($.$12l)),$.$40l!==$.$64l&&($.$64l=$.$40l,$._68I||$.$43l()),$._hoverSegmentIndex!==$.$66l&&($.$66l=$._hoverSegmentIndex,$._68I||$.$43l())}}},_78I:function(s){this.autoScroll(s);var y=this,C=y.gv,q=C.lp(s),v=C.getZoom(),A=y.$13l;if((y._shape||y._edge)&&A>=0){var w,$,Z,D=y._shape,M=y._edge,N=y.$24l,l=C.getPointSnapSpacing(),R=function(k,u){return l==O||isNaN(l)?{x:k,y:u}:{x:f(k/l)*l,y:f(u/l)*l}};if(D){w=D.getPoints();var i=D.p(),Y=D.getRotation(),e=0;$=sr(i,q.x-i.x,q.y-i.y,-Y),wq(D,i,Y,A,q,!0,N,R),y.fi({kind:"betweenEditPoint",event:s,data:D,index:A})}else if(M){w=Wq(C.getDataUI(M),M.s("edge.points"),!0),q.x-=N.x,q.y-=N.y,$=q;var S,u;if(0===A){var c=w.get(0);S=q.x-c.x,u=q.y-c.y,Z=R(S,u),M.s("edge.source.offset.x",Z.x),M.s("edge.source.offset.y",Z.y)}else if(A===w.size()-1){var o=w.get(w.size()-1);S=q.x-o.x,u=q.y-o.y,Z=R(S,u),M.s("edge.target.offset.x",Z.x),M.s("edge.target.offset.y",Z.y)}else"points"===M.s("edge.type")&&(Z=R(q.x,q.y),Z.e=w.get(A).e,w.set(A,Z),M.s("edge.points",Ef(w)));y.fi({kind:"betweenEditPoint",event:s,data:M,index:A})}if(delete y.$9l,C.isSnapPoint(D)||C.isSnapPoint(M))for(e=0;e<w.size();e++)if(e!==A){var I=w.get(e);if(X(I,$)<C.getEditPointSize()/v){y.$9l=e;break}}}else if(y.$10l){var N=y.$24l;q.x-=N.x,q.y-=N.y;var B=C.sm().getSelection(),n=y.$1l,r=y.$7l,b=y.$10l,p=y.$4l,d=y.$2l,J=C.getEditRectPadding()/v,G=2*J,Q=C.getSnapSpacing(),t=Q!=O&&!isNaN(Q),a=we(d,q,b,r,2*J,C.getResizeMode(),t,!0),P=y.$6l;if(t){var j=a.width-G,h=a.height-G,H=f(j/Q)*Q,K=f(h/Q)*Q,F=H-j,g=K-h;("west"===b||"northwest"===b||"southwest"===b)&&(F=-F),("north"===b||"northwest"===b||"northeast"===b)&&(g=-g),a=we(d,q,b,r,2*J,C.getResizeMode(),t,!1,F,g)}y.$8l=a,P.x=a.x+J,P.y=a.y+J,P.width=a.width-G,P.height=a.height-G;var Yl=a.x+a.width/2,lm=a.y+a.height/2,Jk=P.x,Nc=P.y,Io=P.width/p.width,tn=P.height/p.height;B.each(function(D){if(D instanceof E&&C.isEditable(D)&&C.isRectEditable(D)){var s=n[D.getId()],M=y.$3l[D.getId()],l={x:s.x+s.width/2,y:s.y+s.height/2},q=0,H=0,m=b,Y=180*z(r-D.getRotation())/W;"northeast"===b?Y>=315||45>Y?(q=s.width*Io+s.x,H=s.height*(1-tn)+s.y,m="northeast"):Y>=45&&135>Y?(q=s.width*(1-tn)+s.x,H=s.height*(1-Io)+s.y,m="northwest"):Y>=135&&225>Y?(q=s.width*(1-Io)+s.x,H=s.height*tn+s.y,m="southwest"):(q=s.width*tn+s.x,H=s.height*Io+s.y,m="southeast"):"north"===b?Y>=315||45>Y?(H=s.height*(1-tn)+s.y,m="north"):Y>=45&&135>Y?(q=s.width*(1-tn)+s.x,m="west"):Y>=135&&225>Y?(H=s.height*tn+s.y,m="south"):(q=s.width*tn+s.x,m="east"):"northwest"===b?Y>=315||45>Y?(q=s.width*(1-Io)+s.x,H=s.height*(1-tn)+s.y,m="northwest"):Y>=45&&135>Y?(q=s.width*(1-tn)+s.x,H=s.height*Io+s.y,m="southwest"):Y>=135&&225>Y?(q=s.width*Io+s.x,H=s.height*tn+s.y,m="southeast"):(q=s.width*tn+s.x,H=s.height*(1-Io)+s.y,m="northeast"):"west"===b?Y>=315||45>Y?(q=s.width*(1-Io)+s.x,m="west"):Y>=45&&135>Y?(H=s.height*Io+s.y,m="south"):Y>=135&&225>Y?(q=s.width*Io+s.x,m="east"):(H=s.height*(1-Io)+s.y,m="north"):"southwest"===b?Y>=315||45>Y?(q=s.width*(1-Io)+s.x,H=s.height*tn+s.y,m="southwest"):Y>=45&&135>Y?(q=s.width*tn+s.x,H=s.height*Io+s.y,m="southeast"):Y>=135&&225>Y?(q=s.width*Io+s.x,H=s.height*(1-tn)+s.y,m="northeast"):(q=s.width*(1-tn)+s.x,H=s.height*(1-Io)+s.y,m="northwest"):"east"===b?Y>=315||45>Y?(q=s.width*Io+s.x,m="east"):Y>=45&&135>Y?(H=s.height*(1-Io)+s.y,m="north"):Y>=135&&225>Y?(q=s.width*(1-Io)+s.x,m="west"):(H=s.height*Io+s.y,m="south"):"south"===b?Y>=315||45>Y?(H=s.height*tn+s.y,m="south"):Y>=45&&135>Y?(q=s.width*tn+s.x,m="east"):Y>=135&&225>Y?(H=s.height*(1-tn)+s.y,m="north"):(q=s.width*(1-tn)+s.x,m="west"):"southeast"===b&&(Y>=315||45>Y?(q=s.width*Io+s.x,H=s.height*tn+s.y,m="southeast"):Y>=45&&135>Y?(q=s.width*tn+s.x,H=s.height*(1-Io)+s.y,m="northeast"):Y>=135&&225>Y?(q=s.width*(1-Io)+s.x,H=s.height*(1-tn)+s.y,m="northwest"):(q=s.width*(1-tn)+s.x,H=s.height*Io+s.y,m="southwest"));var G=sr(l,q-l.x,H-l.y,D.getRotation());Md(D,s,m,{x:G.x,y:G.y});var S=Jk+P.width*M.x,Z=Nc+P.height*M.y,L={x:S,y:Z};L=sr({x:Yl,y:lm},L.x-Yl,L.y-lm,r),D.p(L.x,L.y)}}),y.fi({kind:"betweenEditRect",event:s,direction:b})}else if(y.$23l&&y.$40l){var _k=y.$8l,qh=_k.width,Oj=_k.height,i={x:_k.x+qh/2,y:_k.y+Oj/2},N=y.$24l,bn=y.$23l,Tp=bn.x/v-i.x,lp=bn.y/v-i.y,Kh=V(Tp*Tp+lp*lp),ud=Math.asin(N.x/Kh),uk=C.sm().getSelection(),Sp=k+_(q.y-i.y,q.x-i.x)-ud,Kb=C.getSnapAngle(),Sp=f(Sp/Kb)*Kb;0>Sp&&(Sp+=m);var fp=Sp-y.$7l,yp=[i.x,0,i.y];uk.each(function(E){if(C.isEditable(E)&&C.isRotationEditable(E)&&C.isVisible(E)){var U=Sb(E.p3(),yp),w=io();eo(w,-fp),E.setRotation(E.getRotation()+fp),Zq(U,w),E.p3(yp[0]+U[0],yp[1]+U[1],yp[2]+U[2])}}),y.$7l=Sp,y.fi({kind:"betweenEditRotation",event:s})}else if([1,2,3,5,6].indexOf(y.$67l)>=0)y.$72l=s,y.$78l||(y.$78l=1,x(function(){U.isDragging()&&y.$43l(),delete y.$78l},12));else if(7===y.$67l){if(y.$87l instanceof L){var D=y.$87l,sc=y.$88l,ar=U.clone(D.getPoints().get(sc)),ti=q.y-ar.y;ar.e||(ar.e=0),y.$92l||(y.$92l=ar.e),ar.e=y.$92l-ti,D.setPoint(sc,ar)}else if(y.$87l instanceof T){var M=y.$87l,sc=y.$88l,w=Wq(C.getDataUI(M),M.s("edge.points")),ar=w.get(sc),ti=q.y-ar.y;ar.e||(ar.e=0),y.$92l||(y.$92l=ar.e),ar.e=y.$92l-ti,w.set(sc,ar),M.s("edge.points",Ef(w))}}else if(8===y.$67l){var uk=C.sm().getSelection(),Vg=y.$93l;Vg||(Vg=y.$93l={}),uk.each(function(z){if(z.p3){var g=z.p3(),j=Vg[z.getId()];j==O&&(j=Vg[z.getId()]=g[1]),z.p3([g[0],j-(q.y-y.$90l.y/v),g[2]])}})}else if(9===y.$67l){var uk=C.sm().getSelection(),Ar=y.$94l;Ar||(Ar=y.$94l={}),uk.each(function(s){if(s.s3){var G=s.s3(),X=Ar[s.getId()];X==O&&(X=Ar[s.getId()]=G[1]);var F=X-(q.y-y.$91l.y/v);0>F&&(F=.01),s.s3([G[0],F,G[2]])}})}},$79l:function(x,K){var V=this,S=V.gv,i=S.getZoom(),O=S.getEditHelperSize(),U=x.x/i,T=x.y/i,E=O/i,y=E/2;return h({x:U-y,y:T-y,width:E,height:E},K)?!0:void 0},_79I:function(m,v){var M=this,Y=M.gv,S=Y.getZoom(),e=Y.getEditPointSize(),X=e/S,d=X/2;if(M.$16l){var p,O=M.$16l,K=O[3].x-O[7].x,E=O[3].y-O[7].y,Q=V(K*K+E*E),A=O[1].x-O[5].x,c=O[1].y-O[5].y,R=V(A*A+c*c),x={x:v.x*S,y:v.y*S};if(M._80I(x,0,O[0],"northwest",Q,R)||M._80I(x,1,O[1],"north",Q,R)||M._80I(x,2,O[2],"northeast",Q,R)||M._80I(x,7,O[7],"west",Q,R)||M._80I(x,3,O[3],"east",Q,R)||M._80I(x,6,O[6],"southwest",Q,R)||M._80I(x,5,O[5],"south",Q,R)||M._80I(x,4,O[4],"southeast",Q,R))return!0}if(M.$23l){var g=M.$23l,U=g.x/S,N=g.y/S;if(h({x:U-d,y:N-d,width:X,height:X},v))return M.$40l=1,M.$12l="crosshair",!0}if(M.$68l&&M.$79l(M.$68l,v))return M.$67l=1,M.$12l="crosshair",!0;if(M.$69l&&M.$79l(M.$69l,v))return M.$67l=2,M.$12l="crosshair",!0;if(M.$70l&&M.$79l(M.$70l,v))return M.$67l=3,M.$12l="crosshair",!0;if(M.$71l&&M.$79l(M.$71l,v))return M.$67l=4,M.$12l="crosshair",!0;if(M.$82l&&M.$79l(M.$82l,v))return M.$67l=5,M.$12l="crosshair",!0;if(M.$83l&&M.$79l(M.$83l,v))return M.$67l=6,M.$12l="crosshair",!0;if(M._pointElevationHelperPoint&&M.$79l(M._pointElevationHelperPoint,v))return M.$67l=7,M.$12l="crosshair",!0;if(M.$90l&&M.$79l(M.$90l,v))return M.$67l=8,M.$12l="crosshair",!0;if(M.$91l&&M.$79l(M.$91l,v))return M.$67l=9,M.$12l="crosshair",!0;for(var I=M.$46l(m),i=0;i<I.length;i++){var p,G,k=I[i],H=Y.getDataUI(k);if(H&&H._55O){var l=H._55O;if(l._43O&&k instanceof T){if(p=k.s("edge.points"),p=Wq(H,p),G=k.s("edge.segments"),G||(G=vb(p)),M.$42l(k,v,p._as,G,"edge"))return!0;"points"===k.s("edge.type")&&M.$41l(k,v,p._as,G,"edge")}if(l._43O&&k instanceof L&&l.$15l&&l.$15l.length===k.getPoints().size()){if(p=l.$15l,G=k.getSegments(),G||(G=vb(p)),M.$42l(k,v,p,G,"shape"))return!0;M.$41l(k,v,p,G,"shape")}}}return!1},_80I:function(t,D,k,A,Z,m){var M=this,V=M.gv,o=V.getEditPointSize(),$=o/2,n=V.sm(),U=V.isDirectionEditable;if(U&&1===n.size()){var G=n.ld();if(U=U.bind(V),G instanceof E){if(!U(G,A))return!1;if("east"===A){if(U(G,"northeast")&&U(G,"southeast")&&2*o>=m)return!1}else if("west"===A){if(U(G,"northwest")&&U(G,"southwest")&&2*o>=m)return!1}else if("north"===A){if(U(G,"northwest")&&U(G,"northeast")&&2*o>=Z)return!1}else if("south"===A&&U(G,"southwest")&&U(G,"southeast")&&2*o>=Z)return!1}}else{if(2*o>=Z&&("north"===A||"south"===A))return!1;if(2*o>=m&&("east"===A||"west"===A))return!1}if(h({x:k.x-$,y:k.y-$,width:o,height:o},t)){if(M.$10l!==A){var K=180*M.$7l/W,P="";K>=337.5||22.5>K?P="north":K>=22.5&&67.5>K?P="northeast":K>=67.5&&112.5>K?P="east":K>=112.5&&157.5>K?P="southeast":K>=157.5&&202.5>K?P="south":K>=202.5&&247.5>K?P="southwest":K>=247.5&&292.5>K?P="west":K>=292.5&&337.5>K&&(P="northwest");var s=og.indexOf(P),P=og[D-(1-s)+8];switch(P){case"northwest":M.$12l="nwse-resize";break;case"northeast":M.$12l="nesw-resize";break;case"southwest":M.$12l="nesw-resize";break;case"southeast":M.$12l="nwse-resize";break;case"north":M.$12l="ns-resize";break;case"east":M.$12l="ew-resize";break;case"south":M.$12l="ns-resize";break;case"west":M.$12l="ew-resize"}M.$10l=A}return!0}return!1},$42l:function(c,W,X,V,t){var f,T=this,N=T.gv,U=N.getEditPointSize(),q=U/N.getZoom(),F=-1,O={x:W.x,y:W.y,width:0,height:0},B=function(u){"shape"===t?T._shape=c:T._edge=c,T._removePointIndex=u},K=function(f){"shape"===t?T._shape=c:T._edge=c,T.$13l=f,T.$12l="crosshair"};for(e(O,q/2),F=X.length-1,f=V.size()-1;f>=0;f--){var D=V.get(f);if(1===D||2===D)F-=1;else if(3===D){var m=X[F-1];if(h(O,m))return K(F-1),!0;F-=2}else if(4===D){var s=X[F-1],p=X[F-2];if(h(O,s))return K(F-1),!0;if(h(O,p))return K(F-2),!0;F-=3}}for(F=X.length-1,f=V.size()-1;f>=0;f--){var D=V.get(f),L=X[F];if(h(O,L))return B(F),K(F),!0;1===D||2===D?F-=1:3===D?F-=2:4===D&&(F-=3)}return!1},$41l:function(z,B,I,x,R){var W=this,y=W.gv,q=-1,g=0,n={x:B.x,y:B.y,width:0,height:0},G=function(l,s){W._hoverSegmentIndex=s,W._lp=B,"shape"===R?W._shape=z:W._edge=z};for(e(n,y.getSegmentHoverWidth()/2/y.getZoom()),z instanceof L&&z.isClosePath()&&x.indexOf(5)<0&&(x=new p(x._as),x.add(5));g<x.size();g++){var c=x.get(g);if(1===c){var Y=I[q],E=I[q+1];if(Y){var S=Vg(new Tq(Y.x,Y.y),new Tq(E.x,E.y),new Tq(n.x,n.y),new Tq(n.x+n.width,n.y+n.height));if(S.$62l===F&&S.points.length>0)return G(S,g),!0}q+=1}else if(2===c){var Y=I[q],E=I[q+1],S=Vg(new Tq(Y.x,Y.y),new Tq(E.x,E.y),new Tq(n.x,n.y),new Tq(n.x+n.width,n.y+n.height));if(S.$62l===F&&S.points.length>0)return G(S,g),!0;q+=1}else if(3===c){var Y=I[q],U=I[q+1],Q=I[q+2],S=hm(new Tq(Y.x,Y.y),new Tq(U.x,U.y),new Tq(Q.x,Q.y),new Tq(n.x,n.y),new Tq(n.x+n.width,n.y+n.height));if(S.$62l===F)return G(S,g),!0;q+=2}else if(4===c){var Y=I[q],V=I[q+1],r=I[q+2],Q=I[q+3],S=Yi(new Tq(Y.x,Y.y),new Tq(V.x,V.y),new Tq(r.x,r.y),new Tq(Q.x,Q.y),new Tq(n.x,n.y),new Tq(n.x+n.width,n.y+n.height));if(S.$62l===F)return G(S,g),!0;q+=3}else if(5===c){var Y=I[q],E=I[0];if(Y){var S=Vg(new Tq(Y.x,Y.y),new Tq(E.x,E.y),new Tq(n.x,n.y),new Tq(n.x+n.width,n.y+n.height));if(S.$62l===F&&S.points.length>0)return G(S,g),!0}}}return!1},addShapePoint:function(c,J,w){var D=this,r=D.gv,q=r.dm(),t=q.getHistoryManager();if(t&&t.beginInteraction(),0===arguments.length&&(c=D._shape||D._edge,J=D._hoverSegmentIndex,w=D._lp),c instanceof L||c instanceof T){var g=Un(c,r.getDataUI(c),J);if(!isNaN(J)&&w&&!isNaN(g)){var k=w;if(c instanceof L){var K=c.p(),S=c.getRotation(),j=c.toSegments();j||(j=vb(c.getPoints())),c.isClosePath()&&j.indexOf(5)<0&&(j=new p(j._as),j.add(5));var h=j.get(J),V="addPoint",C="removePointAt";if(2===h||1===h){var s={x:k.x,y:k.y};j.add(h,J),s=sr(K,s.x-K.x,s.y-K.y,-S),c[V](s,g+1)}else if(3===h){var W=c.getPoints(),u=W.get(g),Y=W.get(g+2),s={x:k.x,y:k.y};s=sr(K,s.x-K.x,s.y-K.y,-S);var o=ql(u,s),m=ql(s,Y);j.removeAt(J),j.add(3,J),j.add(3,J),c.setPoint(g+1,s),c[V](m,g+2),c[V](o,g+1)}else if(4===h){var W=c.getPoints(),u=W.get(g),Y=W.get(g+3),s={x:k.x,y:k.y};s=sr(K,s.x-K.x,s.y-K.y,-S);var o=Qg(u,s),m=Dn(u,s),G=Qg(s,Y),d=Dn(s,Y);j.removeAt(J),j.add(4,J),j.add(4,J),c[C](g+1),c[C](g+1),c[V](s,g+1),c[V](d,g+2),c[V](G,g+2),c[V](m,g+1),c[V](o,g+1)}else if(5===h){var s={x:k.x,y:k.y};j.add(2,J),s=sr(K,s.x-K.x,s.y-K.y,-S),c[V](s,g+1)}c.isClosePath()&&j.remove(5),c.setSegments(j);var Q=c.getWidth(),e=c.getHeight(),A=c.p().x-Q/2,F=c.p().y-e/2;A-=K.x,F-=K.y;var i=ik(c,{x:A,y:F,width:Q,height:e},S,K);c.p(i.x,i.y)}else if(c instanceof T){if("points"!==c.s("edge.type"))return t&&t.endInteraction(),void 0;var W=c.s("edge.points");j=c.s("edge.segments"),W=Wq(r.getDataUI(c),W),j||(j=vb(W)),j=new p(j._as.slice(0)),W=new p(W._as.slice(0));var h=j.get(J);if(2===h||1===h){var s={x:k.x,y:k.y};j.add(h,J),W.add(s,g+1)}else if(3===h){var u=W.get(g),Y=W.get(g+2),s={x:k.x,y:k.y},o=ql(u,s),m=ql(s,Y);j.removeAt(J),j.add(3,J),j.add(3,J),W.set(g+1,s),W.add(m,g+2),W.add(o,g+1)}else if(4===h){var u=W.get(g),Y=W.get(g+3),s={x:k.x,y:k.y},o=Qg(u,s),m=Dn(u,s),G=Qg(s,Y),d=Dn(s,Y);j.removeAt(J),j.add(4,J),j.add(4,J),W.removeAt(g+1),W.removeAt(g+1),W.add(s,g+1),W.add(d,g+2),W.add(G,g+2),W.add(m,g+1),W.add(o,g+1)}c.s("edge.points",Ef(W)),c.s("edge.segments",j)}}}t&&t.endInteraction()},removeShapePoint:function(A,a){var Q=this,M="removeAt",J=Q.gv,S=J.dm(),x=S.getHistoryManager();if(x&&x.beginInteraction(),0===arguments.length&&(A=Q._shape||Q._edge,a=Q._removePointIndex),a>=0&&(A instanceof L||A instanceof T)){var w=ip(A,Q.gv.getDataUI(A),a),O=a;if(A instanceof L){var Y=A.p(),c=A.toSegments();c||(c=vb(A.getPoints()));var q=c.get(w),h="removePointAt";if(1===q&&0===O)if(A.getPoints().size()>1){var r=c.get(w+1);c[M](w+1),3===r?A[h](O+1):4===r&&(A[h](O+2),A[h](O+1)),A[h](O)}else A.dm().remove(A);else 2===q||1===q?(c[M](w),A[h](O)):3===q?(c[M](w),A[h](O),A[h](O-1)):4===q&&(c[M](w),A[h](O),A[h](O-1),A[h](O-2));A.setSegments(c);var l=A.getWidth(),e=A.getHeight(),m=A.p().x-l/2,s=A.p().y-e/2;m-=Y.x,s-=Y.y;var n=ik(A,{x:m,y:s,width:l,height:e},A.getRotation(),Y);A.p(n.x,n.y)}else if(A instanceof T){if("points"!==A.s("edge.type"))return x&&x.endInteraction(),void 0;var G=A.s("edge.points");if(c=A.s("edge.segments"),G&&(G=Wq(Q.gv.getDataUI(A),G),c||(c=vb(G))),0===a||a===G.size()-1)return x&&x.endInteraction(),void 0;c=new p(c._as.slice(0)),G=new p(G._as.slice(0));var q=c.get(w);2===q||1===q?(c[M](w),G[M](O)):3===q?(c[M](w),G[M](O),G[M](O-1)):4===q&&(c[M](w),G[M](O),G[M](O-1),G[M](O-2)),A.s("edge.segments",c),A.s("edge.points",Ef(G))}}x&&x.endInteraction()},changeShapeSegment:function(y,x,s){var P=this,A=P.gv,d=A.dm(),u=d.getHistoryManager();if(u&&u.beginInteraction(),1!==arguments.length||isNaN(y)||(s=y,y=P._shape||P._edge,x=P._hoverSegmentIndex),y instanceof L||y instanceof T){var F=Un(y,P.gv.getDataUI(y),x);if(!isNaN(x)&&!isNaN(F))if(y instanceof L){var w=y.p(),h=y.toSegments();h||(h=vb(y.getPoints()));var N=h.get(x),n=y.toPoints();if(1===s||2===s)1===N||2===N?h.set(x,s):3===N?(h.set(x,s),n.removeAt(F+1)):4===N&&(h.set(x,s),n.removeAt(F+1),n.removeAt(F+1));else if(3===s){var i=function(){var O=n.get(F),H=n.get(F+1),U=ql(O,H);h.set(x,3),n.add(U,F+1)};2===N||1===N?i():4===N&&(n.removeAt(F+1),n.removeAt(F+1),i())}else if(4===s){var W=function(){var $=n.get(F),N=n.get(F+1),e=Qg($,N),w=Dn($,N);h.set(x,4),n.add(e,F+1),n.add(w,F+2)};2===N||1===N?W():3===N&&(n.removeAt(F+1),W())}y.setSegments(h),y.setPoints(n);var k=y.getWidth(),o=y.getHeight(),I=y.p().x-k/2,J=y.p().y-o/2;I-=w.x,J-=w.y;var C=new ik(y,{x:I,y:J,width:k,height:o},y.getRotation(),w);y.p(C.x,C.y)}else if(y instanceof T){if("points"!==y.s("edge.type"))return u&&u.endInteraction(),void 0;var n=y.s("edge.points");h=y.s("edge.segments"),n&&(n=Wq(P.gv.getDataUI(y),n),h||(h=vb(n))),h=new p(h._as.slice(0)),n=new p(n._as.slice(0));var N=h.get(x);if(1===s||2===s)1===N||2===N?h.set(x,s):3===N?(h.set(x,s),n.removeAt(F+1)):4===N&&(h.set(x,s),n.removeAt(F+1),n.removeAt(F+1));else if(3===s){var i=function(){var C=n.get(F),U=n.get(F+1),W=ql(C,U);h.set(x,3),n.add(W,F+1)};2===N||1===N?i():4===N&&(n.removeAt(F+1),n.removeAt(F+1),i())}else if(4===s){var W=function(){var D=n.get(F),y=n.get(F+1),O=Qg(D,y),s=Dn(D,y);h.set(x,4),n.add(O,F+1),n.add(s,F+2)};2===N||1===N?W():3===N&&(n.removeAt(F+1),W())}y.s("edge.points",Ef(n)),y.s("edge.segments",h)}}u&&u.endInteraction()},getDefaultSegments:function(p){var s=this.gv,W=s.getDataUI(p);if(p instanceof T){var n=p.s("edge.points");return n=Wq(W,n),vb(n)}if(p instanceof L){var n=p.getPoints(),c=p.getSegments();return c&&c.size()>0?c:vb(n)}},$43l:function(h){var B=this;h&&(B.$5l=1),B._68I=1,B._42()},_42:function(){var D=this;if(D._68I){delete D._68I;var C=D.gv,u=D.$5l,f=C.getZoom(),z=C.getEditPointSize(),x=z/2,d=new p,Z=D._view,M=D._edge,A=D._shape,F=Z.getContext("2d"),S=C.tx(),n=C.ty(),P=O,X=C.getEditPointBackground(),w=C.getControlPointBackground(),t=C.getControlPointBorderColor(),c=C.getEditPointBorderColor(),i=C.getEditRectBorderColor(),r=C.getDirectionLineColor(),k=C.getSegmentHoverColor(),I=C.getSnapPointBorderColor(),j=C.getJoinPointBackground(),W=C.getJoinPointBorderColor(),a=C.getSegmentHoverWidth(),$=[5,5],q=C.getEditRectBorderStyle();pb(C,function(n){C.isSelected(n)&&C.isVisible(n)&&d.add(n)}),F.clearRect(0,0,Q(Z.width),Q(Z.height)),F.save(),R.translateAndScale(F,S,n,1);var o=O,v={x:0,y:0,width:0,height:0},s=0,B=0,h=0,l=0,_=0,N=0,kf=0,kb=0,Dr=0,de=0,ms=[];if(u?(delete D.$6l,delete D.$8l,delete D.$7l,delete D.$16l,delete D.$23l):(o=D.$6l,P=D.$7l),delete D.$68l,delete D.$69l,delete D.$71l,delete D.$70l,delete D.$82l,delete D.$83l,delete D._pointElevationHelperPoint,delete D.$90l,delete D.$91l,delete D.$75l,delete D.$74l,d.each(function(m){var $=C.getDataUI(m);if($){var L=$._55O;if(C.isEditable(m))L._56O&&m instanceof E&&B++,ms.push(m),L._42O&&m instanceof E&&s++,C.isHelperEditable(m,"host")&&l++,C.isHelperEditable(m,"parent")&&h++,C.isHelperEditable(m,"remove")&&_++,C.isHelperEditable(m,"edge")&&N++,C.isHelperEditable(m,"source")&&kf++,C.isHelperEditable(m,"target")&&kb++,C.isHelperEditable(m,"elevation")&&Dr++,C.isHelperEditable(m,"tall")&&de++;else if(m instanceof G&&m.isExpanded()){var M=!0,q=C.getEditableFunc();q&&(M=q(m)),M&&(C.isHelperEditable(m,"host")&&l++,C.isHelperEditable(m,"parent")&&h++,C.isHelperEditable(m,"remove")&&_++,C.isHelperEditable(m,"edge")&&N++,C.isHelperEditable(m,"source")&&kf++,C.isHelperEditable(m,"target")&&kb++,C.isHelperEditable(m,"elevation")&&Dr++,C.isHelperEditable(m,"tall")&&de++,ms.push(m))}}}),F.beginPath(),F.lineWidth=1,F.strokeStyle=C.getNodeBorderColor(),ms.forEach(function(d){var p=C.getDataUI(d),X=p._55O;if(u)if(P==O&&(P=d instanceof T?0:d instanceof G&&d.isExpanded()?0:d.getRotation(),D.$7l=P),o==O){var Q,j,_;if(d instanceof G&&d.isExpanded()||d instanceof T){var U=C.getDataUIBounds(d);j=U.width,_=U.height,Q={x:U.x+j/2,y:U.y+_/2}}else Q=d.p(),j=d.getWidth(),_=d.getHeight();o={x:Q.x,y:Q.y,width:0,height:0},v.x=Q.x-j/2,v.y=Q.y-_/2,v.width=j,v.height=_,o=y(o,v)}else{var Q,j,_,B,r=o.x+o.width/2,Z=o.y+o.height/2,l={x:r,y:Z};if(d instanceof G&&d.isExpanded()||d instanceof T){B=0;var U=C.getDataUIBounds(d);j=U.width,_=U.height,Q={x:U.x+j/2,y:U.y+_/2}}else Q=d.p(),j=d.getWidth(),_=d.getHeight(),B=d.getRotation();var c={x:Q.x-j/2,y:Q.y-_/2,width:j,height:_},S={x:c.x,y:c.y},V={x:c.x+c.width,y:c.y},n={x:c.x,y:c.y+c.height},W={x:c.x+c.width,y:c.y+c.height},S=sr(Q,S.x-Q.x,S.y-Q.y,B),n=sr(Q,n.x-Q.x,n.y-Q.y,B),W=sr(Q,W.x-Q.x,W.y-Q.y,B),V=sr(Q,V.x-Q.x,V.y-Q.y,B),a=-P,L=sr(l,S.x-l.x,S.y-l.y,a),q=sr(l,V.x-l.x,V.y-l.y,a),N=sr(l,n.x-l.x,n.y-l.y,a),t=sr(l,W.x-l.x,W.y-l.y,a),k=K([L,q,N,t]);o=y(o,k),o.x-=r,o.y-=Z;var g=ik(O,o,P,l);o.x=g.x-o.width/2,o.y=g.y-o.height/2}if(s>1&&C.isEditable(d)&&C.isRectEditable(d)&&d instanceof E){var J=d.getRect(),w=X.$45l,A=Rl(w[0],f),$=Rl(w[2],f),x=Rl(w[4],f),Y=Rl(w[6],f);d.getRotation()?(F.moveTo(A.x,A.y),F.lineTo($.x,$.y),F.lineTo(x.x,x.y),F.lineTo(Y.x,Y.y),F.lineTo(A.x,A.y)):F.rect(J.x*f,J.y*f,J.width*f,J.height*f)}}),F.stroke(),d.each(function(K){var E=C.getDataUI(K);if(E){var c,Z,b=E._55O,S=E._78o;if(b&&b._43O&&K instanceof L?(c=b.$15l,Z=K.getSegments(),Z||(Z=vb(c)),K.isClosePath()&&Z.indexOf(5)<0&&(Z=new p(Z._as),Z.add(5))):b&&S&&b._43O&&(c=K.s("edge.points"),Z=K.s("edge.segments"),c=Wq(E,c),Z||(Z=vb(c)),c&&(c=c._as)),c&&Z){var n=0,T=Z.size(),y=D._hoverSegmentIndex;c=c.slice(0);for(var d=0;d<c.length;d++)c[d]=Rl(c[d],f);F.beginPath(),F.strokeStyle=r,F.lineWidth=1,n=0;for(var d=0;T>d;d++){var z=Z.get(d);if(1===z||2===z)n++;else if(3===z){var N=c[n-1],u=c[n],v=c[n+1];F.moveTo(N.x,N.y),F.lineTo(u.x,u.y),F.lineTo(v.x,v.y),n+=2}else if(4===z){var N=c[n-1],Q=c[n],o=c[n+1],v=c[n+2];F.moveTo(N.x,N.y),F.lineTo(Q.x,Q.y),F.moveTo(o.x,o.y),F.lineTo(v.x,v.y),n+=3}}if(F.stroke(),A===K||M===K&&"points"===M.s("edge.type")){F.beginPath(),n=0,F.strokeStyle=k,F.lineWidth=a;for(var d=0;T>d;d++){var z=Z.get(d);if(1===z||2===z){if(y===d){var N=c[n-1],v=c[n];F.moveTo(N.x,N.y),F.lineTo(v.x,v.y);break}n++}else if(3===z){if(y===d){var N=c[n-1],u=c[n],v=c[n+1];F.moveTo(N.x,N.y),F.quadraticCurveTo(u.x,u.y,v.x,v.y);break}n+=2}else if(4===z){if(y===d){var N=c[n-1],Q=c[n],o=c[n+1],v=c[n+2];F.moveTo(N.x,N.y),F.bezierCurveTo(Q.x,Q.y,o.x,o.y,v.x,v.y);break}n+=3}else if(5===z&&y===d){var N=c[n-1],v=c[0];F.moveTo(N.x,N.y),F.lineTo(v.x,v.y);break}}F.stroke()}F.beginPath(),n=0,F.strokeStyle=W,F.lineWidth=1,F.fillStyle=j;for(var d=0;T>d;d++){var z=Z.get(d);if(1===z||2===z){var v=c[n];F.moveTo(v.x+x,v.y),F.arc(v.x,v.y,x,0,m,!0),n++}else if(3===z){var v=c[n+1];F.moveTo(v.x+x,v.y),F.arc(v.x,v.y,x,0,m,!0),n+=2}else if(4===z){var v=c[n+2];F.moveTo(v.x+x,v.y),F.arc(v.x,v.y,x,0,m,!0),n+=3}}F.fill(),F.stroke(),F.beginPath(),n=0,F.strokeStyle=t,F.lineWidth=1,F.fillStyle=w;for(var d=0;T>d;d++){var z=Z.get(d);if(1===z||2===z)n++;else if(3===z){var u=c[n];F.moveTo(u.x+x,u.y),F.arc(u.x,u.y,x,0,m,!0),n+=2}else if(4===z){var Q=c[n],o=c[n+1];F.moveTo(Q.x+x,Q.y),F.arc(Q.x,Q.y,x,0,m,!0),F.moveTo(o.x+x,o.y),F.arc(o.x,o.y,x,0,m,!0),n+=3}}if(F.fill(),F.stroke(),F.beginPath(),n=0,F.strokeStyle=I,F.lineWidth=2,(A===K||M===K)&&D.$9l!=O){var v=c[D.$9l];F.moveTo(v.x+x,v.y),F.arc(v.x,v.y,x,0,m,!0),F.stroke()}}}}),o){D.$6l=b(o),e(o,C.getEditRectPadding()/f);var Nc={x:o.x+o.width/2,y:o.y+o.height/2},Sr=_n(Nc,o.width,o.height,P),kk=Sr[0],$o=Sr[1],Fg=Sr[2],cp=Sr[3],yc=Sr[4],Ij=Sr[5],Jc=Sr[6],ln=Sr[7];if(kk=Rl(Sr[0],f),$o=Rl(Sr[1],f),Fg=Rl(Sr[2],f),cp=Rl(Sr[3],f),yc=Rl(Sr[4],f),Ij=Rl(Sr[5],f),Jc=Rl(Sr[6],f),ln=Rl(Sr[7],f),D.$8l=o,s>0&&(D.$16l=[kk,yc,$o,Ij,cp,Jc,Fg,ln],F.beginPath(),F.lineWidth=1,F.strokeStyle=i,"dashed"===q&&F.setLineDash&&F.setLineDash($),F.moveTo(kk.x,kk.y),F.lineTo($o.x,$o.y),F.lineTo(cp.x,cp.y),F.lineTo(Fg.x,Fg.y),F.lineTo(kk.x,kk.y),F.stroke(),"dashed"===q&&F.setLineDash&&F.setLineDash([])),F.beginPath(),F.lineWidth=1,F.fillStyle=X,F.strokeStyle=c,s>0){var Fr=Ij.x-ln.x,kc=Ij.y-ln.y,bp=V(Fr*Fr+kc*kc),vh=yc.x-Jc.x,Wf=yc.y-Jc.y,xq=V(vh*vh+Wf*Wf),vk=2*z;if(C.isDirectionEditable&&1===ms.length){var ip=ms[0],cr=C.getDataUI(ip),Hn=cr._55O,gk=C.isDirectionEditable.bind(C);if(Hn._42O){var fd,Qk,pq,Vi;gk(ip,"northwest")&&(fd=!0,F.rect(kk.x-x,kk.y-x,z,z)),gk(ip,"northeast")&&(Qk=!0,F.rect($o.x-x,$o.y-x,z,z)),gk(ip,"southwest")&&(pq=!0,F.rect(Fg.x-x,Fg.y-x,z,z)),gk(ip,"southeast")&&(Vi=!0,F.rect(cp.x-x,cp.y-x,z,z)),gk(ip,"north")&&(fd&&Qk?bp>vk&&F.rect(yc.x-x,yc.y-x,z,z):F.rect(yc.x-x,yc.y-x,z,z)),gk(ip,"south")&&(Vi&&pq?bp>vk&&F.rect(Jc.x-x,Jc.y-x,z,z):F.rect(Jc.x-x,Jc.y-x,z,z)),gk(ip,"west")&&(pq&&fd?xq>vk&&F.rect(ln.x-x,ln.y-x,z,z):F.rect(ln.x-x,ln.y-x,z,z)),gk(ip,"east")&&(Vi&&Qk?xq>vk&&F.rect(Ij.x-x,Ij.y-x,z,z):F.rect(Ij.x-x,Ij.y-x,z,z))}}else bp>vk&&(F.rect(yc.x-x,yc.y-x,z,z),F.rect(Jc.x-x,Jc.y-x,z,z)),xq>vk&&(F.rect(Ij.x-x,Ij.y-x,z,z),F.rect(ln.x-x,ln.y-x,z,z)),F.rect(kk.x-x,kk.y-x,z,z),F.rect($o.x-x,$o.y-x,z,z),F.rect(Fg.x-x,Fg.y-x,z,z),F.rect(cp.x-x,cp.y-x,z,z)}if(B>0){var Ch=D.$23l=sr(yc,0,2*-z,P);F.moveTo(Ch.x+x,Ch.y),F.arc(Ch.x,Ch.y,x,0,m,!1)}F.fill(),F.stroke(),D.$40l&&D.$44l(F,o,P);var fs,Xd,yp=C.getLeftTopHelpers(),ho=C.getRightTopHelpers(),Ko=C.getLeftBottomHelpers(),Ok=C.getRightBottomHelpers(),zf=C.getEdgeHelpers(),pp=C.getEditHelperSize(),Dp=pp/2,uo=function(K,z,O,W){"leftTop"===z?(fs=o.x*f-pp-x-("h"===W?O*(pp+x):0)-1,Xd=o.y*f-pp-x-("v"===W?O*(pp+x):0)-1):"rightTop"===z?(fs=(o.x+o.width)*f+x+("h"===W?O*(pp+x):0)+1,Xd=o.y*f-pp-x-("v"===W?O*(pp+x):0)-1):"leftBottom"===z?(fs=o.x*f-pp-x-("h"===W?O*(pp+x):0)-1,Xd=(o.y+o.height)*f+x+("v"===W?O*(pp+x):0)+1):"rightBottom"===z&&(fs=(o.x+o.width)*f+x+("h"===W?O*(pp+x):0)+1,Xd=(o.y+o.height)*f+x+("v"===W?O*(pp+x):0)+1);var I=fs+Dp,$=Xd+Dp,b=(o.x+o.width/2)*f,w=(o.y+o.height/2)*f,s=sr({x:b,y:w},I-b,$-w,P);if("host"===K){if(l>0)return D.$77l(F,P,s),!0}else if("edge"===K){if(N>0)return D.$80l(F,P,s),!0}else if("remove"===K){if(_>0)return ms&&1===ms.length&&ms[0]instanceof T?D.$81l(F,P,{x:b+pp/2+5,y:w}):D.$81l(F,P,s),!0}else if("parent"===K){if(h>0)return ms&&1===ms.length&&ms[0]instanceof T?D.$76l(F,P,{x:b-pp/2-5,y:w}):D.$76l(F,P,s),!0}else if("elevation"===K){if(Dr>0)return D.$85l(F,P,s),!0}else if("tall"===K){if(de>0)return D.$86l(F,P,s),!0}else if("source"===K||"target"===K){var g=ms[0],J=C.getDataUI(g),B=hi(J,!0),v=B[0],e=B[1];if(kf&&"source"===K)return D.$84l(F,o,v,!0,g.isLooped(),z,O,W),!0;if(kb&&"target"===K)return D.$84l(F,o,e,!1,g.isLooped(),z,O,W),!0}};if(yp&&yp.length>0){var eo=0;yp.forEach(function(Q){uo(Q,"leftTop",eo,C.getLeftTopHelpersAlign()||"h")&&eo++})}if(ho&&ho.length>0){var eo=0;ho.forEach(function(U){uo(U,"rightTop",eo,C.getRightTopHelpersAlign()||"h")&&eo++})}if(Ko&&Ko.length>0){var eo=0;Ko.forEach(function(y){uo(y,"leftBottom",eo,C.getLeftBottomHelpersAlign()||"h")&&eo++})}if(Ok&&Ok.length>0){var eo=0;Ok.forEach(function(p){uo(p,"rightBottom",eo,C.getRightBottomHelpersAlign()||"h")&&eo++})}if(zf&&zf.length>0&&((kf||kb)&&ms&&1===ms.length&&ms[0]instanceof T?!0:!1)){var eo=0;zf.forEach(function(j){uo(j,"edge",eo,"h")&&eo++})}if(D.$72l){var rq,xp=D.$67l,Kf=D.$68l,ig=D.$69l,Zg=(D.$71l,D.$70l),ul=D.$82l,rb=D.$83l;if(1===xp?rq=Kf:2===xp?rq=ig:3===xp?rq=Zg:5===xp?rq=ul:6===xp&&(rq=rb),rq){var bo=C.lp(D.$72l),oj=C.getDataAt(D.$72l);if(oj&&oj instanceof E){var Yh,xb,yr;if(D.$73l=oj,1===xp)if(oj instanceof g.Grid)Yh=D.$75l=Pq(oj,bo);else if(oj instanceof g.Shape){yr=D.$74l=Tb(oj,bo);var vm=oj.getPoints();if(yr){var pg=yr.attachIndex,fb=Un(oj,C.getDataUI(oj),pg)+1,ai=fb+1>=vm.size()?0:fb+1,Ic=vm.get(fb),ur=vm.get(ai),Zn=oj.p(),Sl=oj.getRotation();Ic=sr(Zn,Ic.x-Zn.x,Ic.y-Zn.y,Sl),ur=sr(Zn,ur.x-Zn.x,ur.y-Zn.y,Sl),F.beginPath(),F.strokeStyle=k,F.lineWidth=a,F.moveTo(Ic.x*f,Ic.y*f),F.lineTo(ur.x*f,ur.y*f),F.stroke()}}Yh?xb=Yh.rect:(xb=U.clone(C.getDataUIBounds(oj)),U.grow(xb,2)),F.beginPath(),F.rect(xb.x*f,xb.y*f,xb.width*f,xb.height*f),F.strokeStyle=1===xp||4===xp||6===xp?J:H,F.lineWidth=2,F.setLineDash&&F.setLineDash([8,8]),F.stroke()}else delete D.$73l;bo.x=bo.x*f,bo.y=bo.y*f;var Kn=me(rq.x,rq.y,bo.x,bo.y),Ln=sr(rq,bo.x-rq.x,bo.y-rq.y,-Kn),xe=Ln.x-rq.x;F.translate(rq.x,rq.y),F.rotate(Kn),Y.width=xe,Y.height=40;var nl=H;(1===xp||4===xp||6===xp)&&(nl=J),Y.comps[0].gradientColor=nl,U.drawImage(F,Y,0,-20,xe,40)}}}if(D.$87l&&C.sm().contains(D.$87l)){var tn,gq=D.$87l,tb=D.$88l,pp=C.getEditHelperSize(),Dp=pp/2;if(C.isHelperEditable(gq,"pointElevation"))if(gq instanceof L){var Tc=gq.getPosition();tn=U.clone(gq.getPoints().get(tb)),tn=sr({x:Tc.x,y:Tc.y},tn.x-Tc.x,tn.y-Tc.y,gq.getRotation()),tn.x*=f,tn.y*=f,F.translate(tn.x,tn.y),U.drawImage(F,bg,Dp,-Dp,pp,pp),F.translate(-tn.x,-tn.y),D._pointElevationHelperPoint={x:tn.x+pp,y:tn.y}}else if(gq instanceof T){var _b=Wq(C.getDataUI(gq),gq.s("edge.points")),tn=U.clone(_b.get(tb));tn.x*=f,tn.y*=f,F.translate(tn.x,tn.y),U.drawImage(F,bg,Dp,-Dp,pp,pp),F.translate(-tn.x,-tn.y),D._pointElevationHelperPoint={x:tn.x+pp,y:tn.y}}}F.restore(),D.$5l=0}},$89l:function(X,m,F,I){X.save();var C=this,c=C.gv,T=c.getEditHelperSize(),J=T/2;X.beginPath(),X.translate(F.x,F.y),X.rotate(m),U.drawImage(X,I,-J,-J,T,T),X.restore()},$85l:function(O,Q,g){var y=this;y.$90l=g,y.$89l(O,Q,g,bg)},$86l:function(m,I,e){var M=this;M.$91l=e,M.$89l(m,I,e,Qr)},$77l:function(S,R,Q){var T=this;T.$68l=Q,T.$89l(S,R,Q,v)},$80l:function(w,q,K){var F=this;F.$70l=K,F.$89l(w,q,K,d)},$81l:function(K,J,Z){var $=this;$.$71l=Z,$.$89l(K,J,Z,qm)},$76l:function(b,J,N){var A=this;A.$69l=N,A.$89l(b,J,N,j)},$84l:function(f,E,O,Y,x){var m,p=this,H=p.gv,G=H.getZoom(),w=H.getEditHelperSize(),A=w/2;O.x*=G,O.y*=G,x&&(Y?O.x-=A+5:O.x+=A+5),O.y-=w-2,Y?(p.$82l=O,m=dg):(p.$83l=O,m=hh),f.beginPath(),f.translate(O.x,O.y),U.drawImage(f,m,-A,-A,w,w),f.translate(-O.x,-O.y)},$44l:function(d,H,L){d.save();var R=this.gv.getZoom(),o=V(r(H.width,2)+r(H.height,2))/2*R+10,w=o,I=w+8,T=w+18,b=L,p=H.x+H.width/2,z=H.y+H.height/2;d.translate(p*R,z*R),d.beginPath(),d.strokeStyle="rgb(150, 150, 150)";for(var t=0,K=0,x=0,C=0,J=0,E=0;360>E;E++)t=E*W/180,0===E%5&&(K=q(t)*w,x=N(t)*w,C=q(t)*I,J=N(t)*I,d.moveTo(K,x),d.lineTo(C,J)),0===E%45&&(K=q(t)*w,x=N(t)*w,C=q(t)*T,J=N(t)*T,d.moveTo(K,x),d.lineTo(C,J));d.stroke(),d.beginPath(),d.rotate(-k),d.beginPath(),d.fillStyle="rgba(255, 0, 0, 0.1)",d.strokeStyle="rgb(157, 157, 157)",d.moveTo(0,0),d.arc(0,0,T,0,L,!1),d.fill(),d.beginPath(),d.moveTo(0+T,0),d.arc(0,0,T,0,L,!1),d.stroke(),d.rotate(k),d.font="bold 12px Verdana, Arial";var u=20*N(b),$=20*q(b),P=f(180*b/W)+"°";d.textAlign="center",d.textBaseline="middle",d.beginPath();var h=d.measureText("365.°").width;d.fillStyle="white",d.rect(u-h/2,-$-10,h,20),d.fill(),d.beginPath(),d.fillStyle="rgb(79,79,79)",d.fillText(P,u,-$),d.restore()}})}(this,Object);