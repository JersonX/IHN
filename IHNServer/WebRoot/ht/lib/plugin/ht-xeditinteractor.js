!function(L,f,t){"use strict";var w="ht",S=L[w],a=S.Default,j=S.graph,N=a.getInternal(),_=N.ui(),W=_.NodeUI.prototype,z=_.ShapeUI.prototype,l=j.GraphView,K=l.prototype,C=_.EdgeUI.prototype,O=S.Node,E=S.Shape,H=S.Edge,D=S.Group,r=a.isTouchable,k=a.preventDefault,J=L.setTimeout,q=a.grow,Z=a.isDragging,x=a.getDistance,s=null,I=S.List,A="undefined"!=typeof Float32Array?Float32Array:Array,p=Math,B=p.PI,T="Crossing",G="No Crossing",i=B/2,n=2*B,U=p.atan2,o=p.sqrt,Y=p.pow,u=p.sin,c=p.cos,y=p.min,g=p.max,d=p.abs,h=p.ceil,e=p.round,P=a.unionPoint,F=a.unionRect,M=a.containsPoint,X=a.clone,V="rgb(52, 152, 219)",b="red",R={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},Q={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var G=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],k=0;k<G.length;k++){var K=G[k];K=0===k%2?K/400*Q.width:K/100*Q.height,G[k]=K}return Q.width>120&&(G[4]=Q.width-26,G[6]=Q.width-40,G[10]=Q.width-40,G[12]=Q.width-26,G[18]=33),G}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},m={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:V,rotation:.61},{type:"circle",rect:[200,120,70,70],background:V,rotation:.61},{type:"circle",rect:[200,220,70,70],background:V,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:V},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:V}]},v={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:b,rotation:.61}]},$={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:V},{type:"circle",rect:[0,210,90,90],background:V},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:V}]},jj={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:b},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:b}]},Nm={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:V}]},Vd={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:b}]},ls={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Qd={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Mo=function(s){var S=s.touches[0];return S?S:s.changedTouches[0]},en=function(D,e,l,N){return U(N-e,l-D)},uj=function(n,w){return{x:n.x*w,y:n.y*w}},Fh=function(U,H){var y,G,P,b,D=U._layers,p=U.sm().getSelection()._as,$=p.length;if(D)for(y=0;y<D.length;y++){b=D[y];for(var M=0;$>M;M++)if(G=p[M],G._layer===b&&(P=H(G),P===!1))return}else for(y=0;$>y;y++)if(G=p[y],P=H(G),P===!1)return},Gn=function(U,F,s){var b,y,v,B,j,g=this,R=F,Z=g.gv;if(U instanceof E){v=U.getSegments();var m=Z.getDataUI(U);j=m._55O.$15l,v||(v=Jm(j)),U.isClosePath()&&v.indexOf(5)<0&&(v=new I(v._as),v.add(5)),b=On(U,m,R),y=j[b]}else{var i=Z.getDataUI(U);j=sn(i,U.s("edge.points")),v=U.s("edge.segments"),v||(v=Jm(j)),j=j._as,b=On(U,i,R),y=j[b]}if(v&&(B=v.get(R)),2===B||1===B||5===B){var C=j[b+1];5===B&&(C=j[0]);var c=Qc(y,s,C);return c}return s},ni=function(M,C){var y,w,V,_,L=M._layers,K=M.sm().getSelection()._as,p=K.length;if(L)for(y=L.length-1;y>=0;y--){_=L[y];for(var t=p-1;t>=0;t--)if(w=K[t],w._layer===_&&(V=C(w),V===!1))return}else for(y=p-1;y>=0;y--)if(w=K[y],V=C(w),V===!1)return},yi=function(b,h,D,f){var j=h/2,r=D/2,J=rc(b,-j,-r,f),V=rc(b,j,-r,f),s=rc(b,-j,r,f),W=rc(b,j,r,f),q=rc(b,0,-r,f),P=rc(b,j,0,f),x=rc(b,0,r,f),e=rc(b,-j,0,f);return[J,V,s,W,q,P,x,e]},Qc=function(P,Z,n){var m={x:Z.x-P.x,y:Z.y-P.y},h={x:n.x-P.x,y:n.y-P.y},L=o(Y(n.x-P.x,2)+Y(n.y-P.y,2)),K={x:h.x/L,y:h.y/L},V=m.x*K.x+m.y*K.y,c={x:K.x*V,y:K.y*V};return{x:P.x+c.x,y:P.y+c.y}},rc=function(J,N,i,d){var z=c(d)*N-u(d)*i,h=u(d)*N+c(d)*i;return J?{x:J.x+z,y:J.y+h}:{x:z,y:h}},lh=function(R,I){return I>2*R?R:I/2},nm=function(r,d,L,U){var V=x(r,d);return L=U?y(L,V):lh(L,V),V?L/=V:L=0,{x:r.x+(d.x-r.x)*L,y:r.y+(d.y-r.y)*L}},vm=function(x,p,U,P,G){return p?(U=N.getPosition(U,N.getNodeRect(x,p)),U.x+=P||0,U.y+=G||0,U):s},ts=function(C,O){var u,g,T=C.gv,D=C._data,e=D._40I,o=D._41I,$=D.s("edge.offset"),J=D.s("edge.source.position"),s=D.s("edge.target.position"),V=D.s("edge.source.offset.x"),d=D.s("edge.source.offset.y"),i=D.s("edge.target.offset.x"),_=D.s("edge.target.offset.y");if(O?(u=vm(T,e,J,V,d),g=vm(T,o,s,i,_)):(u=vm(T,e,J),g=vm(T,o,s)),"points"===D.s("edge.type")&&$&&!D.s("edge.center")&&u){var Q=D.s("edge.points")||new I,n=Q.size(),F=nm(u,n?Q.get(0):g,$,n),A=nm(g,n?Q.get(n-1):u,$,n);u=F,g=A}return[u,g]},sn=function(K,w,U){var f=K._78o,e=K._data,q=e.s("edge.type"),Y=[f._69o,f._70o];return"points"===q?U&&(Y=ts(K)):Y=f.center?q?U?ts(K):ts(K,!0):U?ts(K):[f.c1,f.c2]:U?ts(K):ts(K,!0),w=new I(w?w._as:s),w.add(Y[0],0),w.add(Y[1]),w},hm=function(w){return w=new I(w._as),w.removeAt(0),w.removeAt(w.size()-1),w},Jm=function(K){K._as||(K=new I(K));var p=new I;p.add(1);for(var x=1;x<K.size();x++)p.add(2);return p},po=function(W,s){return{x:(W.x+s.x)/2,y:(W.y+s.y)/2}},Ap=function(t,n){return{x:t.x+1*(n.x-t.x)/4,y:t.y+1*(n.y-t.y)/4}},tj=function(C,L){return{x:C.x+3*(L.x-C.x)/4,y:C.y+3*(L.y-C.y)/4}},Jn=function(b,P,y,X){var S=P.x+P.width/2,V=P.y+P.height/2,N=o(S*S+V*V),T=U(V,S)+y;return{x:X.x+N*c(T),y:X.y+N*u(T)}},mo=K.validateImpl,cl=K.isRectEditable,mc=K.isPointEditable,Ik=K._42,Qq=z._79o,Dm=C._79o,Ko=z._48O,Zg=z._47O,qs=W._48O,Ce=W._80o,Ll=z._80o,df=W._2o,bp=W._47O,Ah=C._47O,ik=K.isEditable,Wq=["northwest","north","northeast","east","southeast","south","southwest","west"],Ch=function(i,W,U,o,I,Z,G,h,z,S){var c=i.x,q=i.y,w=i.width,b=i.height,g={x:c+w/2,y:q+b/2};o=o||0,W=rc(g,W.x-g.x,W.y-g.y,-o),G&&!h&&(W.x+=z,W.y+=S);var p=.01;if("northwest"===U?(W.x+I>c+w-p&&(W.x=c+w-I-p),W.y+I>q+b-p&&(W.y=q+b-I-p),i=P(W,{x:c+w,y:q+b})):"north"===U?(W.y+I>q+b-p&&(W.y=q+b-I-p),i=P({x:c,y:W.y},{x:c+w,y:q+b})):"northeast"===U?(W.x<c+I+p&&(W.x=c+I+p),W.y+I>q+b-p&&(W.y=q+b-I-p),i=P({x:c,y:W.y},{x:W.x,y:q+b})):"west"===U?(W.x+I>c+w-p&&(W.x=c+w-I-p),i=P({x:W.x,y:q},{x:c+w,y:q+b})):"east"===U?(W.x<c+I+p&&(W.x=c+I+p),i=P({x:c,y:q},{x:W.x,y:q+b})):"southwest"===U?(W.x+I>c+w-p&&(W.x=c+w-I-p),W.y<q+I+p&&(W.y=q+I+p),i=P({x:W.x,y:q},{x:c+w,y:W.y})):"south"===U?(W.y<q+I+p&&(W.y=q+I+p),i=P({x:c,y:q},{x:c+w,y:W.y})):"southeast"===U&&(W.x<c+I+p&&(W.x=c+I+p),W.y<q+I+p&&(W.y=q+I+p),i=P({x:c,y:q},W)),"keepRatio"===Z&&(!G&&h||G&&!h)&&("northeast"===U||"southeast"===U||"northwest"===U||"southwest"===U)){var f=i.width,m=i.height,N=f/w,a=m/b,_=y(N,a);i.width=w*_,i.height=b*_,"northeast"===U?i.y=q+(b-i.height):"northwest"===U?(i.y=q+(b-i.height),i.x=c+(w-i.width)):"southwest"===U&&(i.x=c+(w-i.width))}i.x-=g.x,i.y-=g.y;var E=Jn(s,i,o,g);return i.x=E.x-i.width/2,i.y=E.y-i.height/2,i},pq=function($,y,Y,d){var l=$.getRotation(),m=y,r=m.x,b=m.y,J=m.width,Z=m.height,k={x:r+m.width/2,y:b+m.height/2};d=rc(k,d.x-k.x,d.y-k.y,-l),"northwest"===Y?m=P(d,{x:r+J,y:b+Z}):"north"===Y?m=P({x:r,y:d.y},{x:r+J,y:b+Z}):"northeast"===Y?m=P({x:r,y:d.y},{x:d.x,y:b+Z}):"west"===Y?m=P({x:d.x,y:b},{x:r+J,y:b+Z}):"east"===Y?m=P({x:r,y:b},{x:d.x,y:b+Z}):"southwest"===Y?m=P({x:d.x,y:b},{x:r+J,y:d.y}):"south"===Y?m=P({x:r,y:b},{x:r+J,y:d.y}):"southeast"===Y&&(m=P({x:r,y:b},d)),$.setRect(m),m.x-=k.x,m.y-=k.y;var u=Jn($,m,l,k);$.p(u.x,u.y)},Rc=function(t,n,d,I,C,i,E,J){var c=s;i?(c=rc(s,C.x-n.x,C.y-n.y,-d),c.x-=E.x,c.y-=E.y):c=rc(s,C.x-n.x,C.y-n.y,0);var b={x:n.x+c.x,y:n.y+c.y};J&&(b=J(b.x,b.y)),b.e=t.getPoints().get(I).e,t.setPoint(I,b);var Y=t.getWidth(),u=t.getHeight(),N=t.p().x-Y/2,Q=t.p().y-u/2;N-=n.x,Q-=n.y;var z=Jn(t,{x:N,y:Q,width:Y,height:u},d,n);t.p(z.x,z.y)},On=function(A,F,Z){var Y,p;if(A instanceof E?(Y=A.getPoints(),p=A.getSegments()):A instanceof H&&"points"===A.s("edge.type")&&(Y=A.s("edge.points"),p=A.s("edge.segments"),Y=sn(F,Y)),p||(p=Jm(Y)),A instanceof E&&A.isClosePath()&&p.indexOf(5)<0&&(p=new I(p._as),p.add(5)),p)for(var h=-1,u=0;u<p.size();u++){if(u===Z)return h;var k=p.get(u);1===k?h+=1:2===k?h+=1:3===k?h+=2:4===k&&(h+=3)}},tm=function(r,t,h){var B,x;if(r instanceof E?(B=r.getPoints(),x=r.getSegments()):r instanceof H&&"points"===r.s("edge.type")&&(B=r.s("edge.points"),x=r.s("edge.segments"),B=sn(t,B)),x||(x=Jm(B)),x)for(var M=-1,z=0;z<x.size();z++){var p=x.get(z);if(1===p?M+=1:2===p?M+=1:3===p?M+=2:4===p&&(M+=3),M===h)return z}},Xo=function(X,x){var w=[X[0]-x[0],X[1]-x[1],X[2]-x[2]];return w},Ho=function(){var o=new A(16);return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},ce=function(W,w){var k=W[0],S=W[1],i=W[2];return W[0]=w[0]*k+w[4]*S+w[8]*i+w[12],W[1]=w[1]*k+w[5]*S+w[9]*i+w[13],W[2]=w[2]*k+w[6]*S+w[10]*i+w[14],W},bs=function(Z,W){if(W){var I=u(W),g=c(W),J=Z[0],E=Z[1],k=Z[2],L=Z[3],G=Z[8],P=Z[9],a=Z[10],r=Z[11];Z[0]=J*g-G*I,Z[1]=E*g-P*I,Z[2]=k*g-a*I,Z[3]=L*g-r*I,Z[8]=J*I+G*g,Z[9]=E*I+P*g,Z[10]=k*I+a*g,Z[11]=L*I+r*g}},Ag=function(E,X){for(var S=E.s("grid.row.count"),R=E.s("grid.column.count"),p=0;S>p;p++)for(var n=0;R>n;n++){var e=E.getCellRect(p,n);if(M(e,X))return{rowIndex:p,columnIndex:n,rect:e,grid:E}}return null},jd=function(Z,n,b,w,N,a){var R={},M=b-Z,v=w-n,S=p.sqrt(M*M+v*v),h=M/S,l=v/S,L=(-Z+N)*h+(-n+a)*l;return 0>=L?(R.x=Z,R.y=n):L>=S?(R.x=b,R.y=w):(R.x=Z+L*h,R.y=n+L*l),M=N-R.x,v=a-R.y,R.z=p.sqrt(M*M+v*v),R},Pq=function(h,u){var I,t,H,d,l,G,A,J,E=h.getPoints(),L=h.getSegments(),n=h.p(),K=h.getRotation();if(!L||!(L.indexOf(3)>0||L.indexOf(4)>0)){for(J=0;J<=E.size()-1;J++)if(J===E.size()-1?(l=E.get(0),d=E.get(J)):(d=E.get(J),l=E.get(J+1)),d=rc(n,d.x-n.x,d.y-n.y,K),l=rc(n,l.x-n.x,l.y-n.y,K),G=jd(d.x,d.y,l.x,l.y,u.x,u.y),A=G.z,A<(h.s("shape.border.width")||10)){t=d,H=l,I=J;break}if(I!=s){var Q=jd(t.x,t.y,H.x,H.y,u.x,u.y),y=x(t,Q);return{attachIndex:I,attachOffset:y}}}},yp=function(E){for(var i=E._data,l=i.p(),c=i.getRotation(),k=i.getPoints(),j=s,R=[],Y=0;Y<k.size();Y++)j=k.get(Y),R.push(rc(l,j.x-l.x,j.y-l.y,c));E._55O.$15l=R};K._editPointSize=r?24:9,K._edgeHelpers=["parent","remove","source","target"],K._leftTopHelpers=["parent"],K._rightTopHelpers=["host"],K._leftBottomHelpers=["edge"],K._rightBottomHelpers=["remove"],Wq=Wq.concat(Wq).concat(Wq),C._79o=function(){var h=this,M=h.gv,d=M.getZoom(),x=M._editInteractor,_=Dm.call(h),Z=ts(h,!0),D=Z[0],B=Z[1],b={x:_.x,y:_.y,width:_.width,height:_.height},S=P(D,B);if(x instanceof j.XEditInteractor){b=F(b,S);var C=h._55O,U=M.getEditPointSize()/d+2,y=0;C&&C._43O&&(y+=U/2,q(b,y))}return b},C._47O=function(E){var l=this,F=l.gv,I=F._editInteractor;I instanceof j.XEditInteractor||Ah.call(l,E)},C.rectIntersects=function(X){var x=this,n=x._data,Y=x.gv,V=Y.getZoom(),y=x._55O,t=Y._editInteractor;if(t instanceof j.XEditInteractor&&Y.isEditable(n)&&y&&y._43O&&"points"===n.s("edge.type")){var q=n.s("edge.points"),l=n.s("edge.segments");q=sn(x,q),l||(l=Jm(q)),q=q._as;var L=!1,d=r?5:1,Z=X.x+d,c=X.y+d,W={x:Z,y:c};if(t._edge===n&&t._hoverSegmentIndex>=0){var P=Y._editInteractor._hoverSegmentIndex,C=l.get(P),H=On(n,x,P),g=s;if(H!=s&&H>=0){var F=q[H],O=Y.getSegmentHoverWidth()/V;if(2===C||1===C){var G=q[H+1];g=Bb(new Bf(F.x,F.y),new Bf(G.x,G.y),new Bf(W.x-O,W.y-O),new Bf(W.x+2*O,W.y+2*O)),g.$62l===T&&(L=!0)}else if(3===C){var b=q[H+1],G=q[H+2];g=$l(new Bf(F.x,F.y),new Bf(b.x,b.y),new Bf(G.x,G.y),new Bf(W.x-O,W.y-O),new Bf(W.x+2*O,W.y+2*O)),g.$62l===T&&(L=!0)}else if(4===C){var i=q[H+1],f=q[H+2];G=q[H+3],g=_e(new Bf(F.x,F.y),new Bf(i.x,i.y),new Bf(f.x,f.y),new Bf(G.x,G.y),new Bf(W.x-O,W.y-O),new Bf(W.x+2*O,W.y+2*O)),g.$62l===T&&(L=!0)}}}if(L)return!0}return s},z._47O=function(f){var w=this,M=w.gv,r=M._editInteractor;r instanceof j.XEditInteractor||Zg.call(w,f)},z.rectIntersects=function(f){var Y=this,J=Y._data,l=Y.gv,k=l.getZoom(),X=Y._55O,d=l._editInteractor;if(d instanceof j.XEditInteractor&&l.isEditable(J)&&X&&X._43O){var z=X.$15l,K=!1,I=r?5:1,y=f.x+I,W=f.y+I,w={x:y,y:W};if(z&&z.length===J.getPoints().size()||(yp(Y),z=X.$15l),d._shape===J&&d._hoverSegmentIndex>=0){var R=J.getSegments();R||(R=Jm(z));var B=l._editInteractor._hoverSegmentIndex,c=R.get(B),A=On(J,Y,B),O=s;if(A!=s&&A>=0){var u=z[A],E=l.getSegmentHoverWidth()/k;if(2===c||1===c){var t=z[A+1];O=Bb(new Bf(u.x,u.y),new Bf(t.x,t.y),new Bf(w.x-E,w.y-E),new Bf(w.x+2*E,w.y+2*E)),O.$62l===T&&(K=!0)}else if(3===c){var m=z[A+1],t=z[A+2];O=$l(new Bf(u.x,u.y),new Bf(m.x,m.y),new Bf(t.x,t.y),new Bf(w.x-E,w.y-E),new Bf(w.x+2*E,w.y+2*E)),O.$62l===T&&(K=!0)}else if(4===c){var U=z[A+1],Z=z[A+2];t=z[A+3],O=_e(new Bf(u.x,u.y),new Bf(U.x,U.y),new Bf(Z.x,Z.y),new Bf(t.x,t.y),new Bf(w.x-E,w.y-E),new Bf(w.x+2*E,w.y+2*E)),O.$62l===T&&(K=!0)}}}if(K)return!0}return s},z._48O=function(){var N=this,t=N.gv,s=t._editInteractor;s instanceof j.XEditInteractor?(W._48O.call(N),N._55O._43O&&yp(N)):Ko.call(N)},z._79o=function(){var t=this,C=t.gv,U=C.getZoom(),E=C._editInteractor,L=Qq.call(t);if(L){var K={x:L.x,y:L.y,width:L.width,height:L.height};if(E instanceof j.XEditInteractor){var n=t._55O,I=C.getEditPointSize()/U+2,X=0;n&&n._43O&&(X+=I/2,q(K,X))}return K}},W._47O=function(V){var k=this,U=k.gv,T=U._editInteractor;if(T instanceof j.XEditInteractor);else{var o=k._55O;o&&o._98o&&bp.call(k,V)}},W._2o=function(){var J=this,X=J.gv,b=X._editInteractor,h=J._data;return X.isEditable(h)&&b instanceof j.XEditInteractor?0:df.call(J)},W._80o=function(b){var D=this,w=D.gv._editInteractor;if(Ce.call(D,b),w&&w._debug){b.save(),b.beginPath(),b.lineWidth=1,b.strokeStyle="green";var G=D._79o();G&&(b.rect(G.x,G.y,G.width,G.height),b.stroke()),b.restore()}},z._80o=function(i){var K=this,L=K.gv._editInteractor;if(Ll.call(K,i),L&&L._debug){i.save(),i.beginPath(),i.lineWidth=1,i.strokeStyle="green";var $=K._79o();i.rect($.x,$.y,$.width,$.height),i.stroke(),i.restore()}},W._48O=function(){var v=this,x=v.gv,k=v._data,u=x._editInteractor,F=v._55O,K=k.p(),c=k.getRotation();if(u instanceof j.XEditInteractor){if(F._42O){var s=yi(K,k.getWidth(),k.getHeight(),c),V=s[0],E=s[1],Q=s[2],h=s[3],Y=s[4],W=s[5],d=s[6],N=s[7];F.$45l=[V,Y,E,W,h,d,Q,N]}}else qs.call(v)},K.getResizeMode=function(){return this.$25l||"normal"},K.setResizeMode=function(f){var y=this.$25l;this.$25l=f,this.fp("resizeMode",y,f)},K.getSnapAngle=function(){return this.$26l||Math.PI/36},K.setSnapAngle=function(Q){var Z=this.$26l;this.$26l=Q,this.fp("snapAngle",Z,Q)},K.getSnapSpacing=function(){return this.$27l},K.setSnapSpacing=function(h){var H=this.$27l;this.$27l=h,this.fp("snapSpacing",H,h)},K.getPointSnapSpacing=function(){return this._pointSnapSpacing},K.setPointSnapSpacing=function(R){var P=this._pointSnapSpacing;this._pointSnapSpacing=R,this.fp("pointSnapSpacing",P,R)},K.setHelperEditableFunc=function(J){var y=this._helperEditableFunc;this._helperEditableFunc=J,this.fp("helperEditableFunc",y,J)},K.getHelperEditableFunc=function(){return this._helperEditableFunc},K.setLeftTopHelpers=function(o){var s=this._leftTopHelpers;this._leftTopHelpers=o,this.fp("leftTopHelpers",s,o)},K.getLeftTopHelpers=function(){return this._leftTopHelpers},K.setLeftTopHelpersAlign=function(b){var B=this._leftTopHelpersAlign;this._leftTopHelpersAlign=b,this.fp("leftTopHelpersAlign",B,b)},K.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},K.setRightTopHelpers=function(v){var d=this._rightTopHelpers;this._rightTopHelpers=v,this.fp("rightTopHelpers",d,v)},K.getRightTopHelpers=function(){return this._rightTopHelpers},K.setRightTopHelpersAlign=function(O){var j=this._rightTopHelpersAlign;this._rightTopHelpersAlign=O,this.fp("rightTopHelpersAlign",j,O)},K.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},K.setLeftBottomHelpers=function(W){var O=this._leftBottomHelpers;this._leftBottomHelpers=W,this.fp("leftBottomHelpers",O,W)},K.getLeftBottomHelpers=function(){return this._leftBottomHelpers},K.setLeftBottomHelpersAlign=function(y){var h=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=y,this.fp("leftBottomHelpersAlign",h,y)},K.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},K.setRightBottomHelpers=function(w){var S=this._rightBottomHelpers;this._rightBottomHelpers=w,this.fp("rightBottomHelpers",S,w)},K.getRightBottomHelpers=function(){return this._rightBottomHelpers},K.setRightBottomHelpersAlign=function(c){var D=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=c,this.fp("rightBottomHelpersAlign",D,c)},K.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},K.setEdgeHelpers=function(e){var x=this._edgeHelpers;this._edgeHelpers=e,this.fp("edgeHelpers",x,e)},K.getEdgeHelpers=function(){return this._edgeHelpers},K.isHelperEditable=function(J,k){return J instanceof H&&("host"===k||"edge"===k||"elevation"===k||"tall"===k)?!1:J instanceof O&&("source"===k||"target"===k)?!1:"pointElevation"===k?this._helperEditableFunc?this._helperEditableFunc(J,k):!1:this._helperEditableFunc?this._helperEditableFunc(J,k):!0},K.getEditHelperSize=function(){return this._editHelperSize||(r?28:16)},K.setEditHelperSize=function(x){var a=this._editHelperSize;this._editHelperSize=x,this.fp("editHelperSize",a,x)},K.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},K.setEditRectBorderColor=function(o){var R=this.$28l;this.$28l=o,this.fp("editRectBorderColor",R,o)},K.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},K.setNodeBorderColor=function(p){var X=this.$29l;this.$29l=p,this.fp("nodeBorderColor",X,p)},K.getEditRectBorderStyle=function(){return this.$30l||"dashed"},K.setEditRectBorderStyle=function(h){var g=this.$30l;this.$30l=h,this.fp("editRectBorderStyle",g,h)},K.getControlPointBackground=function(){return this.$31l||"#ff0"},K.setControlPointBackground=function(F){var _=this.$31l;this.$31l=F,this.fp("controlPointBackground",_,F)},K.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},K.setControlPointBorderColor=function(P){var e=this.$32l;this.$32l=P,this.fp("controlPointBorderColor",e,P)},K.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},K.setJoinPointBackground=function(S){var q=this.$33l;this.$33l=S,this.fp("joinPointBackground",q,S)},K.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},K.setJoinPointBorderColor=function(V){var R=this.$34l;this.$34l=V,this.fp("joinPointBorderColor",R,V)},K.getDirectionLineColor=function(){return this.$35l||"#888"},K.setDirectionLineColor=function(X){var o=this.$35l;this.$35l=X,this.fp("directionLineColor",o,X)},K.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},K.setSegmentHoverColor=function(B){var W=this.$36l;this.$36l=B,this.fp("segmentHoverColor",W,B)},K.getSegmentHoverWidth=function(){return this.$22l||(r?16:8)},K.setSegmentHoverWidth=function(T){var c=this.$22l;this.$22l=T,this.fp("segmentHoverWidth",c,T)},K.getSnapPointBorderColor=function(){return this.$38l||"#f00"},K.setSnapPointBorderColor=function(T){var t=this.$38l;this.$38l=T,this.fp("snapPointBorderColor",t,T)},K.getEditRectPadding=function(){return this.$39l!=s?this.$39l:6},K.setEditRectPadding=function(q){var l=this.$39l;this.$39l=q,this.fp("editRectPading",l,q)},K.isRectEditable=function(w){var D=this,W=D._editInteractor;return W instanceof j.XEditInteractor?D._rectEditableFunc?D._rectEditableFunc(w):!0:cl.call(D,w)},K.isPointEditable=function(N){var W=this,d=W._editInteractor;return d instanceof j.XEditInteractor?W._pointEditableFunc?W._pointEditableFunc(N):!0:mc.call(W,N)},K.validateImpl=function(){var U=this,L=U.$14l,K=U._editInteractor;if(L){var Z=U.getWidth(),u=U.getHeight();(Z!==L.clientWidth||u!==L.clientHeight)&&(K&&(K._68I=1),N.setCanvas(L,Z,u),U._32I=1)}mo.call(this)},K.isEditable=function(U){var Y=ik.call(this,U),M=this._editInteractor;if(M instanceof j.XEditInteractor&&U instanceof H){U.getSource()==U.getTarget()&&(Y=!1);var R=this.getEditableFunc();Y=R?R(U):!0}return Y},K._42=function(m,X){var x=this,v=x._editInteractor;Ik.call(x,m,X),v instanceof j.XEditInteractor&&v._68I&&v._42()},K.isSnapPoint=function(){return!0};var Yf=function(B){arguments.length>0&&this.$58l(B)},Tn=Yf.prototype;Tn.$58l=function(q){this.$62l=q,this.points=new Array},Tn.$56l=function(w){this.points.push(w)},Tn.$57l=function(O){this.points=this.points.concat(O)};var Bf=function(q,x){arguments.length>0&&this.$58l(q,x)},zd=Bf.prototype;zd.$58l=function(P,B){this.x=P,this.y=B},zd.add=function(t){return new Bf(this.x+t.x,this.y+t.y)},zd.addEquals=function(p){return this.x+=p.x,this.y+=p.y,this},zd.$55l=function(N){return new Bf(this.x*N,this.y*N)},zd.eq=function(_){return this.x==_.x&&this.y==_.y},zd.lt=function(t){return this.x<t.x&&this.y<t.y},zd.lte=function(h){return this.x<=h.x&&this.y<=h.y},zd.gt=function(D){return this.x>D.x&&this.y>D.y},zd.gte=function(Q){return this.x>=Q.x&&this.y>=Q.y},zd.lerp=function($,A){return new Bf(this.x+($.x-this.x)*A,this.y+($.y-this.y)*A)},zd.distanceFrom=function(n){var p=this.x-n.x,N=this.y-n.y;return o(p*p+N*N)},zd.min=function(B){return new Bf(y(this.x,B.x),y(this.y,B.y))},zd.max=function(o){return new Bf(g(this.x,o.x),g(this.y,o.y))},zd.toString=function(){return this.x+","+this.y};var fm=function(){this.$58l(arguments)},We=fm.prototype;fm.TO=1e-6,fm.AC=6,We.$58l=function(i){this.co=new Array;for(var z=i.length-1;z>=0;z--)this.co.push(i[z])},We.$55l=function(u){for(var i=new fm,b=0;b<=this.$50l()+u.$50l();b++)i.co.push(0);for(var b=0;b<=this.$50l();b++)for(var x=0;x<=u.$50l();x++)i.co[b+x]+=this.co[b]*u.co[x];return i},We.$59l=function(){for(var E=this.$50l();E>=0&&d(this.co[E])<=fm.TO;E--)this.co.pop()},We.$50l=function(){return this.co.length-1},We.$51l=function(){var O;switch(this.$59l(),this.$50l()){case 0:O=new Array;break;case 1:O=this.$52l();break;case 2:O=this.$53l();break;case 3:O=this.$54l();break;case 4:O=this.$63l();break;default:O=new Array}return O},We.$52l=function(){var b=new Array,l=this.co[1];return 0!=l&&b.push(-this.co[0]/l),b},We.$53l=function(){var C=new Array;if(2==this.$50l()){var S=this.co[2],Z=this.co[1]/S,T=this.co[0]/S,E=Z*Z-4*T;if(E>0){var z=o(E);C.push(.5*(-Z+z)),C.push(.5*(-Z-z))}else 0==E&&C.push(.5*-Z)}return C},We.$63l=function(){var E=new Array;if(4==this.$50l()){var m=this.co[4],c=this.co[3]/m,L=this.co[2]/m,l=this.co[1]/m,F=this.co[0]/m,O=new fm(1,-L,c*l-4*F,-c*c*F+4*L*F-l*l).$54l(),k=O[0],C=c*c/4-L+k;if(d(C)<=fm.TO&&(C=0),C>0){var Q=o(C),q=3*c*c/4-Q*Q-2*L,R=(4*c*L-8*l-c*c*c)/(4*Q),Z=q+R,U=q-R;if(d(Z)<=fm.TO&&(Z=0),d(U)<=fm.TO&&(U=0),Z>=0){var H=o(Z);E.push(-c/4+(Q+H)/2),E.push(-c/4+(Q-H)/2)}if(U>=0){var H=o(U);E.push(-c/4+(H-Q)/2),E.push(-c/4-(H+Q)/2)}}else if(0>C);else{var R=k*k-4*F;if(R>=-fm.TO){if(0>R&&(R=0),R=2*o(R),q=3*c*c/4-2*L,q+R>=fm.TO){var w=o(q+R);E.push(-c/4+w/2),E.push(-c/4-w/2)}if(q-R>=fm.TO){var w=o(q-R);E.push(-c/4+w/2),E.push(-c/4-w/2)}}}}return E},We.$54l=function(){var W=new Array;if(3==this.$50l()){var J=this.co[3],v=this.co[2]/J,B=this.co[1]/J,G=this.co[0]/J,k=(3*B-v*v)/3,r=(2*v*v*v-9*B*v+27*G)/27,s=v/3,l=r*r/4+k*k*k/27,D=r/2;if(d(l)<=fm.TO&&(l=0),l>0){var F,P,x=o(l);F=-D+x,P=F>=0?Y(F,1/3):-Y(-F,1/3),F=-D-x,F>=0?P+=Y(F,1/3):P-=Y(-F,1/3),W.push(P-s)}else if(0>l){var R=o(-k/3),E=U(o(-l),-D)/3,V=c(E),O=u(E),I=o(3);W.push(2*R*V-s),W.push(-R*(V+I*O)-s),W.push(-R*(V-I*O)-s)}else{var F;F=D>=0?-Y(D,1/3):Y(-D,1/3),W.push(2*F-s),W.push(-F-s)}}return W};var Oe=function(Y,O){arguments.length>0&&this.$58l(Y,O)},ge=Oe.prototype;ge.$58l=function(H,u){this.x=H,this.y=u},ge.length=function(){return o(this.x*this.x+this.y*this.y)},ge.$60l=function(e){return this.x*e.x+this.y*e.y};var Uq=function(M,Z,U,P){var I,n=(P.x-U.x)*(M.y-U.y)-(P.y-U.y)*(M.x-U.x),f=(Z.x-M.x)*(M.y-U.y)-(Z.y-M.y)*(M.x-U.x),c=(P.y-U.y)*(Z.x-M.x)-(P.x-U.x)*(Z.y-M.y);if(0!=c){var l=n/c,E=f/c;l>=0&&1>=l&&E>=0&&1>=E?(I=new Yf(T),I.points.push(new Bf(M.x+l*(Z.x-M.x),M.y+l*(Z.y-M.y)))):I=new Yf(G)}else I=0==n||0==f?new Yf("C"):new Yf("P");return I},hr=function(S,u,l,w,n){var A,c,$,U,v,P,k,H=w.min(n),W=w.max(n),h=new Yf(G);A=u.$55l(-2),$=S.add(A.add(l)),A=S.$55l(-2),c=u.$55l(2),U=A.add(c),v=new Bf(S.x,S.y),k=new Oe(w.y-n.y,n.x-w.x),P=w.x*n.y-n.x*w.y;for(var z=new fm(k.$60l($),k.$60l(U),k.$60l(v)+P).$51l(),X=0;X<z.length;X++){var g=z[X];if(g>=0&&1>=g){var I=S.lerp(u,g),p=u.lerp(l,g),R=I.lerp(p,g);w.x==n.x?H.y<=R.y&&R.y<=W.y&&(h.$62l=T,h.$56l(R)):w.y==n.y?H.x<=R.x&&R.x<=W.x&&(h.$62l=T,h.$56l(R)):R.gte(H)&&R.lte(W)&&(h.$62l=T,h.$56l(R))}}return h},$l=function(f,H,k,s,p){var I=s.min(p),i=s.max(p),j=new Bf(i.x,I.y),t=new Bf(I.x,i.y),q=hr(f,H,k,I,j),E=hr(f,H,k,j,i),e=hr(f,H,k,i,t),r=hr(f,H,k,t,I),L=new Yf(G);return L.$57l(q.points),L.$57l(E.points),L.$57l(e.points),L.$57l(r.points),L.points.length>0&&(L.$62l=T),L},Vr=function(C,f,O,o,M,j){var n,S,t,a,z,s,k,u,e,$,w=M.min(j),U=M.max(j),Y=new Yf(G);n=C.$55l(-1),S=f.$55l(3),t=O.$55l(-3),a=n.add(S.add(t.add(o))),z=new Oe(a.x,a.y),n=C.$55l(3),S=f.$55l(-6),t=O.$55l(3),a=n.add(S.add(t)),s=new Oe(a.x,a.y),n=C.$55l(-3),S=f.$55l(3),t=n.add(S),k=new Oe(t.x,t.y),u=new Oe(C.x,C.y),$=new Oe(M.y-j.y,j.x-M.x),e=M.x*j.y-j.x*M.y;for(var l=new fm($.$60l(z),$.$60l(s),$.$60l(k),$.$60l(u)+e).$51l(),m=0;m<l.length;m++){var p=l[m];if(p>=0&&1>=p){var W=C.lerp(f,p),L=f.lerp(O,p),P=O.lerp(o,p),K=W.lerp(L,p),B=L.lerp(P,p),d=K.lerp(B,p);M.x==j.x?w.y<=d.y&&d.y<=U.y&&(Y.$62l=T,Y.$56l(d)):M.y==j.y?w.x<=d.x&&d.x<=U.x&&(Y.$62l=T,Y.$56l(d)):d.gte(w)&&d.lte(U)&&(Y.$62l=T,Y.$56l(d))}}return Y},_e=function(o,B,K,k,w,s){var S=w.min(s),J=w.max(s),$=new Bf(J.x,S.y),m=new Bf(S.x,J.y),_=Vr(o,B,K,k,S,$),A=Vr(o,B,K,k,$,J),D=Vr(o,B,K,k,J,m),c=Vr(o,B,K,k,m,S),q=new Yf(G);return q.$57l(_.points),q.$57l(A.points),q.$57l(D.points),q.$57l(c.points),q.points.length>0&&(q.$62l=T),q},Bb=function(g,z,y,F){var q=y.min(F),d=y.max(F),i=new Bf(d.x,q.y),X=new Bf(q.x,d.y),$=Uq(q,i,g,z),K=Uq(i,d,g,z),A=Uq(d,X,g,z),p=Uq(X,q,g,z),r=new Yf(G);return r.$57l($.points),r.$57l(K.points),r.$57l(A.points),r.$57l(p.points),r.points.length>0&&(r.$62l=T),r},lj=j.XEditInteractor=function(w){var V=this,m=V._view=document.createElement("canvas");m.className="editCanvas",m.style.position="absolute",lj.superClass.constructor.call(V,w)};a.def(lj,j.Interactor,{ms_edit:1,setUp:function(){var S=this,n=S.gv,W=n.getView(),t=S._view;lj.superClass.setUp.call(S),n.setEditInteractor(S),n.$14l=t,n._79O?W.insertBefore(t,n._79O):W.appendChild(t);var A=S.$49l=S.$11l.bind(S);n.dm().md(A),n.sm().ms(A),n.mp(A)},tearDown:function(){var L=this,I=L.gv,D=I.getView(),k=L.$49l;lj.superClass.tearDown.call(L),I.setEditInteractor(s),I.$14l=s,D.removeChild(L._view),I.dm().umd(k),I.sm().ums(k),I.ump(k)},clear:function(){var Q=this,I=Q.gv;delete Q._hoverSegmentIndex,delete Q._edge,delete Q._shape,delete I._editing,delete Q.$10l,delete Q.$13l,delete Q.$9l,delete Q._removePointIndex,delete Q._lp,Q.$12l="",delete Q.$40l,delete Q.$67l,delete Q.$72l,delete Q.$73l,delete Q.$75l,delete Q.$1l,delete Q.$3l,delete Q.$2l,delete Q.$92l,delete Q.$93l,delete Q.$94l,Q.clearDragging()},handle_keydown:function(O){this.$48l!==O.shiftKey&&(this.$48l=O.shiftKey,this.handle_mousemove(O,t,!0))},handle_keyup:function(x){this.$48l!==x.shiftKey&&(this.$48l=x.shiftKey,this.handle_mousemove(x,t,!0))},handle_touchstart:function(d){this.handle_mousemove(d),this.handle_mousedown(d)},handle_mousedown:function(H){k(H);var G=this,Y=G.$13l,C=G.gv,A=C.dm(),m=A.getHistoryManager(),D=C.sm(),s=C.getZoom(),u=C.lp(H),q=a.isDoubleClick(H),y=a.isLeftButton(H),F=G.$7l,g=G._shape,f=G._hoverSegmentIndex,z=G._edge,w=G.$87l,c=G.$88l,V=function(){G._68I||w===G.$87l&&c===G.$88l||G.$43l()};if(7!==G.$67l&&(delete G.$87l,delete G.$88l),y&&(g||z)&&f>=0&&q&&(g&&D.contains(g)||z&&D.contains(z))){var b=Gn.call(G,g||z,f,u);return G.addShapePoint(g||z,f,b),J(function(){G.handle_mousemove(H)},40),void 0}if(y&&(g||z)&&G._removePointIndex>=0&&q)return G.removeShapePoint(),G.$5l=1,J(function(){G.handle_mousemove(H)},40),void 0;if(!y||!C._editing)return V(),void 0;if(g&&Y>=0){var U=g.getPoints().get(Y),T=g.p(),$=rc(T,U.x-T.x,U.y-T.y,-F+g.getRotation());p=rc(T,u.x-T.x,u.y-T.y,-F),G.$24l={x:p.x-$.x,y:p.y-$.y},G.startDragging(H),m&&m.beginInteraction(),G.fi({kind:"beginEditPoint",event:H,data:g,index:Y}),G.$88l=Y,G.$87l=g}else if(G.$10l){var t=C.sm().getSelection(),L=G.$6l,i=G.$1l={},I=G.$3l={},E=G.$16l[R[G.$10l]],x={x:L.x,y:L.y},o={x:L.x+L.width/2,y:L.y+L.height/2};G.$24l={x:u.x-E.x/s,y:u.y-E.y/s},G.$2l=X(G.$8l),G.$4l=X(L),t.each(function(Z){if(Z instanceof O){var C=Z.p(),E=Z.getWidth(),Y=Z.getHeight(),H=rc(o,C.x-o.x,C.y-o.y,-F);i[Z.getId()]={x:C.x-E/2,y:C.y-Y/2,width:E,height:Y},I[Z.getId()]={x:(H.x-x.x)/L.width,y:(H.y-x.y)/L.height}}}),G.startDragging(H),m&&m.beginInteraction(),G.fi({kind:"beginEditRect",event:H,direction:G.$10l})}else if(z&&Y>=0){var W=sn(C.getDataUI(z),z.s("edge.points")),U=W.get(Y);G.$24l={x:u.x-U.x,y:u.y-U.y},G.startDragging(H),m&&m.beginInteraction(),G.fi({kind:"beginEditPoint",event:H,data:z,index:Y}),G.$88l=Y,G.$87l=z}else if(G.$40l){var L=G.$6l,o={x:L.x+L.width/2,y:L.y+L.height/2},K=X(G.$23l);K.x/=s,K.y/=s;var e=rc(o,K.x-o.x,K.y-o.y,-F),p=rc(o,u.x-o.x,u.y-o.y,-F);G.$24l={x:p.x-e.x,y:p.y-e.y},G.startDragging(H),m&&m.beginInteraction(),G.fi({kind:"beginEditRotation",event:H,data:G._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(G.$67l)>=0)G.startDragging(H);else if(G.$71l&&q&&G.$79l(G.$71l,u)){var _=D.toSelection();m&&m.beginInteraction(),_.each(function(k){A.remove(k)}),m&&m.endInteraction()}V()},$11l:function(){var B=this,g=B.gv;g._editing&&(B.$13l==s||B._shape==s&&B._edge==s)&&(B.$73l==s||1!==B.$67l&&5!==B.$67l&&6!==B.$67l)||(B.$5l=1),B._68I=1},$46l:function(G){var P=this,b=P.gv,Y=b.lp(G),A=[];return ni(b,function(I){var m=b.getDataUI(I);if(m){var N=m._79o();M(N,Y)&&A.push(I)}}),A},$47l:function(G){var j=this,y=j.$13l,a=j.gv.dm(),R=a.getHistoryManager();j.$10l?(j.fi({kind:"endEditRect",event:G,direction:j.$10l}),R&&R.endInteraction()):j._shape&&y>=0?(j.fi({kind:"endEditPoint",event:G,data:j._shape,index:y}),R&&R.endInteraction()):j._edge&&y>=0?(j.fi({kind:"endEditPoint",event:G,data:j._edge,index:y}),R&&R.endInteraction()):j.$23l&&j.$40l&&(j.fi({kind:"endEditRotation",event:G}),R&&R.endInteraction())},handleWindowTouchEnd:function(x){this.handleWindowMouseUp(x)},handleWindowMouseUp:function(c){var W=this,E=W.gv,F=E.dm(),d=F.getHistoryManager(),L=W._shape,$=W._edge,X=W.$13l,C=W.$40l,M=W.$9l,e=W.$10l,Q=W.$67l;if((L||$)&&X>=0&&M>=0){var G,q;if(L){var I=L.p(),Y=L.getRotation();G=L.getPoints(),q=G.get(M),Rc(L,I,Y,X,q,!1)}else if(G=sn(E.getDataUI($),$.s("edge.points"),!0),q=G.get(M),0===X){var U=G.get(0);$.s("edge.source.offset.x",q.x-U.x),$.s("edge.source.offset.y",q.y-U.y)}else if(X===G.size()-1){var w=G.get(G.size()-1);$.s("edge.target.offset.x",q.x-w.x),$.s("edge.target.offset.y",q.y-w.y)}else"points"===$.s("edge.type")&&(G.set(X,q),$.s("edge.points",hm(G)))}W.$47l(c);var y=W.$73l;1===Q?(d&&d.beginInteraction(),y?E.sm().each(function(T){if(T.setHost&&E.isHelperEditable(T,"host")){T.setHost(y);var h=W.$75l,v=W.$74l;h&&(T.s("attach.row.index",h.rowIndex),T.s("attach.column.index",h.columnIndex)),v&&(T.s("attach.index",v.attachIndex),T.s("attach.offset",v.attachOffset),T.s("attach.offset.relative",!1),T.s("attach.offset.opposite",!1))
}}):E.sm().each(function(K){K.setHost&&E.isHelperEditable(K,"host")&&(K.setHost(s),K.s("attach.row.index",t),K.s("attach.column.index",t),K.s("attach.index",t),K.s("attach.offset",t),K.s("attach.offset.relative",!1),K.s("attach.offset.opposite",!1))}),d&&d.endInteraction()):2===Q?(d&&d.beginInteraction(),y?E.sm().each(function(Y){Y.setParent&&E.isHelperEditable(Y,"parent")&&Y.setParent(y)}):E.sm().each(function(Q){Q.setParent&&E.isHelperEditable(Q,"parent")&&Q.setParent(s)}),d&&d.endInteraction()):3===Q?y&&(d&&d.beginInteraction(),E.sm().each(function(L){if(E.isHelperEditable(L,"edge")&&L instanceof O&&y instanceof O){var N=new S.Edge;F.add(N),N.setSource(L),N.setTarget(y),W.onEdgeCreated&&W.onEdgeCreated(c,N)}}),d&&d.endInteraction()):(5===Q||6===Q)&&y&&(d&&d.beginInteraction(),E.sm().each(function(j){j instanceof H&&y instanceof O&&(5===Q&&E.isHelperEditable(j,"source")?j.setSource(y):6===Q&&E.isHelperEditable(j,"source")&&j.setTarget(y))}),d&&d.endInteraction()),(e||C)&&W.$43l(!0),r?(W.clear(),delete W.$64l,W._68I||W.$43l()):(W.handle_mousemove(c,!0),Q&&!W._68I&&W.$43l())},handleWindowTouchMove:function(h){this.handleWindowMouseMove(h)},handleWindowMouseMove:function(q){this._78I(q)},handle_mousemove:function(Y,R,A){if(!this._pause){if(!A){var e=r?Mo(Y):Y;this.$61l={clientX:e.clientX,clientY:e.clientY}}if(R===!0||!Z()){var L=this,T=L.gv,V=!1,D=s;L.clear(),T.sm().size()>0&&(D=T.lp(A?L.$61l:Y),V=L._79I(Y,D)),V&&(T._editing=1),L.$12l!==L.$65l&&(L.$65l=L.$12l,L.setCursor(L.$12l)),L.$40l!==L.$64l&&(L.$64l=L.$40l,L._68I||L.$43l()),L._hoverSegmentIndex!==L.$66l&&(L.$66l=L._hoverSegmentIndex,L._68I||L.$43l())}}},_78I:function(q){this.autoScroll(q);var W=this,N=W.gv,w=N.lp(q),S=N.getZoom(),F=W.$13l;if((W._shape||W._edge)&&F>=0){var $,t,A,M=W._shape,D=W._edge,u=W.$24l,l=N.getPointSnapSpacing(),_=function(d,H){return l==s||isNaN(l)?{x:d,y:H}:{x:e(d/l)*l,y:e(H/l)*l}};if(M){$=M.getPoints();var m=M.p(),z=M.getRotation(),T=0;t=rc(m,w.x-m.x,w.y-m.y,-z),Rc(M,m,z,F,w,!0,u,_),W.fi({kind:"betweenEditPoint",event:q,data:M,index:F})}else if(D){$=sn(N.getDataUI(D),D.s("edge.points"),!0),w.x-=u.x,w.y-=u.y,t=w;var Y,j;if(0===F){var V=$.get(0);Y=w.x-V.x,j=w.y-V.y,A=_(Y,j),D.s("edge.source.offset.x",A.x),D.s("edge.source.offset.y",A.y)}else if(F===$.size()-1){var p=$.get($.size()-1);Y=w.x-p.x,j=w.y-p.y,A=_(Y,j),D.s("edge.target.offset.x",A.x),D.s("edge.target.offset.y",A.y)}else"points"===D.s("edge.type")&&(A=_(w.x,w.y),A.e=$.get(F).e,$.set(F,A),D.s("edge.points",hm($)));W.fi({kind:"betweenEditPoint",event:q,data:D,index:F})}if(delete W.$9l,N.isSnapPoint(M)||N.isSnapPoint(D))for(T=0;T<$.size();T++)if(T!==F){var Z=$.get(T);if(x(Z,t)<N.getEditPointSize()/S){W.$9l=T;break}}}else if(W.$10l){var u=W.$24l;w.x-=u.x,w.y-=u.y;var f=N.sm().getSelection(),h=W.$1l,g=W.$7l,k=W.$10l,r=W.$4l,Q=W.$2l,C=N.getEditRectPadding()/S,R=2*C,I=N.getSnapSpacing(),y=I!=s&&!isNaN(I),K=Ch(Q,w,k,g,2*C,N.getResizeMode(),y,!0),G=W.$6l;if(y){var P=K.width-R,v=K.height-R,L=e(P/I)*I,X=e(v/I)*I,c=L-P,b=X-v;("west"===k||"northwest"===k||"southwest"===k)&&(c=-c),("north"===k||"northwest"===k||"northeast"===k)&&(b=-b),K=Ch(Q,w,k,g,2*C,N.getResizeMode(),y,!1,c,b)}W.$8l=K,G.x=K.x+C,G.y=K.y+C,G.width=K.width-R,G.height=K.height-R;var ac=K.x+K.width/2,mn=K.y+K.height/2,Yk=G.x,Yl=G.y,yh=G.width/r.width,si=G.height/r.height;f.each(function(u){if(u instanceof O&&N.isEditable(u)&&N.isRectEditable(u)){var $=h[u.getId()],r=W.$3l[u.getId()],I={x:$.x+$.width/2,y:$.y+$.height/2},C=0,o=0,Q=k,b=180*d(g-u.getRotation())/B;"northeast"===k?b>=315||45>b?(C=$.width*yh+$.x,o=$.height*(1-si)+$.y,Q="northeast"):b>=45&&135>b?(C=$.width*(1-si)+$.x,o=$.height*(1-yh)+$.y,Q="northwest"):b>=135&&225>b?(C=$.width*(1-yh)+$.x,o=$.height*si+$.y,Q="southwest"):(C=$.width*si+$.x,o=$.height*yh+$.y,Q="southeast"):"north"===k?b>=315||45>b?(o=$.height*(1-si)+$.y,Q="north"):b>=45&&135>b?(C=$.width*(1-si)+$.x,Q="west"):b>=135&&225>b?(o=$.height*si+$.y,Q="south"):(C=$.width*si+$.x,Q="east"):"northwest"===k?b>=315||45>b?(C=$.width*(1-yh)+$.x,o=$.height*(1-si)+$.y,Q="northwest"):b>=45&&135>b?(C=$.width*(1-si)+$.x,o=$.height*yh+$.y,Q="southwest"):b>=135&&225>b?(C=$.width*yh+$.x,o=$.height*si+$.y,Q="southeast"):(C=$.width*si+$.x,o=$.height*(1-yh)+$.y,Q="northeast"):"west"===k?b>=315||45>b?(C=$.width*(1-yh)+$.x,Q="west"):b>=45&&135>b?(o=$.height*yh+$.y,Q="south"):b>=135&&225>b?(C=$.width*yh+$.x,Q="east"):(o=$.height*(1-yh)+$.y,Q="north"):"southwest"===k?b>=315||45>b?(C=$.width*(1-yh)+$.x,o=$.height*si+$.y,Q="southwest"):b>=45&&135>b?(C=$.width*si+$.x,o=$.height*yh+$.y,Q="southeast"):b>=135&&225>b?(C=$.width*yh+$.x,o=$.height*(1-si)+$.y,Q="northeast"):(C=$.width*(1-si)+$.x,o=$.height*(1-yh)+$.y,Q="northwest"):"east"===k?b>=315||45>b?(C=$.width*yh+$.x,Q="east"):b>=45&&135>b?(o=$.height*(1-yh)+$.y,Q="north"):b>=135&&225>b?(C=$.width*(1-yh)+$.x,Q="west"):(o=$.height*yh+$.y,Q="south"):"south"===k?b>=315||45>b?(o=$.height*si+$.y,Q="south"):b>=45&&135>b?(C=$.width*si+$.x,Q="east"):b>=135&&225>b?(o=$.height*(1-si)+$.y,Q="north"):(C=$.width*(1-si)+$.x,Q="west"):"southeast"===k&&(b>=315||45>b?(C=$.width*yh+$.x,o=$.height*si+$.y,Q="southeast"):b>=45&&135>b?(C=$.width*si+$.x,o=$.height*(1-yh)+$.y,Q="northeast"):b>=135&&225>b?(C=$.width*(1-yh)+$.x,o=$.height*(1-si)+$.y,Q="northwest"):(C=$.width*(1-si)+$.x,o=$.height*yh+$.y,Q="southwest"));var p=rc(I,C-I.x,o-I.y,u.getRotation());pq(u,$,Q,{x:p.x,y:p.y});var R=Yk+G.width*r.x,Y=Yl+G.height*r.y,M={x:R,y:Y};M=rc({x:ac,y:mn},M.x-ac,M.y-mn,g),u.p(M.x,M.y)}}),W.fi({kind:"betweenEditRect",event:q,direction:k})}else if(W.$23l&&W.$40l){var cf=W.$8l,Zo=cf.width,Go=cf.height,m={x:cf.x+Zo/2,y:cf.y+Go/2},u=W.$24l,hf=W.$23l,Hb=hf.x/S-m.x,Lo=hf.y/S-m.y,yc=o(Hb*Hb+Lo*Lo),Cq=Math.asin(u.x/yc),cd=N.sm().getSelection(),Br=i+U(w.y-m.y,w.x-m.x)-Cq,Qn=N.getSnapAngle(),Br=e(Br/Qn)*Qn;0>Br&&(Br+=n);var zc=Br-W.$7l,In=[m.x,0,m.y];cd.each(function(Y){if(N.isEditable(Y)&&N.isRotationEditable(Y)&&N.isVisible(Y)){var C=Xo(Y.p3(),In),s=Ho();bs(s,-zc),Y.setRotation(Y.getRotation()+zc),ce(C,s),Y.p3(In[0]+C[0],In[1]+C[1],In[2]+C[2])}}),W.$7l=Br,W.fi({kind:"betweenEditRotation",event:q})}else if([1,2,3,5,6].indexOf(W.$67l)>=0)W.$72l=q,W.$78l||(W.$78l=1,J(function(){a.isDragging()&&W.$43l(),delete W.$78l},12));else if(7===W.$67l){if(W.$87l instanceof E){var M=W.$87l,eq=W.$88l,Vq=a.clone(M.getPoints().get(eq)),Qk=w.y-Vq.y;Vq.e||(Vq.e=0),W.$92l||(W.$92l=Vq.e),Vq.e=W.$92l-Qk,M.setPoint(eq,Vq)}else if(W.$87l instanceof H){var D=W.$87l,eq=W.$88l,$=sn(N.getDataUI(D),D.s("edge.points")),Vq=$.get(eq),Qk=w.y-Vq.y;Vq.e||(Vq.e=0),W.$92l||(W.$92l=Vq.e),Vq.e=W.$92l-Qk,$.set(eq,Vq),D.s("edge.points",hm($))}}else if(8===W.$67l){var cd=N.sm().getSelection(),Oh=W.$93l;Oh||(Oh=W.$93l={}),cd.each(function(b){if(b.p3){var Y=b.p3(),j=Oh[b.getId()];j==s&&(j=Oh[b.getId()]=Y[1]),b.p3([Y[0],j-(w.y-W.$90l.y/S),Y[2]])}})}else if(9===W.$67l){var cd=N.sm().getSelection(),Di=W.$94l;Di||(Di=W.$94l={}),cd.each(function(J){if(J.s3){var D=J.s3(),m=Di[J.getId()];m==s&&(m=Di[J.getId()]=D[1]);var y=m-(w.y-W.$91l.y/S);0>y&&(y=.01),J.s3([D[0],y,D[2]])}})}},$79l:function(O,r){var U=this,E=U.gv,x=E.getZoom(),a=E.getEditHelperSize(),N=O.x/x,f=O.y/x,k=a/x,n=k/2;return M({x:N-n,y:f-n,width:k,height:k},r)?!0:void 0},_79I:function(B,q){var I=this,i=I.gv,s=i.getZoom(),w=i.getEditPointSize(),j=w/s,N=j/2;if(I.$16l){var C,g=I.$16l,G=g[3].x-g[7].x,n=g[3].y-g[7].y,m=o(G*G+n*n),F=g[1].x-g[5].x,J=g[1].y-g[5].y,K=o(F*F+J*J),z={x:q.x*s,y:q.y*s};if(I._80I(z,0,g[0],"northwest",m,K)||I._80I(z,1,g[1],"north",m,K)||I._80I(z,2,g[2],"northeast",m,K)||I._80I(z,7,g[7],"west",m,K)||I._80I(z,3,g[3],"east",m,K)||I._80I(z,6,g[6],"southwest",m,K)||I._80I(z,5,g[5],"south",m,K)||I._80I(z,4,g[4],"southeast",m,K))return!0}if(I.$23l){var p=I.$23l,_=p.x/s,U=p.y/s;if(M({x:_-N,y:U-N,width:j,height:j},q))return I.$40l=1,I.$12l="crosshair",!0}if(I.$68l&&I.$79l(I.$68l,q))return I.$67l=1,I.$12l="crosshair",!0;if(I.$69l&&I.$79l(I.$69l,q))return I.$67l=2,I.$12l="crosshair",!0;if(I.$70l&&I.$79l(I.$70l,q))return I.$67l=3,I.$12l="crosshair",!0;if(I.$71l&&I.$79l(I.$71l,q))return I.$67l=4,I.$12l="crosshair",!0;if(I.$82l&&I.$79l(I.$82l,q))return I.$67l=5,I.$12l="crosshair",!0;if(I.$83l&&I.$79l(I.$83l,q))return I.$67l=6,I.$12l="crosshair",!0;if(I._pointElevationHelperPoint&&I.$79l(I._pointElevationHelperPoint,q))return I.$67l=7,I.$12l="crosshair",!0;if(I.$90l&&I.$79l(I.$90l,q))return I.$67l=8,I.$12l="crosshair",!0;if(I.$91l&&I.$79l(I.$91l,q))return I.$67l=9,I.$12l="crosshair",!0;for(var e=I.$46l(B),O=0;O<e.length;O++){var C,f,Y=e[O],Z=i.getDataUI(Y);if(Z&&Z._55O){var v=Z._55O;if(v._43O&&Y instanceof H){if(C=Y.s("edge.points"),C=sn(Z,C),f=Y.s("edge.segments"),f||(f=Jm(C)),I.$42l(Y,q,C._as,f,"edge"))return!0;"points"===Y.s("edge.type")&&I.$41l(Y,q,C._as,f,"edge")}if(v._43O&&Y instanceof E&&v.$15l&&v.$15l.length===Y.getPoints().size()){if(C=v.$15l,f=Y.getSegments(),f||(f=Jm(C)),I.$42l(Y,q,C,f,"shape"))return!0;I.$41l(Y,q,C,f,"shape")}}}return!1},_80I:function(w,h,Q,U,b,S){var l=this,m=l.gv,r=m.getEditPointSize(),$=r/2,D=m.sm(),V=m.isDirectionEditable;if(V&&1===D.size()){var c=D.ld();if(V=V.bind(m),c instanceof O){if(!V(c,U))return!1;if("east"===U){if(V(c,"northeast")&&V(c,"southeast")&&2*r>=S)return!1}else if("west"===U){if(V(c,"northwest")&&V(c,"southwest")&&2*r>=S)return!1}else if("north"===U){if(V(c,"northwest")&&V(c,"northeast")&&2*r>=b)return!1}else if("south"===U&&V(c,"southwest")&&V(c,"southeast")&&2*r>=b)return!1}}else{if(2*r>=b&&("north"===U||"south"===U))return!1;if(2*r>=S&&("east"===U||"west"===U))return!1}if(M({x:Q.x-$,y:Q.y-$,width:r,height:r},w)){if(l.$10l!==U){var i=180*l.$7l/B,p="";i>=337.5||22.5>i?p="north":i>=22.5&&67.5>i?p="northeast":i>=67.5&&112.5>i?p="east":i>=112.5&&157.5>i?p="southeast":i>=157.5&&202.5>i?p="south":i>=202.5&&247.5>i?p="southwest":i>=247.5&&292.5>i?p="west":i>=292.5&&337.5>i&&(p="northwest");var u=Wq.indexOf(p),p=Wq[h-(1-u)+8];switch(p){case"northwest":l.$12l="nwse-resize";break;case"northeast":l.$12l="nesw-resize";break;case"southwest":l.$12l="nesw-resize";break;case"southeast":l.$12l="nwse-resize";break;case"north":l.$12l="ns-resize";break;case"east":l.$12l="ew-resize";break;case"south":l.$12l="ns-resize";break;case"west":l.$12l="ew-resize"}l.$10l=U}return!0}return!1},$42l:function(J,s,u,b,h){var U,g=this,X=g.gv,S=X.getEditPointSize(),B=S/X.getZoom(),D=-1,G={x:s.x,y:s.y,width:0,height:0},v=function(v){"shape"===h?g._shape=J:g._edge=J,g._removePointIndex=v},H=function(n){"shape"===h?g._shape=J:g._edge=J,g.$13l=n,g.$12l="crosshair"};for(q(G,B/2),D=u.length-1,U=b.size()-1;U>=0;U--){var K=b.get(U);if(1===K||2===K)D-=1;else if(3===K){var a=u[D-1];if(M(G,a))return H(D-1),!0;D-=2}else if(4===K){var c=u[D-1],x=u[D-2];if(M(G,c))return H(D-1),!0;if(M(G,x))return H(D-2),!0;D-=3}}for(D=u.length-1,U=b.size()-1;U>=0;U--){var K=b.get(U),j=u[D];if(M(G,j))return v(D),H(D),!0;1===K||2===K?D-=1:3===K?D-=2:4===K&&(D-=3)}return!1},$41l:function(i,W,p,f,B){var J=this,v=J.gv,Q=-1,e=0,Y={x:W.x,y:W.y,width:0,height:0},z=function(Y,m){J._hoverSegmentIndex=m,J._lp=W,"shape"===B?J._shape=i:J._edge=i};for(q(Y,v.getSegmentHoverWidth()/2/v.getZoom()),i instanceof E&&i.isClosePath()&&f.indexOf(5)<0&&(f=new I(f._as),f.add(5));e<f.size();e++){var C=f.get(e);if(1===C){var L=p[Q],A=p[Q+1];if(L){var k=Bb(new Bf(L.x,L.y),new Bf(A.x,A.y),new Bf(Y.x,Y.y),new Bf(Y.x+Y.width,Y.y+Y.height));if(k.$62l===T&&k.points.length>0)return z(k,e),!0}Q+=1}else if(2===C){var L=p[Q],A=p[Q+1],k=Bb(new Bf(L.x,L.y),new Bf(A.x,A.y),new Bf(Y.x,Y.y),new Bf(Y.x+Y.width,Y.y+Y.height));if(k.$62l===T&&k.points.length>0)return z(k,e),!0;Q+=1}else if(3===C){var L=p[Q],G=p[Q+1],D=p[Q+2],k=$l(new Bf(L.x,L.y),new Bf(G.x,G.y),new Bf(D.x,D.y),new Bf(Y.x,Y.y),new Bf(Y.x+Y.width,Y.y+Y.height));if(k.$62l===T)return z(k,e),!0;Q+=2}else if(4===C){var L=p[Q],O=p[Q+1],c=p[Q+2],D=p[Q+3],k=_e(new Bf(L.x,L.y),new Bf(O.x,O.y),new Bf(c.x,c.y),new Bf(D.x,D.y),new Bf(Y.x,Y.y),new Bf(Y.x+Y.width,Y.y+Y.height));if(k.$62l===T)return z(k,e),!0;Q+=3}else if(5===C){var L=p[Q],A=p[0];if(L){var k=Bb(new Bf(L.x,L.y),new Bf(A.x,A.y),new Bf(Y.x,Y.y),new Bf(Y.x+Y.width,Y.y+Y.height));if(k.$62l===T&&k.points.length>0)return z(k,e),!0}}}return!1},addShapePoint:function(y,A,U){var b=this,X=b.gv,x=X.dm(),$=x.getHistoryManager();if($&&$.beginInteraction(),0===arguments.length&&(y=b._shape||b._edge,A=b._hoverSegmentIndex,U=b._lp),y instanceof E||y instanceof H){var B=On(y,X.getDataUI(y),A);if(!isNaN(A)&&U&&!isNaN(B)){var q=U;if(y instanceof E){var V=y.p(),z=y.getRotation(),P=y.toSegments();P||(P=Jm(y.getPoints())),y.isClosePath()&&P.indexOf(5)<0&&(P=new I(P._as),P.add(5));var S=P.get(A),h="addPoint",s="removePointAt";if(2===S||1===S){var j={x:q.x,y:q.y};P.add(S,A),j=rc(V,j.x-V.x,j.y-V.y,-z),y[h](j,B+1)}else if(3===S){var R=y.getPoints(),W=R.get(B),a=R.get(B+2),j={x:q.x,y:q.y};j=rc(V,j.x-V.x,j.y-V.y,-z);var m=po(W,j),l=po(j,a);P.removeAt(A),P.add(3,A),P.add(3,A),y.setPoint(B+1,j),y[h](l,B+2),y[h](m,B+1)}else if(4===S){var R=y.getPoints(),W=R.get(B),a=R.get(B+3),j={x:q.x,y:q.y};j=rc(V,j.x-V.x,j.y-V.y,-z);var m=Ap(W,j),l=tj(W,j),u=Ap(j,a),e=tj(j,a);P.removeAt(A),P.add(4,A),P.add(4,A),y[s](B+1),y[s](B+1),y[h](j,B+1),y[h](e,B+2),y[h](u,B+2),y[h](l,B+1),y[h](m,B+1)}else if(5===S){var j={x:q.x,y:q.y};P.add(2,A),j=rc(V,j.x-V.x,j.y-V.y,-z),y[h](j,B+1)}y.isClosePath()&&P.remove(5),y.setSegments(P);var n=y.getWidth(),G=y.getHeight(),F=y.p().x-n/2,J=y.p().y-G/2;F-=V.x,J-=V.y;var C=Jn(y,{x:F,y:J,width:n,height:G},z,V);y.p(C.x,C.y)}else if(y instanceof H){if("points"!==y.s("edge.type"))return $&&$.endInteraction(),void 0;var R=y.s("edge.points");P=y.s("edge.segments"),R=sn(X.getDataUI(y),R),P||(P=Jm(R)),P=new I(P._as.slice(0)),R=new I(R._as.slice(0));var S=P.get(A);if(2===S||1===S){var j={x:q.x,y:q.y};P.add(S,A),R.add(j,B+1)}else if(3===S){var W=R.get(B),a=R.get(B+2),j={x:q.x,y:q.y},m=po(W,j),l=po(j,a);P.removeAt(A),P.add(3,A),P.add(3,A),R.set(B+1,j),R.add(l,B+2),R.add(m,B+1)}else if(4===S){var W=R.get(B),a=R.get(B+3),j={x:q.x,y:q.y},m=Ap(W,j),l=tj(W,j),u=Ap(j,a),e=tj(j,a);P.removeAt(A),P.add(4,A),P.add(4,A),R.removeAt(B+1),R.removeAt(B+1),R.add(j,B+1),R.add(e,B+2),R.add(u,B+2),R.add(l,B+1),R.add(m,B+1)}y.s("edge.points",hm(R)),y.s("edge.segments",P)}}}$&&$.endInteraction()},removeShapePoint:function(C,u){var v=this,V="removeAt",Y=v.gv,o=Y.dm(),s=o.getHistoryManager();if(s&&s.beginInteraction(),0===arguments.length&&(C=v._shape||v._edge,u=v._removePointIndex),u>=0&&(C instanceof E||C instanceof H)){var k=tm(C,v.gv.getDataUI(C),u),c=u;if(C instanceof E){var U=C.p(),q=C.toSegments();q||(q=Jm(C.getPoints()));var r=q.get(k),J="removePointAt";if(1===r&&0===c)if(C.getPoints().size()>1){var D=q.get(k+1);q[V](k+1),3===D?C[J](c+1):4===D&&(C[J](c+2),C[J](c+1)),C[J](c)}else C.dm().remove(C);else 2===r||1===r?(q[V](k),C[J](c)):3===r?(q[V](k),C[J](c),C[J](c-1)):4===r&&(q[V](k),C[J](c),C[J](c-1),C[J](c-2));C.setSegments(q);var N=C.getWidth(),T=C.getHeight(),l=C.p().x-N/2,y=C.p().y-T/2;l-=U.x,y-=U.y;var P=Jn(C,{x:l,y:y,width:N,height:T},C.getRotation(),U);C.p(P.x,P.y)}else if(C instanceof H){if("points"!==C.s("edge.type"))return s&&s.endInteraction(),void 0;var A=C.s("edge.points");if(q=C.s("edge.segments"),A&&(A=sn(v.gv.getDataUI(C),A),q||(q=Jm(A))),0===u||u===A.size()-1)return s&&s.endInteraction(),void 0;q=new I(q._as.slice(0)),A=new I(A._as.slice(0));var r=q.get(k);2===r||1===r?(q[V](k),A[V](c)):3===r?(q[V](k),A[V](c),A[V](c-1)):4===r&&(q[V](k),A[V](c),A[V](c-1),A[V](c-2)),C.s("edge.segments",q),C.s("edge.points",hm(A))}}s&&s.endInteraction()},changeShapeSegment:function(s,i,e){var x=this,S=x.gv,F=S.dm(),Z=F.getHistoryManager();if(Z&&Z.beginInteraction(),1!==arguments.length||isNaN(s)||(e=s,s=x._shape||x._edge,i=x._hoverSegmentIndex),s instanceof E||s instanceof H){var m=On(s,x.gv.getDataUI(s),i);if(!isNaN(i)&&!isNaN(m))if(s instanceof E){var U=s.p(),A=s.toSegments();A||(A=Jm(s.getPoints()));var B=A.get(i),Y=s.toPoints();if(1===e||2===e)1===B||2===B?A.set(i,e):3===B?(A.set(i,e),Y.removeAt(m+1)):4===B&&(A.set(i,e),Y.removeAt(m+1),Y.removeAt(m+1));else if(3===e){var h=function(){var F=Y.get(m),R=Y.get(m+1),k=po(F,R);A.set(i,3),Y.add(k,m+1)};2===B||1===B?h():4===B&&(Y.removeAt(m+1),Y.removeAt(m+1),h())}else if(4===e){var r=function(){var k=Y.get(m),O=Y.get(m+1),h=Ap(k,O),w=tj(k,O);A.set(i,4),Y.add(h,m+1),Y.add(w,m+2)};2===B||1===B?r():3===B&&(Y.removeAt(m+1),r())}s.setSegments(A),s.setPoints(Y);var n=s.getWidth(),w=s.getHeight(),u=s.p().x-n/2,J=s.p().y-w/2;u-=U.x,J-=U.y;var p=new Jn(s,{x:u,y:J,width:n,height:w},s.getRotation(),U);s.p(p.x,p.y)}else if(s instanceof H){if("points"!==s.s("edge.type"))return Z&&Z.endInteraction(),void 0;var Y=s.s("edge.points");A=s.s("edge.segments"),Y&&(Y=sn(x.gv.getDataUI(s),Y),A||(A=Jm(Y))),A=new I(A._as.slice(0)),Y=new I(Y._as.slice(0));var B=A.get(i);if(1===e||2===e)1===B||2===B?A.set(i,e):3===B?(A.set(i,e),Y.removeAt(m+1)):4===B&&(A.set(i,e),Y.removeAt(m+1),Y.removeAt(m+1));else if(3===e){var h=function(){var O=Y.get(m),r=Y.get(m+1),o=po(O,r);A.set(i,3),Y.add(o,m+1)};2===B||1===B?h():4===B&&(Y.removeAt(m+1),Y.removeAt(m+1),h())}else if(4===e){var r=function(){var e=Y.get(m),Q=Y.get(m+1),j=Ap(e,Q),f=tj(e,Q);A.set(i,4),Y.add(j,m+1),Y.add(f,m+2)};2===B||1===B?r():3===B&&(Y.removeAt(m+1),r())}s.s("edge.points",hm(Y)),s.s("edge.segments",A)}}Z&&Z.endInteraction()},getDefaultSegments:function(y){var j=this.gv,l=j.getDataUI(y);if(y instanceof H){var B=y.s("edge.points");return B=sn(l,B),Jm(B)}if(y instanceof E){var B=y.getPoints(),a=y.getSegments();return a&&a.size()>0?a:Jm(B)}},$43l:function(o){var L=this;o&&(L.$5l=1),L._68I=1,L._42()},_42:function(){var j=this;if(j._68I){delete j._68I;var g=j.gv,e=j.$5l,y=g.getZoom(),J=g.getEditPointSize(),K=J/2,d=new I,l=j._view,T=j._edge,x=j._shape,m=l.getContext("2d"),t=g.tx(),L=g.ty(),G=s,f=g.getEditPointBackground(),$=g.getControlPointBackground(),R=g.getControlPointBorderColor(),C=g.getEditPointBorderColor(),i=g.getEditRectBorderColor(),v=g.getDirectionLineColor(),U=g.getSegmentHoverColor(),z=g.getSnapPointBorderColor(),c=g.getJoinPointBackground(),A=g.getJoinPointBorderColor(),w=g.getSegmentHoverWidth(),k=[5,5],_=g.getEditRectBorderStyle();Fh(g,function(R){g.isSelected(R)&&g.isVisible(R)&&d.add(R)}),m.clearRect(0,0,h(l.width),h(l.height)),m.save(),N.translateAndScale(m,t,L,1);var M=s,p={x:0,y:0,width:0,height:0},Z=0,r=0,Y=0,W=0,u=0,B=0,Td=0,pl=0,qc=0,$e=0,pd=[];if(e?(delete j.$6l,delete j.$8l,delete j.$7l,delete j.$16l,delete j.$23l):(M=j.$6l,G=j.$7l),delete j.$68l,delete j.$69l,delete j.$71l,delete j.$70l,delete j.$82l,delete j.$83l,delete j._pointElevationHelperPoint,delete j.$90l,delete j.$91l,delete j.$75l,delete j.$74l,d.each(function(H){var f=g.getDataUI(H);if(f){var T=f._55O;if(g.isEditable(H))T._56O&&H instanceof O&&r++,pd.push(H),T._42O&&H instanceof O&&Z++,g.isHelperEditable(H,"host")&&W++,g.isHelperEditable(H,"parent")&&Y++,g.isHelperEditable(H,"remove")&&u++,g.isHelperEditable(H,"edge")&&B++,g.isHelperEditable(H,"source")&&Td++,g.isHelperEditable(H,"target")&&pl++,g.isHelperEditable(H,"elevation")&&qc++,g.isHelperEditable(H,"tall")&&$e++;else if(H instanceof D&&H.isExpanded()){var p=!0,G=g.getEditableFunc();G&&(p=G(H)),p&&(g.isHelperEditable(H,"host")&&W++,g.isHelperEditable(H,"parent")&&Y++,g.isHelperEditable(H,"remove")&&u++,g.isHelperEditable(H,"edge")&&B++,g.isHelperEditable(H,"source")&&Td++,g.isHelperEditable(H,"target")&&pl++,g.isHelperEditable(H,"elevation")&&qc++,g.isHelperEditable(H,"tall")&&$e++,pd.push(H))}}}),m.beginPath(),m.lineWidth=1,m.strokeStyle=g.getNodeBorderColor(),pd.forEach(function(Y){var w=g.getDataUI(Y),L=w._55O;if(e)if(G==s&&(G=Y instanceof H?0:Y instanceof D&&Y.isExpanded()?0:Y.getRotation(),j.$7l=G),M==s){var N,l,d;if(Y instanceof D&&Y.isExpanded()||Y instanceof H){var V=g.getDataUIBounds(Y);l=V.width,d=V.height,N={x:V.x+l/2,y:V.y+d/2}}else N=Y.p(),l=Y.getWidth(),d=Y.getHeight();M={x:N.x,y:N.y,width:0,height:0},p.x=N.x-l/2,p.y=N.y-d/2,p.width=l,p.height=d,M=F(M,p)}else{var N,l,d,c,v=M.x+M.width/2,R=M.y+M.height/2,S={x:v,y:R};if(Y instanceof D&&Y.isExpanded()||Y instanceof H){c=0;var V=g.getDataUIBounds(Y);l=V.width,d=V.height,N={x:V.x+l/2,y:V.y+d/2}}else N=Y.p(),l=Y.getWidth(),d=Y.getHeight(),c=Y.getRotation();var X={x:N.x-l/2,y:N.y-d/2,width:l,height:d},r={x:X.x,y:X.y},u={x:X.x+X.width,y:X.y},b={x:X.x,y:X.y+X.height},_={x:X.x+X.width,y:X.y+X.height},r=rc(N,r.x-N.x,r.y-N.y,c),b=rc(N,b.x-N.x,b.y-N.y,c),_=rc(N,_.x-N.x,_.y-N.y,c),u=rc(N,u.x-N.x,u.y-N.y,c),B=-G,q=rc(S,r.x-S.x,r.y-S.y,B),z=rc(S,u.x-S.x,u.y-S.y,B),f=rc(S,b.x-S.x,b.y-S.y,B),I=rc(S,_.x-S.x,_.y-S.y,B),A=P([q,z,f,I]);M=F(M,A),M.x-=v,M.y-=R;var h=Jn(s,M,G,S);M.x=h.x-M.width/2,M.y=h.y-M.height/2}if(Z>1&&g.isEditable(Y)&&g.isRectEditable(Y)&&Y instanceof O){var W=Y.getRect(),o=L.$45l,U=uj(o[0],y),i=uj(o[2],y),k=uj(o[4],y),n=uj(o[6],y);Y.getRotation()?(m.moveTo(U.x,U.y),m.lineTo(i.x,i.y),m.lineTo(k.x,k.y),m.lineTo(n.x,n.y),m.lineTo(U.x,U.y)):m.rect(W.x*y,W.y*y,W.width*y,W.height*y)}}),m.stroke(),d.each(function(i){var C=g.getDataUI(i);if(C){var f,_,V=C._55O,G=C._78o;if(V&&V._43O&&i instanceof E?(f=V.$15l,_=i.getSegments(),_||(_=Jm(f)),i.isClosePath()&&_.indexOf(5)<0&&(_=new I(_._as),_.add(5))):V&&G&&V._43O&&(f=i.s("edge.points"),_=i.s("edge.segments"),f=sn(C,f),_||(_=Jm(f)),f&&(f=f._as)),f&&_){var u=0,W=_.size(),e=j._hoverSegmentIndex;f=f.slice(0);for(var b=0;b<f.length;b++)f[b]=uj(f[b],y);m.beginPath(),m.strokeStyle=v,m.lineWidth=1,u=0;for(var b=0;W>b;b++){var B=_.get(b);if(1===B||2===B)u++;else if(3===B){var a=f[u-1],t=f[u],Y=f[u+1];m.moveTo(a.x,a.y),m.lineTo(t.x,t.y),m.lineTo(Y.x,Y.y),u+=2}else if(4===B){var a=f[u-1],d=f[u],N=f[u+1],Y=f[u+2];m.moveTo(a.x,a.y),m.lineTo(d.x,d.y),m.moveTo(N.x,N.y),m.lineTo(Y.x,Y.y),u+=3}}if(m.stroke(),x===i||T===i&&"points"===T.s("edge.type")){m.beginPath(),u=0,m.strokeStyle=U,m.lineWidth=w;for(var b=0;W>b;b++){var B=_.get(b);if(1===B||2===B){if(e===b){var a=f[u-1],Y=f[u];m.moveTo(a.x,a.y),m.lineTo(Y.x,Y.y);break}u++}else if(3===B){if(e===b){var a=f[u-1],t=f[u],Y=f[u+1];m.moveTo(a.x,a.y),m.quadraticCurveTo(t.x,t.y,Y.x,Y.y);break}u+=2}else if(4===B){if(e===b){var a=f[u-1],d=f[u],N=f[u+1],Y=f[u+2];m.moveTo(a.x,a.y),m.bezierCurveTo(d.x,d.y,N.x,N.y,Y.x,Y.y);break}u+=3}else if(5===B&&e===b){var a=f[u-1],Y=f[0];m.moveTo(a.x,a.y),m.lineTo(Y.x,Y.y);break}}m.stroke()}m.beginPath(),u=0,m.strokeStyle=A,m.lineWidth=1,m.fillStyle=c;for(var b=0;W>b;b++){var B=_.get(b);if(1===B||2===B){var Y=f[u];m.moveTo(Y.x+K,Y.y),m.arc(Y.x,Y.y,K,0,n,!0),u++}else if(3===B){var Y=f[u+1];m.moveTo(Y.x+K,Y.y),m.arc(Y.x,Y.y,K,0,n,!0),u+=2}else if(4===B){var Y=f[u+2];m.moveTo(Y.x+K,Y.y),m.arc(Y.x,Y.y,K,0,n,!0),u+=3}}m.fill(),m.stroke(),m.beginPath(),u=0,m.strokeStyle=R,m.lineWidth=1,m.fillStyle=$;for(var b=0;W>b;b++){var B=_.get(b);if(1===B||2===B)u++;else if(3===B){var t=f[u];m.moveTo(t.x+K,t.y),m.arc(t.x,t.y,K,0,n,!0),u+=2}else if(4===B){var d=f[u],N=f[u+1];m.moveTo(d.x+K,d.y),m.arc(d.x,d.y,K,0,n,!0),m.moveTo(N.x+K,N.y),m.arc(N.x,N.y,K,0,n,!0),u+=3}}if(m.fill(),m.stroke(),m.beginPath(),u=0,m.strokeStyle=z,m.lineWidth=2,(x===i||T===i)&&j.$9l!=s){var Y=f[j.$9l];m.moveTo(Y.x+K,Y.y),m.arc(Y.x,Y.y,K,0,n,!0),m.stroke()}}}}),M){j.$6l=X(M),q(M,g.getEditRectPadding()/y);var fd={x:M.x+M.width/2,y:M.y+M.height/2},rm=yi(fd,M.width,M.height,G),ho=rm[0],yc=rm[1],ug=rm[2],fi=rm[3],yo=rm[4],Nc=rm[5],lo=rm[6],of=rm[7];if(ho=uj(rm[0],y),yc=uj(rm[1],y),ug=uj(rm[2],y),fi=uj(rm[3],y),yo=uj(rm[4],y),Nc=uj(rm[5],y),lo=uj(rm[6],y),of=uj(rm[7],y),j.$8l=M,Z>0&&(j.$16l=[ho,yo,yc,Nc,fi,lo,ug,of],m.beginPath(),m.lineWidth=1,m.strokeStyle=i,"dashed"===_&&m.setLineDash&&m.setLineDash(k),m.moveTo(ho.x,ho.y),m.lineTo(yc.x,yc.y),m.lineTo(fi.x,fi.y),m.lineTo(ug.x,ug.y),m.lineTo(ho.x,ho.y),m.stroke(),"dashed"===_&&m.setLineDash&&m.setLineDash([])),m.beginPath(),m.lineWidth=1,m.fillStyle=f,m.strokeStyle=C,Z>0){var Vm=Nc.x-of.x,Tj=Nc.y-of.y,bm=o(Vm*Vm+Tj*Tj),wk=yo.x-lo.x,Jg=yo.y-lo.y,Jh=o(wk*wk+Jg*Jg),bq=2*J;if(g.isDirectionEditable&&1===pd.length){var Kc=pd[0],dg=g.getDataUI(Kc),zb=dg._55O,dc=g.isDirectionEditable.bind(g);if(zb._42O){var Of,qs,Bl,Tm;dc(Kc,"northwest")&&(Of=!0,m.rect(ho.x-K,ho.y-K,J,J)),dc(Kc,"northeast")&&(qs=!0,m.rect(yc.x-K,yc.y-K,J,J)),dc(Kc,"southwest")&&(Bl=!0,m.rect(ug.x-K,ug.y-K,J,J)),dc(Kc,"southeast")&&(Tm=!0,m.rect(fi.x-K,fi.y-K,J,J)),dc(Kc,"north")&&(Of&&qs?bm>bq&&m.rect(yo.x-K,yo.y-K,J,J):m.rect(yo.x-K,yo.y-K,J,J)),dc(Kc,"south")&&(Tm&&Bl?bm>bq&&m.rect(lo.x-K,lo.y-K,J,J):m.rect(lo.x-K,lo.y-K,J,J)),dc(Kc,"west")&&(Bl&&Of?Jh>bq&&m.rect(of.x-K,of.y-K,J,J):m.rect(of.x-K,of.y-K,J,J)),dc(Kc,"east")&&(Tm&&qs?Jh>bq&&m.rect(Nc.x-K,Nc.y-K,J,J):m.rect(Nc.x-K,Nc.y-K,J,J))}}else bm>bq&&(m.rect(yo.x-K,yo.y-K,J,J),m.rect(lo.x-K,lo.y-K,J,J)),Jh>bq&&(m.rect(Nc.x-K,Nc.y-K,J,J),m.rect(of.x-K,of.y-K,J,J)),m.rect(ho.x-K,ho.y-K,J,J),m.rect(yc.x-K,yc.y-K,J,J),m.rect(ug.x-K,ug.y-K,J,J),m.rect(fi.x-K,fi.y-K,J,J)}if(r>0){var Sf=j.$23l=rc(yo,0,2*-J,G);m.moveTo(Sf.x+K,Sf.y),m.arc(Sf.x,Sf.y,K,0,n,!1)}m.fill(),m.stroke(),j.$40l&&j.$44l(m,M,G);var tf,Ki,Ge=g.getLeftTopHelpers(),Dc=g.getRightTopHelpers(),nn=g.getLeftBottomHelpers(),Kg=g.getRightBottomHelpers(),Fq=g.getEdgeHelpers(),vs=g.getEditHelperSize(),Zq=vs/2,he=function(Z,i,U,N){"leftTop"===i?(tf=M.x*y-vs-K-("h"===N?U*(vs+K):0)-1,Ki=M.y*y-vs-K-("v"===N?U*(vs+K):0)-1):"rightTop"===i?(tf=(M.x+M.width)*y+K+("h"===N?U*(vs+K):0)+1,Ki=M.y*y-vs-K-("v"===N?U*(vs+K):0)-1):"leftBottom"===i?(tf=M.x*y-vs-K-("h"===N?U*(vs+K):0)-1,Ki=(M.y+M.height)*y+K+("v"===N?U*(vs+K):0)+1):"rightBottom"===i&&(tf=(M.x+M.width)*y+K+("h"===N?U*(vs+K):0)+1,Ki=(M.y+M.height)*y+K+("v"===N?U*(vs+K):0)+1);var A=tf+Zq,z=Ki+Zq,s=(M.x+M.width/2)*y,J=(M.y+M.height/2)*y,O=rc({x:s,y:J},A-s,z-J,G);if("host"===Z){if(W>0)return j.$77l(m,G,O),!0}else if("edge"===Z){if(B>0)return j.$80l(m,G,O),!0}else if("remove"===Z){if(u>0)return pd&&1===pd.length&&pd[0]instanceof H?j.$81l(m,G,{x:s+vs/2+5,y:J}):j.$81l(m,G,O),!0}else if("parent"===Z){if(Y>0)return pd&&1===pd.length&&pd[0]instanceof H?j.$76l(m,G,{x:s-vs/2-5,y:J}):j.$76l(m,G,O),!0}else if("elevation"===Z){if(qc>0)return j.$85l(m,G,O),!0}else if("tall"===Z){if($e>0)return j.$86l(m,G,O),!0}else if("source"===Z||"target"===Z){var P=pd[0],C=g.getDataUI(P),v=ts(C,!0),h=v[0],q=v[1];if(Td&&"source"===Z)return j.$84l(m,M,h,!0,P.isLooped(),i,U,N),!0;if(pl&&"target"===Z)return j.$84l(m,M,q,!1,P.isLooped(),i,U,N),!0}};if(Ge&&Ge.length>0){var hf=0;Ge.forEach(function(i){he(i,"leftTop",hf,g.getLeftTopHelpersAlign()||"h")&&hf++})}if(Dc&&Dc.length>0){var hf=0;Dc.forEach(function(B){he(B,"rightTop",hf,g.getRightTopHelpersAlign()||"h")&&hf++})}if(nn&&nn.length>0){var hf=0;nn.forEach(function(G){he(G,"leftBottom",hf,g.getLeftBottomHelpersAlign()||"h")&&hf++})}if(Kg&&Kg.length>0){var hf=0;Kg.forEach(function(W){he(W,"rightBottom",hf,g.getRightBottomHelpersAlign()||"h")&&hf++})}if(Fq&&Fq.length>0&&((Td||pl)&&pd&&1===pd.length&&pd[0]instanceof H?!0:!1)){var hf=0;Fq.forEach(function(q){he(q,"edge",hf,"h")&&hf++})}if(j.$72l){var Pi,kd=j.$67l,aj=j.$68l,lr=j.$69l,rl=(j.$71l,j.$70l),jk=j.$82l,Tb=j.$83l;if(1===kd?Pi=aj:2===kd?Pi=lr:3===kd?Pi=rl:5===kd?Pi=jk:6===kd&&(Pi=Tb),Pi){var ti=g.lp(j.$72l),$p=g.getDataAt(j.$72l);if($p&&$p instanceof O){var fr,ii,bd;if(j.$73l=$p,1===kd)if($p instanceof S.Grid)fr=j.$75l=Ag($p,ti);else if($p instanceof S.Shape){bd=j.$74l=Pq($p,ti);var Cl=$p.getPoints();if(bd){var qj=bd.attachIndex,Ll=On($p,g.getDataUI($p),qj)+1,Fm=Ll+1>=Cl.size()?0:Ll+1,If=Cl.get(Ll),Fb=Cl.get(Fm),Fp=$p.p(),Oi=$p.getRotation();If=rc(Fp,If.x-Fp.x,If.y-Fp.y,Oi),Fb=rc(Fp,Fb.x-Fp.x,Fb.y-Fp.y,Oi),m.beginPath(),m.strokeStyle=U,m.lineWidth=w,m.moveTo(If.x*y,If.y*y),m.lineTo(Fb.x*y,Fb.y*y),m.stroke()}}fr?ii=fr.rect:(ii=a.clone(g.getDataUIBounds($p)),a.grow(ii,2)),m.beginPath(),m.rect(ii.x*y,ii.y*y,ii.width*y,ii.height*y),m.strokeStyle=1===kd||4===kd||6===kd?b:V,m.lineWidth=2,m.setLineDash&&m.setLineDash([8,8]),m.stroke()}else delete j.$73l;ti.x=ti.x*y,ti.y=ti.y*y;var Mp=en(Pi.x,Pi.y,ti.x,ti.y),ml=rc(Pi,ti.x-Pi.x,ti.y-Pi.y,-Mp),br=ml.x-Pi.x;m.translate(Pi.x,Pi.y),m.rotate(Mp),Q.width=br,Q.height=40;var Cr=V;(1===kd||4===kd||6===kd)&&(Cr=b),Q.comps[0].gradientColor=Cr,a.drawImage(m,Q,0,-20,br,40)}}}if(j.$87l&&g.sm().contains(j.$87l)){var Pd,kf=j.$87l,zr=j.$88l,vs=g.getEditHelperSize(),Zq=vs/2;if(g.isHelperEditable(kf,"pointElevation"))if(kf instanceof E){var Um=kf.getPosition();Pd=a.clone(kf.getPoints().get(zr)),Pd=rc({x:Um.x,y:Um.y},Pd.x-Um.x,Pd.y-Um.y,kf.getRotation()),Pd.x*=y,Pd.y*=y,m.translate(Pd.x,Pd.y),a.drawImage(m,ls,Zq,-Zq,vs,vs),m.translate(-Pd.x,-Pd.y),j._pointElevationHelperPoint={x:Pd.x+vs,y:Pd.y}}else if(kf instanceof H){var Hi=sn(g.getDataUI(kf),kf.s("edge.points")),Pd=a.clone(Hi.get(zr));Pd.x*=y,Pd.y*=y,m.translate(Pd.x,Pd.y),a.drawImage(m,ls,Zq,-Zq,vs,vs),m.translate(-Pd.x,-Pd.y),j._pointElevationHelperPoint={x:Pd.x+vs,y:Pd.y}}}m.restore(),j.$5l=0}},$89l:function(q,A,v,b){q.save();var _=this,h=_.gv,C=h.getEditHelperSize(),K=C/2;q.beginPath(),q.translate(v.x,v.y),q.rotate(A),a.drawImage(q,b,-K,-K,C,C),q.restore()},$85l:function($,z,u){var d=this;d.$90l=u,d.$89l($,z,u,ls)},$86l:function(m,T,U){var F=this;F.$91l=U,F.$89l(m,T,U,Qd)},$77l:function(S,O,y){var f=this;f.$68l=y,f.$89l(S,O,y,v)},$80l:function(S,i,j){var k=this;k.$70l=j,k.$89l(S,i,j,$)},$81l:function(Y,S,G){var d=this;d.$71l=G,d.$89l(Y,S,G,jj)},$76l:function(j,t,l){var w=this;w.$69l=l,w.$89l(j,t,l,m)},$84l:function(f,q,$,w,K){var l,C=this,O=C.gv,i=O.getZoom(),t=O.getEditHelperSize(),B=t/2;$.x*=i,$.y*=i,K&&(w?$.x-=B+5:$.x+=B+5),$.y-=t-2,w?(C.$82l=$,l=Nm):(C.$83l=$,l=Vd),f.beginPath(),f.translate($.x,$.y),a.drawImage(f,l,-B,-B,t,t),f.translate(-$.x,-$.y)},$44l:function(w,z,h){w.save();var f=this.gv.getZoom(),b=o(Y(z.width,2)+Y(z.height,2))/2*f+10,U=b,t=U+8,F=U+18,J=h,P=z.x+z.width/2,R=z.y+z.height/2;w.translate(P*f,R*f),w.beginPath(),w.strokeStyle="rgb(150, 150, 150)";for(var Z=0,S=0,n=0,k=0,D=0,I=0;360>I;I++)Z=I*B/180,0===I%5&&(S=c(Z)*U,n=u(Z)*U,k=c(Z)*t,D=u(Z)*t,w.moveTo(S,n),w.lineTo(k,D)),0===I%45&&(S=c(Z)*U,n=u(Z)*U,k=c(Z)*F,D=u(Z)*F,w.moveTo(S,n),w.lineTo(k,D));w.stroke(),w.beginPath(),w.rotate(-i),w.beginPath(),w.fillStyle="rgba(255, 0, 0, 0.1)",w.strokeStyle="rgb(157, 157, 157)",w.moveTo(0,0),w.arc(0,0,F,0,h,!1),w.fill(),w.beginPath(),w.moveTo(0+F,0),w.arc(0,0,F,0,h,!1),w.stroke(),w.rotate(i),w.font="bold 12px Verdana, Arial";var l=20*u(J),j=20*c(J),K=e(180*J/B)+"°";w.textAlign="center",w.textBaseline="middle",w.beginPath();var W=w.measureText("365.°").width;w.fillStyle="white",w.rect(l-W/2,-j-10,W,20),w.fill(),w.beginPath(),w.fillStyle="rgb(79,79,79)",w.fillText(K,l,-j),w.restore()}})}(this,Object);