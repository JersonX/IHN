!function(g,U,h){"use strict";var c="px",I="0",P="innerHTML",k="className",N=ht.Default,D=ht.Color,L=ht.Node,Y="position",O="top",S="left",V=N.animate,$=N.getInternal(),y="width",I="0",u="none",H="max-height",W="font",e="background",r="border-box",B="user-select",_="box-sizing",Z="overflow",w=N.isTouchable,$=N.getInternal(),A=D.titleIconBackground,x=N.scrollBarInteractiveSize,G=/msie 9/.test(g.navigator?g.navigator.userAgent.toLowerCase():""),R=null,F=function(){return document},b=function(o){return F().createElement(o)},J=function(){return b("div")},T=function(){var r=J(),m=r.style;return m.msTouchAction=u,m.cursor="default",w&&m.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",R),m.position="absolute",m.left=I,m.top=I,r},t=function(){return b("canvas")},M=function(){return document.body},l=function(w,o,Z){w.style.setProperty(o,Z,R)},o=function(G,D){G.style.removeProperty(D)},q=function(i,K,l){N.def(ht.widget[i],K,l)},i=function(N,t){N.appendChild(t)},d=function(c,z){c.removeChild(z)},p=function(M,s,o,_){M.addEventListener(s,o,!!_)};$.addMethod(N,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:A,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:A}]},paletteTitleLabelColor:N.labelSelectColor,paletteTitleLabelFont:N.labelFont,paletteContentLabelFont:N.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:N.widgetTitleHeight,paletteTitleBackground:D.titleBackground,paletteTitleHoverBackground:D.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:h,paletteItemHoverBorderColor:D.highlight,paletteItemSelectBackground:D.highlight},!0);var E=".palette-item:hover{border: 1px solid "+N.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+N.paletteTitleHoverBackground+" !important}",X=document.createElement("style");w||(X.styleSheet?X.styleSheet.cssText=E:X.appendChild(F().createTextNode(E))),F().getElementsByTagName("head")[0].appendChild(X);var K=function(Z){var K=this;K.$22h=Z,K.addListeners()};N.def(K,U,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var e=this;e.$36h&&M().removeChild(e.$36h),e.$23h=e.$24h=e.$25h=e.$35h=e.$36h=R},handle_touchstart:function(A){for(var h,y=this,c=y.$22h,E=A.target,T=c.sm(),K=c.dm(),D="palette-header",t="palette-header-tool",v="palette-item",H=!1,C=!1,r=!1;E&&(E[k]||"").indexOf(D)<0&&(E[k]||"").indexOf(v)<0;)E=E.parentNode;if(E&&E[k].indexOf(t)>=0?H=!0:E&&E[k].indexOf(D)>=0?r=!0:E&&E[k].indexOf(v)>=0&&(C=!0),N.isLeftButton(A))if(y.$27h(A))y.$24h=N.getClientPoint(A),y.$25h=c.ty();else if(H){N.preventDefault(A),h=E.parentNode.$11h;var O=K.getDataById(h),u=O.s("tools")[E.toolIndex];u.action&&u.action.call(c)}else if(r){N.preventDefault(A),h=E.$11h;var O=K.getDataById(h);O.isExpanded()?O.setExpanded(!1):O.setExpanded(!0)}else if(C){h=E.$11h;var X=K.getDataById(h);T.ss(X),c.handleDragAndDrop&&(N.preventDefault(A),X.s("draggable")&&(c.handleDragAndDrop(A,"prepare"),y.$35h=0)),X.s("draggable")||(N.preventDefault(A),y.$24h=N.getClientPoint(A),y.$25h=c.ty())}else N.preventDefault(A),y.$24h=N.getClientPoint(A),y.$25h=c.ty();else y.$26h(A)},handle_mousedown:function(E){this.handle_touchstart(E)},handle_mousewheel:function(Z){this.handleScroll(Z,Z.wheelDelta/40,Z.wheelDelta!==Z.wheelDeltaX)},handle_DOMMouseScroll:function(H){this.handleScroll(H,-H.detail,1)},handleScroll:function(E,y,k){var D=this.$22h;N.preventDefault(E),k&&D._41o()&&D.ty(D.ty()+20*y)},handle_mouseup:function(A){this.handle_touchend(A)},handle_touchend:function(A){var K=this;K.$37h(A),K.$26h(A)},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(i){var I=this;I.$37h(i),I.$26h(i)},$37h:function(h){var S=this,L=S.$22h;2===S.$35h&&(S.$35h=3,L.handleDragAndDrop(h,"end"))},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(x){var W=this,s=W.$22h,o=W.$23h,I=W.$24h,r=W.$25h,t=N.getClientPoint(x),V=s._29I,n=W.$36h;if(1===W.$35h||2===W.$35h){if(W.$35h=2,s.handleDragAndDrop(x,"between"),w){var B=x.touches[0];x=B?B:x.changedTouches[0]}n.style.left=x.pageX-parseInt(n.width)/2+c,n.style.top=x.pageY-parseInt(n.height)/2+c}else"p"===o?s.ty(r+t.y-I.y):"v"===o&&s.ty(r+(I.y-t.y)/V.height*s._59I)},handle_mousemove:function(m){this.handle_touchmove(m)},handle_touchmove:function(A){if(!N.isDragging()&&N.isLeftButton(A)){var e=this,y=e.$22h,q=e.$27h(A);if(e.$24h){if(!e.$23h){if(N.getDistance(N.getClientPoint(A),e.$24h)<2)return;e.$23h=q?"v":"p",N.startDragging(e)}}else if(q)y._43o();else if(0===e.$35h){if(e.$35h=1,y.handleDragAndDrop(A,"begin"),w){var r=A.touches[0];A=r?r:A.changedTouches[0]}var m=e.$36h=new Image,K=y.$10h[y.sm().ld().getId()].querySelector(".image-box"),V=parseInt(K.style.width),D=parseInt(K.style.height);m.draggable=!1,m.src=K.toDataURL(),m.width=V,m.height=D,m.style.position="absolute",m.style.left=A.pageX-V/2+c,m.style.top=A.pageY-D/2+c,M().appendChild(m),N.startDragging(e)}}},$27h:function(Q){var M=this.$22h,E=M.getView(),o=E.getBoundingClientRect(),I=M._29I,h=Q.clientX-o.left+E.scrollLeft;return M._41o()&&I.x+I.width-h<x}}),ht.widget.Palette=function(j){var Q=this,R=Q._view=J();Q.$9h={},Q.$10h={},Q.$4h={},Q._29I={x:0,y:0,width:0,height:0},Q._59I=0,Q.dm(j?j:new ht.DataModel),R[k]="ht-widget-palette",Q.$29h=new K(Q),l(R,e,N.paletteContentBackground),l(R,Z,"auto"),l(R,_,r),l(R,"-moz-"+_,r),l(R,"-webkit-"+B,u),l(R,"-moz-"+B,u),l(R,"-ms-"+B,u),l(R,B,u),l(R,"position","absolute"),l(R,"overflow","hidden"),i(R,Q._79O=T()),p(R,"dragstart",function(n){n.dataTransfer&&(n.dataTransfer.setData("Text","nodeid:"+n.target.$11h),n.dataTransfer.effectAllowed="all",Q.$29h.$26h())})},q("Palette",U,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:N.autoHideScrollBar,_scrollBarSize:N.scrollBarSize,_scrollBarColor:N.scrollBarColor,getViewRect:function(){return this._29I},ty:function(r){return r?(this.setTranslateY(r),void 0):this.getTranslateY()},setTranslateY:function(A){if(this.$32h==R){var z=this,J=z.$33h(A),r=z.$30h;z.$30h=J,z.fp("translateY",r,J)}},getTranslateY:function(){return this.$30h},setLayout:function(D){var _,i,u=this,O=u._layout;u._layout=D,"smallicons"===D?_=i=20:"iconsonly"===D?_=i=50:(_=70,i=50),u.setItemImageWidth(_),u.setItemImageHeight(i),u.setItemImagePadding(4),u.fp("layout",O,D)},getDataAt:function(_){for(var N=_.target;N&&N.$11h==R;)N=N.parentNode;return N&&N.$11h!=R?this.getDataModel().getDataById(N.$11h):void 0},$20h:function(){var Q=16;return w&&(Q*=1.2),Q},$19h:function(){return N.paletteTitleHeight},$18h:function(){var h=N.paletteSeparatorWidth,K=N.paletteTitleBackground,X=N.paletteSeparatorColor||N.brighter(K);return h+c+" solid "+X},$17h:function(W){l(W,"cursor","pointer"),l(W,"display","inline-block"),l(W,"margin-right",(w?8:4)+c),l(W,"vertical-align",O)},$1h:function(p){var h=this,v=J(),A=J(),g=b("span");v[k]="palette-header",l(v,Y,"relative"),l(v,e,N.paletteTitleBackground),l(v,"color",N.paletteTitleLabelColor),l(v,O,I),l(v,_,r),l(v,"-moz-"+_,r),l(v,"padding","0 5px 0 0"),l(v,"border-top",h.$18h()),l(v,y,"100%"),l(v,"cursor","pointer"),l(v,"white-space","nowrap"),l(v,Z,"hidden"),l(v,W,N.paletteTitleLabelFont),l(v,"line-height",h.$19h()+c),v.$11h=p.getId();var f=t(),X=h.$19h(),a=h.$20h();h.$17h(f),$.setCanvas(f,a,X),i(v,f);var Q=p.s("tools");if(Q)for(var E=0;E<Q.length;E++){var V=t();h.$17h(V),$.setCanvas(V,a,X),V[k]="palette-header-tool palette-header-tool"+p.getId()+"-"+E,V.style.position="absolute",V.style.right=(a+10)*E+"px",V.toolIndex=E,i(v,V)}return f[k]="palette-toggle-icon-"+p.getId(),A[k]="palette-content",l(A,"max-height",0+c),l(A,W,N.paletteContentLabelFont),l(A,Z,"hidden"),A.$11h=p.getId(),h.$9h[p.getId()]=A,g[P]=p.getName(),l(g,W,N.paletteTitleLabelFont),i(v,f),i(v,g),[v,A]},$2h:function(Y){var H=this,F=H._layout,q=G&&Y.s("draggable")?b("a"):J(),j=t(),z=J(),o=Y.getName()||"",w=Y.s("title")||Y.getToolTip()||o,A=H._itemMargin;j[k]="image-box";var x=H.getItemImageWidth(),d=H.getItemImageHeight();return $.setCanvas(j,x,d),i(q,j),z[P]=o,z[k]="label-box","iconsonly"!==F&&i(q,z),q[k]="palette-item",l(q,"vertical-align",O),l(q,"cursor","pointer"),l(q,"border-radius",5+c),l(q,"border","1px solid transparent"),l(q,"text-align","center"),l(q,"display","inline-block"),l(q,"margin-left",A+c),l(q,"margin-top",A+c),l(q,"color",N.paletteContentLabelColor),"smallicons"===F?(l(j,"vertical-align","middle"),l(q,"margin-left",2+c),l(q,"margin-top",2+c),l(q,"padding",2+c),l(q,"text-align",S),l(z,"display","inline-block"),l(z,"min-width",H.$21h+H._itemMargin+c)):"largeicons"===F&&(l(z,"max-width",x+c),l(z,"overflow","hidden")),q.$11h=Y.getId(),w&&(q.title=w),Y.s("draggable")&&!H.handleDragAndDrop&&(G?(q.href="#",l(q,"text-decoration",u)):q.draggable="true"),q},$16h:function(T,t,j,E){var s=$.initContext(T);$.translateAndScale(s,0,0,1),s.clearRect(0,0,j,j);var R=(j-E)/2;N.drawStretchImage(s,N.getImage(t),"fill",0,R,E,E),s.restore()},$15h:function(m){var r=this,_=m.getId(),H=r._view.querySelector(".palette-toggle-icon-"+_),K=m.isExpanded()?N.paletteCollapseIcon:N.paletteExpandIcon;if(H&&K){var P=r.$19h(),n=r.$20h();r.$16h(H,K,P,n)}},_drawToolsIcon:function(k){var Y=this,z=k.s("tools");if(z)for(var o=0;o<z.length;o++){var c=Y._view.querySelector(".palette-header-tool"+k.getId()+"-"+o),K=z[o].icon,l=Y.$19h(),Z=Y.$20h();Y.$16h(c,K,l,Z)}},$14h:function(s){var p=this,a=s.getId(),E=p.$10h[a].querySelector(".image-box"),P=s.getImage(),m=s.s("image.stretch");if(E&&P){var e=$.initContext(E),T=p.getItemImagePadding();T="smallicons"===p._layout?T/2:T;var t=p.getItemImageWidth()-2*T,h=p.getItemImageHeight()-2*T;$.translateAndScale(e,0,0,1),e.clearRect(0,0,t,h),N.drawStretchImage(e,N.getImage(P),m,T,T,t,h),e.restore()}},validateImpl:function(){var f,u,A,h=this,m=h.$9h,y=h._layout,Q=h.$10h,x=h.$4h,q=h._view,D=h.dm();if(h.$13h&&(delete h.$13h,x={},D.each(function(H){x[H.getId()]=H})),"smallicons"===y)for(var l in x){var $=x[l];if($ instanceof L){var B=$.getName()||"",t=N.getTextSize(N.paletteContentLabelFont,B).width;h.$21h!=R&&h.$21h>t||(h.$21h=t)}}for(var l in x){A=x[l];var W,Z;if(D.contains(A)){if(A instanceof ht.Group){var G,S=h.$1h(A),J=Q[A.getId()];J&&(G=J.nextSibling,d(q,G),d(q,J)),u=D.getSiblings(A).indexOf(A);var X=q.children[2*u]||h._79O;q.insertBefore(S[0],X),q.insertBefore(G||S[1],X),Q[A.getId()]=S[0],f=m[A.getId()]=G||S[1],Z=A.$12h;var K=A.s("promptText");Z||(A.$12h=b("div"),A.$12h[P]=K||"",Z=A.$12h),0===A.getChildren().size()?f.contains(Z)||i(f,Z):f.contains(Z)&&d(f,Z)}else if(W=A.getParent()){var O=h.$2h(A),o=Q[A.getId()];f=m[W.getId()],o&&d(o.parentNode,o),u=D.getSiblings(A).indexOf(A);var k=f.children[u];k?f.insertBefore(O,k):i(f,O),Q[A.getId()]=O,h.$14h(A)}}else{var U=Q[A.getId()],v=U.parentNode;if(A instanceof ht.Group){var p=U.nextSibling;d(q,U),d(q,p),delete m[A.getId()]}else d(v,U),0===v.children.length&&(W=D.getDataById(v.$11h),Z=W.$12h,Z&&!v.contains(Z)&&i(v,Z));delete Q[A.getId()]}}h.$4h={};var T=function(){var m=h._59I,L=0;h.$32h!=R&&(clearInterval(h.$32h),L=0,delete h.$32h),h.$32h=setInterval(function(){h.$31h(),m===h._59I?(L++,L>=2&&(clearInterval(h.$32h),delete h.$32h)):(L=0,m=h._59I)},30)};for(var z in m)if(f=m[z],A=D.getDataById(m[z].$11h),h.$15h(A),h._drawToolsIcon(A),A.isExpanded()){if(f.style.maxHeight===0+c){var F=f.scrollHeight+h._itemMargin+c;V(f).duration(200).set(H,F).set("padding-bottom",h._itemMargin+c).end(function(){return function(){T()}}(F))}else f.style.maxHeight=f.scrollHeight+c;f.style.paddingBottom=h._itemMargin+c}else f.style.maxHeight!==0+c&&V(f).duration(200).set(H,I).set("padding-bottom",I).end(function(){return function(){T()}}(f));h.$28h(),h.$31h()},$31h:function(){for(var P=this,Q=P._view,r=0,C=Q.children,$=0;$<C.length;$++){var t=C[$];t.className&&t.className.indexOf("palette-")>=0&&(r+=t.offsetHeight)}P._59I=r,P.$30h=P.$33h(P.ty());var a=P.ty();Q.scrollTop=-a,P._29I={x:0,y:-a,width:Q.clientWidth,height:Q.clientHeight},l(P._79O,O,-a+c),P._93I()},$33h:function(Z){var C=this,d=C._29I.height-C._59I;return d>Z&&(Z=d),Z>0?0:Math.round(Z)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(O){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(O.property)<0&&this.redraw(),"translateY"===O.property&&(this.iv(),this._43o())},findDataByName:function(T){for(var y=this.dm().getDatas(),o=0;o<y.size();o++){var M=y.get(o);if(M.getName()===T)return M}},setDataModel:function(q){var N=this,J=N._dataModel,B=N._3o;J!==q&&(J&&(J.umm(N.$6h,N),J.umd(N.$8h,N),J.umh(N.$7h,N),B||J.sm().ums(N.$28h,N)),N._dataModel=q,q.mm(N.$6h,N),q.md(N.$8h,N),q.mh(N.$7h,N),B?B._21I(q):q.sm().ms(N.$28h,N),N.sm().setSelectionMode("single"),N.fp("dataModel",J,q))},$6h:function(L){var u=this,h=u._view,l=L.data,n=u.$4h;"add"===L.kind?n[l.getId()]=l:"remove"===L.kind?n[l.getId()]=l:"clear"===L.kind&&(u.$10h={},u.$9h={},u.$4h={},h[P]=""),u.iv()},$7h:function(n){var f=this,V=n.data;f.$4h[V.getId()]=V,f.iv()},$8h:function(G){var o=this,l=G.data,p=G.property;"expanded"===p?o.iv():(o.$4h[l.getId()]=l,o.iv())},$28h:function(){var Z,I=this,U=I.sm(),_="palette-item",q=U.ld();this.dm().each(function(n){Z=I.$10h[n.getId()],Z&&Z[k].indexOf(_)>=0&&(n===q?l(Z,e,N.paletteItemSelectBackground):o(Z,e))})}})}(this,Object);