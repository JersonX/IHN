!function(T,m){"use strict";var Y="position",B="absolute",q="relative",M="px",$="left",V="right",h="top",c="bottom",g="display",n="none",J="block",Z=ht.Default,S=Z.getInternal(),Q=Math.floor,O=Math.ceil,r=Math.PI,F=null,D=T.parseInt,u=function(j){return j.getContext("2d")},j=function(){return document},p=function(S){return j().createElement(S)},X=function(){return p("div")},l=function(){return p("canvas")},C=function(N,y,G){N.style.setProperty(y,G,F)},W=function(N,C,i){Z.def(ht.widget[N],C,i)},a=function(b,M){b.appendChild(M)},K=function(q,B){q.removeChild(B)},v=function(G,D,n,Z){G.addEventListener(D,n,!!Z)},P=function(K,N,A,Q){K.removeEventListener(N,A,!!Q)};ht.widget.RulerFrame=function(O){var w=this,D=w._view=X(),n=w.$1k=l(),m=w.$2k=l(),f=w.$3k=l(),x=w.$4k=l();w._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},w._topRulerConfig={visible:!0},w._rightRulerConfig={visible:!1},w._bottomRulerConfig={visible:!1},w._leftRulerConfig={visible:!0},a(D,n),a(D,f),a(D,m),a(D,x),C(D,Y,q),C(D,"box-sizing","border-box"),C(D,"-moz-box-sizing","border-box"),C(n,Y,B),C(m,Y,B),C(f,Y,B),C(x,Y,B),w.$14k=function(){w.$13k=1,w.iv()},w.$15k=function(F){if(w._topRulerConfig.guideVisible||w._rightRulerConfig.guideVisible||w._bottomRulerConfig.guideVisible||w._leftRulerConfig.guideVisible||w._defaultRulerConfig.guideVisible||(w._topRulerConfig.guideTipVisible||w._rightRulerConfig.guideTipVisible||w._bottomRulerConfig.guideTipVisible||w._leftRulerConfig.guideTipVisible||w._defaultRulerConfig.guideTipVisible)&&w._component){var z=D.getBoundingClientRect();w.$16k={x:F.clientX-z.left,y:F.clientY-z.top},w.$5k()}},w.setComponent(O)},W("RulerFrame",m,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(N){var $=this,O=$._component,E=$.getView();if(E){if($._component=N,$.fp("component",O,N),O){var F=$.getComponentView(O);K(E,F),P(E,"mousemove",$.$15k),$.removeComponentPropertyChangeListener(O,$.$14k)}if(N){var c=$.getComponentView(N);a(E,c),C(c,Y,B),v(E,"mousemove",$.$15k),$.addComponentPropertyChangeListener(N,$.$14k)}}},addComponentPropertyChangeListener:function(T,R){T&&T.mp&&T.mp(R)},removeComponentPropertyChangeListener:function(m,_){m&&m.ump&&m.ump(_)},getComponentHZoom:function(v){return v&&v.getZoom?v.getZoom():1},getComponentVZoom:function(s){return s&&s.getZoom?s.getZoom():1},getComponentViewRect:function(B){return B&&B.getViewRect?B.getViewRect():void 0},getComponentView:function(y){return y&&y.getView?y.getView():y},invalidateComponent:function(b){b&&b.iv&&b.iv()},validateComponent:function(D){D&&D.validate&&D.validate()},$7k:function(I,W,Z,r,f,A,D,e,p,H,u,Y){if(W.visible){var B=this._defaultRulerConfig,R="borderStyle",$="borderColor",t="borderWidth",l="background",K=W[R]||B[R],P=W[$]||B[$],x=W[t]||B[t],a=W.size!=F?W.size:B.size,E=W[l]||B[l],j=a+x,M=this.$6k(x,K,P,I,Z,f,j,D,e,p,H,u,Y);C(I,f,"0px"),A?S.setCanvas(I,r-M,a):S.setCanvas(I,a,r-M),C(I,"background",E),C(I,g,J)}else C(I,g,n),C(this.getComponentView(this._component),f,"0px")},$6k:function(Z,z,v,$,W,j,r,k,g,Y,F,P,B){var s=0;return C($,W,Z+"px "+z+" "+v),C(this.getComponentView(this._component),j,r+M),k?(C($,g,Y+M),s+=Y):C($,g,"0px"),F?(C($,P,B+M),s+=B):C($,P,"0px"),s},validateImpl:function(){var u=this,T=u._component,z=u.$1k,g=u.$2k,B=u.$3k,y=u.$4k,X=u._view,e=u._defaultRulerConfig,C=u._topRulerConfig,N=u._rightRulerConfig,d=u._bottomRulerConfig,r=u._leftRulerConfig,q=e.size;if(X&&T){var b=C.size!=F?C.size:q,G=N.size!=F?N.size:q,J=d.size!=F?d.size:q,R=r.size!=F?r.size:q;u.$7k(z,C,"border-bottom",X.offsetWidth,h,!0,r.visible,$,R,N.visible,V,G),u.$7k(g,N,"border-left",X.offsetHeight,V,!1,C.visible,h,b,d.visible,c,J),u.$7k(B,d,"border-top",X.offsetWidth,c,!0,r.visible,$,R,N.visible,V,G),u.$7k(y,r,"border-right",X.offsetHeight,$,!1,C.visible,h,b,d.visible,c,J),u.$13k?delete u.$13k:u.invalidateComponent(T),u.validateComponent(T),u.$5k()}},$5k:function(){function y(Q,J,D,q,X,R){if(J.visible){var L=u(Q),v=J[O]||c,y=J[b]!=F?J[b]:p,A=J[g]||r,P=J[i]||V,G=J.size!=F?J.size:$,To=J[f]||C,Mi=J[h]||t,lp=J[z]||j,Uc=J[d]!=F?J[d]:U,ip=J[I]!=F?J[I]:Y,Ak=J[W]!=F?J[W]:H,sl=J[a]!=F?J[a]:_,sk=J[B]!=F?J[B]:m,ln=J[Z]!=F?J[Z]:e,ig=J[N]||Rp,ic=J[M]||hm;y&&(v=w[R]=w.$8k(w[R]||v,J[S]||o,J[T]||k,q?x:l,Mi)),D.call(w,L,s,E,K,n,G,q?x:l,v,A,P,X,To,lp);var Rr=w.$16k;(Uc||ip)&&Rr&&(q?w.$9k(L,Rr.x,G,ig,ic,Uc,ip,Ak,sl,sk,ln):w.$10k(L,Rr.y,G,ig,ic,Uc,ip,Ak,sl,sk,ln,X))}}var w=this,R=w.$1k,q=w.$2k,P=w.$3k,J=w.$4k,G=w._topRulerConfig,X=w._rightRulerConfig,Q=w._bottomRulerConfig,D=w._leftRulerConfig,A=w._defaultRulerConfig,L=w._component,v=w.getComponentViewRect(L),x=w.getComponentHZoom(L),l=w.getComponentVZoom(L),s=v.x*x,K=s+v.width*x,E=v.y*l,n=E+v.height*l,$=w._defaultRulerConfig.size,O="defaultMajorTickSpacing",S="maxPhysicalMajorTickSpacing",T="minPhysicalMajorTickSpacing",b="tickSpacingAdaptable",g="majorTickTextFont",i="majorTickTextColor",f="majorTickColor",z="minorTickColor",d="guideVisible",I="guideTipVisible",W="guideTipBorderColor",a="guideTipTextColor",B="guideTipTextFont",Z="guideTipBackground",N="guideColor",M="guideWidth",h="minMajorTickSpacing",c=A[O],o=A[S],k=A[T],p=A[b],r=A[g],V=A[i],C=A[f],t=A[h],j=A[z],U=A[d],Y=A[I],H=A[W],_=A[a],m=A[B],e=A[Z],Rp=A[N],hm=A[M];w._view&&L&&(y(R,G,w.$11k,!0,!1,"_currentTopMajorTickSpacing"),y(q,X,w.$12k,!1,!0,"_currentRightMajorTickSpacing"),y(P,Q,w.$11k,!0,!0,"_currentBottomMajorTickSpacing"),y(J,D,w.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(s,G,x,V,t){return x>s*V?s=Q(G/V/t)*t:s*V>G&&(s=O(x/V/t)*t),s},getHTipText:function(y){var L=this,P=L._component,X=0,e=L._view.getBoundingClientRect();return P.lp?X=D(P.lp({clientX:y.x+e.left,clientY:y.y}).x):X-=D(this.getComponentView(P).style.left)||0,X},$9k:function(M,a,f,G,d,Q,q,$,s,E,b){var m=this,H=m._component;M.save(),S.translateAndScale(M,0,0,1);var p=a-(D(this.getComponentView(H).style.left)||0),I=0;if(a=m.getHTipText(m.$16k),Q&&(M.beginPath(),M.fillStyle=G,M.rect(p,I,d,f),M.fill()),q){M.beginPath(),M.textAlign="center",M.textBaseline="middle",M.font=E;var y=M.measureText(a).width+6;M.fillStyle=b,M.rect(p-y/2,I,y,f),M.fill(),M.strokeStyle=$,M.stroke(),M.beginPath(),M.fillStyle=s,M.fillText(a,p,I+f/2)}M.restore()},getVTipText:function(e){var x=this,O=x._component,k=0,p=x._view.getBoundingClientRect();return O.lp?k=D(O.lp({clientX:e.x,clientY:e.y+p.top}).y):k-=D(this.getComponentView(O).style.top)||0,k},formatScaleText:function(w){return Math.round(w)},$10k:function(o,P,C,f,A,Y,U,v,x,Q,i,K){var L=this,c=L._component;o.save(),S.translateAndScale(o,0,0,1);var V=C/2,E=P-(D(this.getComponentView(c).style.top)||0);if(P=L.getVTipText(L.$16k),Y&&(o.beginPath(),o.fillStyle=f,o.rect(V-C/2,E,C,A),o.fill()),U){o.translate(V,E),o.rotate((K?90:-90)*r/180),o.translate(-V,-E),o.beginPath(),o.textAlign="center",o.textBaseline="middle",o.font=Q;var j=o.measureText(P).width+6;o.fillStyle=i,o.rect(V-j/2,E-C/2,j,C),o.fill(),o.strokeStyle=v,o.stroke(),o.fillStyle=x,o.fillText(P,V,E)}o.restore()},$11k:function($,i,f,U,L,y,e,T,z,G,b,q,A){$.save(),f=0;var E=i,m=U,h=(E+m)/2;i=0,U=m-E,S.translateAndScale($,0,0,1);var K=0,W=0,p=D(y/2),X=y-p,x=b?0:p,I=T*e,C=I/10;i-=I,U+=I,$.clearRect(i,0,U-i,y),$.beginPath(),$.fillStyle=A;var s=Q(h/C)*C-E;for(K=s;U>K;K+=C)$.rect(K,f+x,1,X);for(K=s;K>i;K-=C)$.rect(K,f+x,1,X);for($.fill(),x=b?0:1,$.beginPath(),$.fillStyle=q,s=Q(h/I)*I-E,K=s;U>K;K+=I)$.rect(K,f+x,1,y-1);for(K=s;K>i;K-=I)$.rect(K,f+x,1,y-1);$.fill();var l=D(/\d+px/.exec(z)[0]),B=(l||10)/2;$.textBaseline="middle",x=b?y-B-2:B+2,$.beginPath(),$.fillStyle=G,$.font=z;var N=Q(h/I)*I/e;for(K=s,W=N;U>K;K+=I,W+=T){var v=this.getHScaleText?this.getHScaleText(K):W;$.fillText(this.formatScaleText(v),K+2,f+x)}for(K=s,W=N;K>i;K-=I,W-=T){var v=this.getHScaleText?this.getHScaleText(K):W;$.fillText(this.formatScaleText(v),K+2,f+x)}$.restore()},$12k:function($,h,U,X,_,v,p,Z,N,O,L,I,f){function u(Y,R,Q,A,d,F){d=q.getVScaleText?q.getVScaleText(Q):d,d=q.formatScaleText(d),$.translate(Y+R,Q),$.rotate(-A),$.translate(-Y-R,-Q),$.fillText(d,Y+R+(F?2:1),Q),$.translate(Y+R,Q),$.rotate(A),$.translate(-Y-R,-Q)}$.save(),h=0;var g=U,H=_,w=(g+H)/2;U=0,_=H-g,S.translateAndScale($,0,0,1);var s=0,q=this,y=0,C=D(v/2),b=v-C,W=L?0:C,G=Z*p,J=G/10;U-=G,_+=G,$.clearRect(h,0,v,_-U),$.beginPath(),$.fillStyle=f;var d=Q(w/J)*J-g;for(s=d;_>s;s+=J)$.rect(h+W,s,b,1);for(s=d;s>U;s-=J)$.rect(h+W,s,b,1);for($.fill(),W=L?0:1,$.beginPath(),$.fillStyle=I,d=Q(w/G)*G-g,s=d;_>s;s+=G)$.rect(h+W,s,v-1,1);for(s=d;s>U;s-=G)$.rect(h+W,s,v-1,1);$.fill();var T=D(/\d+px/.exec(N)[0]),x=(T||10)/2,n=90*r/180;$.textBaseline="middle",W=L?v-x:x+2,n=L?-n:n,$.beginPath(),$.fillStyle=O,$.font=N;var R=Q(w/G)*G/p;for(s=d,y=R;_>s;s+=G,y+=Z)u(h,W,s,n,y,L);for(s=d,y=R;s>U;s-=G,y-=Z)u(h,W,s,n,y,L);$.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var X=this,p=X._component,q=X._view;p&&X.removeComponentPropertyChangeListener(p,X.$14k),q&&(P(q,"mousemove",X.$15k),K(q.parentNode,q),X._view=null)}})}(this,Object);