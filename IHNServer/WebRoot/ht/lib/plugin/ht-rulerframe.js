!function(l,M){"use strict";var $="position",Q="absolute",o="relative",S="px",h="left",N="right",G="top",s="bottom",k="display",R="none",Z="block",q=ht.Default,i=q.getInternal(),r=Math.floor,F=Math.ceil,E=Math.PI,t=null,D=l.parseInt,e=function(u){return u.getContext("2d")},g=function(){return document},n=function(F){return g().createElement(F)},x=function(){return n("div")},I=function(){return n("canvas")},b=function(l,G,T){l.style.setProperty(G,T,t)},K=function(J,y,W){q.def(ht.widget[J],y,W)},L=function(M,N){M.appendChild(N)},T=function(v,b){v.removeChild(b)},j=function(r,C,L,v){r.addEventListener(C,L,!!v)},C=function(d,Y,D,s){d.removeEventListener(Y,D,!!s)};ht.widget.RulerFrame=function(s){var y=this,d=y._view=x(),Y=y.$1k=I(),f=y.$2k=I(),X=y.$3k=I(),P=y.$4k=I();y._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},y._topRulerConfig={visible:!0},y._rightRulerConfig={visible:!1},y._bottomRulerConfig={visible:!1},y._leftRulerConfig={visible:!0},L(d,Y),L(d,X),L(d,f),L(d,P),b(d,$,o),b(d,"box-sizing","border-box"),b(d,"-moz-box-sizing","border-box"),b(Y,$,Q),b(f,$,Q),b(X,$,Q),b(P,$,Q),y.$14k=function(){y.$13k=1,y.iv()},y.$15k=function(S){if(y._topRulerConfig.guideVisible||y._rightRulerConfig.guideVisible||y._bottomRulerConfig.guideVisible||y._leftRulerConfig.guideVisible||y._defaultRulerConfig.guideVisible||(y._topRulerConfig.guideTipVisible||y._rightRulerConfig.guideTipVisible||y._bottomRulerConfig.guideTipVisible||y._leftRulerConfig.guideTipVisible||y._defaultRulerConfig.guideTipVisible)&&y._component){var z=d.getBoundingClientRect();y.$16k={x:S.clientX-z.left,y:S.clientY-z.top},y.$5k()}},y.setComponent(s)},K("RulerFrame",M,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(U){var O=this,H=O._component,p=O.getView();if(p){if(O._component=U,O.fp("component",H,U),H){var Y=O.getComponentView(H);T(p,Y),C(p,"mousemove",O.$15k),O.removeComponentPropertyChangeListener(H,O.$14k)}if(U){var R=O.getComponentView(U);L(p,R),b(R,$,Q),j(p,"mousemove",O.$15k),O.addComponentPropertyChangeListener(U,O.$14k)}}},addComponentPropertyChangeListener:function(x,u){x&&x.mp&&x.mp(u)},removeComponentPropertyChangeListener:function(q,l){q&&q.ump&&q.ump(l)},getComponentHZoom:function(g){return g&&g.getZoom?g.getZoom():1},getComponentVZoom:function(L){return L&&L.getZoom?L.getZoom():1},getComponentViewRect:function(I){return I&&I.getViewRect?I.getViewRect():void 0},getComponentView:function(Q){return Q&&Q.getView?Q.getView():Q},invalidateComponent:function(V){V&&V.iv&&V.iv()},validateComponent:function(I){I&&I.validate&&I.validate()},$7k:function(Q,h,W,$,V,c,T,P,m,B,p,l){if(h.visible){var L=this._defaultRulerConfig,H="borderStyle",F="borderColor",D="borderWidth",v="background",e=h[H]||L[H],y=h[F]||L[F],Y=h[D]||L[D],J=h.size!=t?h.size:L.size,U=h[v]||L[v],o=J+Y,f=this.$6k(Y,e,y,Q,W,V,o,T,P,m,B,p,l);b(Q,V,"0px"),c?i.setCanvas(Q,$-f,J):i.setCanvas(Q,J,$-f),b(Q,"background",U),b(Q,k,Z)}else b(Q,k,R),b(this.getComponentView(this._component),V,"0px")},$6k:function(J,H,y,k,L,U,q,Y,_,v,l,B,F){var h=0;return b(k,L,J+"px "+H+" "+y),b(this.getComponentView(this._component),U,q+S),Y?(b(k,_,v+S),h+=v):b(k,_,"0px"),l?(b(k,B,F+S),h+=F):b(k,B,"0px"),h},validateImpl:function(){var l=this,u=l._component,J=l.$1k,g=l.$2k,D=l.$3k,H=l.$4k,O=l._view,c=l._defaultRulerConfig,k=l._topRulerConfig,V=l._rightRulerConfig,B=l._bottomRulerConfig,q=l._leftRulerConfig,W=c.size;if(O&&u){var Q=k.size!=t?k.size:W,L=V.size!=t?V.size:W,r=B.size!=t?B.size:W,d=q.size!=t?q.size:W;l.$7k(J,k,"border-bottom",O.offsetWidth,G,!0,q.visible,h,d,V.visible,N,L),l.$7k(g,V,"border-left",O.offsetHeight,N,!1,k.visible,G,Q,B.visible,s,r),l.$7k(D,B,"border-top",O.offsetWidth,s,!0,q.visible,h,d,V.visible,N,L),l.$7k(H,q,"border-right",O.offsetHeight,h,!1,k.visible,G,Q,B.visible,s,r),l.$13k?delete l.$13k:l.invalidateComponent(u),l.validateComponent(u),l.$5k()}},$5k:function(){function E(E,g,c,l,j,J){if(g.visible){var N=e(E),a=g[V]||C,p=g[z]!=t?g[z]:H,i=g[f]||s,I=g[k]||n,o=g.size!=t?g.size:O,Yk=g[R]||K,re=g[G]||T,cl=g[F]||U,vf=g[r]!=t?g[r]:M,Po=g[w]!=t?g[w]:d,db=g[q]!=t?g[q]:h,rp=g[Y]!=t?g[Y]:B,Ae=g[X]!=t?g[X]:P,yq=g[_]!=t?g[_]:A,Jj=g[b]||Dj,ci=g[m]||ge;p&&(a=Z[J]=Z.$8k(Z[J]||a,g[u]||v,g[L]||Q,l?W:$,re)),c.call(Z,N,y,x,S,D,o,l?W:$,a,i,I,j,Yk,cl);var $j=Z.$16k;(vf||Po)&&$j&&(l?Z.$9k(N,$j.x,o,Jj,ci,vf,Po,db,rp,Ae,yq):Z.$10k(N,$j.y,o,Jj,ci,vf,Po,db,rp,Ae,yq,j))}}var Z=this,a=Z.$1k,o=Z.$2k,j=Z.$3k,N=Z.$4k,J=Z._topRulerConfig,c=Z._rightRulerConfig,p=Z._bottomRulerConfig,l=Z._leftRulerConfig,i=Z._defaultRulerConfig,I=Z._component,g=Z.getComponentViewRect(I),W=Z.getComponentHZoom(I),$=Z.getComponentVZoom(I),y=g.x*W,S=y+g.width*W,x=g.y*$,D=x+g.height*$,O=Z._defaultRulerConfig.size,V="defaultMajorTickSpacing",u="maxPhysicalMajorTickSpacing",L="minPhysicalMajorTickSpacing",z="tickSpacingAdaptable",f="majorTickTextFont",k="majorTickTextColor",R="majorTickColor",F="minorTickColor",r="guideVisible",w="guideTipVisible",q="guideTipBorderColor",Y="guideTipTextColor",X="guideTipTextFont",_="guideTipBackground",b="guideColor",m="guideWidth",G="minMajorTickSpacing",C=i[V],v=i[u],Q=i[L],H=i[z],s=i[f],n=i[k],K=i[R],T=i[G],U=i[F],M=i[r],d=i[w],h=i[q],B=i[Y],P=i[X],A=i[_],Dj=i[b],ge=i[m];Z._view&&I&&(E(a,J,Z.$11k,!0,!1,"_currentTopMajorTickSpacing"),E(o,c,Z.$12k,!1,!0,"_currentRightMajorTickSpacing"),E(j,p,Z.$11k,!0,!0,"_currentBottomMajorTickSpacing"),E(N,l,Z.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(Q,A,G,b,W){return G>Q*b?Q=r(A/b/W)*W:Q*b>A&&(Q=F(G/b/W)*W),Q},getHTipText:function(p){var s=this,y=s._component,I=0,L=s._view.getBoundingClientRect();return y.lp?I=D(y.lp({clientX:p.x+L.left,clientY:p.y}).x):I-=D(this.getComponentView(y).style.left)||0,I},$9k:function(n,H,s,R,T,p,k,L,u,z,y){var V=this,O=V._component;n.save(),i.translateAndScale(n,0,0,1);var q=H-(D(this.getComponentView(O).style.left)||0),X=0;if(H=V.getHTipText(V.$16k),p&&(n.beginPath(),n.fillStyle=R,n.rect(q,X,T,s),n.fill()),k){n.beginPath(),n.textAlign="center",n.textBaseline="middle",n.font=z;var W=n.measureText(H).width+6;n.fillStyle=y,n.rect(q-W/2,X,W,s),n.fill(),n.strokeStyle=L,n.stroke(),n.beginPath(),n.fillStyle=u,n.fillText(H,q,X+s/2)}n.restore()},getVTipText:function(A){var Q=this,F=Q._component,f=0,U=Q._view.getBoundingClientRect();return F.lp?f=D(F.lp({clientX:A.x,clientY:A.y+U.top}).y):f-=D(this.getComponentView(F).style.top)||0,f},formatScaleText:function(g){return Math.round(g)},$10k:function(F,P,v,W,n,N,p,m,j,U,d,y){var Q=this,k=Q._component;F.save(),i.translateAndScale(F,0,0,1);var u=v/2,H=P-(D(this.getComponentView(k).style.top)||0);if(P=Q.getVTipText(Q.$16k),N&&(F.beginPath(),F.fillStyle=W,F.rect(u-v/2,H,v,n),F.fill()),p){F.translate(u,H),F.rotate((y?90:-90)*E/180),F.translate(-u,-H),F.beginPath(),F.textAlign="center",F.textBaseline="middle",F.font=U;var K=F.measureText(P).width+6;F.fillStyle=d,F.rect(u-K/2,H-v/2,K,v),F.fill(),F.strokeStyle=m,F.stroke(),F.fillStyle=j,F.fillText(P,u,H)}F.restore()},$11k:function(m,V,k,g,R,l,e,d,A,Q,M,p,a){m.save(),k=0;var U=V,Z=g,T=(U+Z)/2;V=0,g=Z-U,i.translateAndScale(m,0,0,1);var X=0,h=0,W=D(l/2),G=l-W,_=M?0:W,$=d*e,o=$/10;V-=$,g+=$,m.clearRect(V,0,g-V,l),m.beginPath(),m.fillStyle=a;var s=r(T/o)*o-U;for(X=s;g>X;X+=o)m.rect(X,k+_,1,G);for(X=s;X>V;X-=o)m.rect(X,k+_,1,G);for(m.fill(),_=M?0:1,m.beginPath(),m.fillStyle=p,s=r(T/$)*$-U,X=s;g>X;X+=$)m.rect(X,k+_,1,l-1);for(X=s;X>V;X-=$)m.rect(X,k+_,1,l-1);m.fill();var O=D(/\d+px/.exec(A)[0]),B=(O||10)/2;m.textBaseline="middle",_=M?l-B-2:B+2,m.beginPath(),m.fillStyle=Q,m.font=A;var n=r(T/$)*$/e;for(X=s,h=n;g>X;X+=$,h+=d){var t=this.getHScaleText?this.getHScaleText(X):h;m.fillText(this.formatScaleText(t),X+2,k+_)}for(X=s,h=n;X>V;X-=$,h-=d){var t=this.getHScaleText?this.getHScaleText(X):h;m.fillText(this.formatScaleText(t),X+2,k+_)}m.restore()},$12k:function(w,K,W,u,I,G,l,k,o,U,s,q,_){function O(Q,U,y,c,R,S){R=h.getVScaleText?h.getVScaleText(y):R,R=h.formatScaleText(R),w.translate(Q+U,y),w.rotate(-c),w.translate(-Q-U,-y),w.fillText(R,Q+U+(S?2:1),y),w.translate(Q+U,y),w.rotate(c),w.translate(-Q-U,-y)}w.save(),K=0;var m=W,P=I,N=(m+P)/2;W=0,I=P-m,i.translateAndScale(w,0,0,1);var S=0,h=this,L=0,y=D(G/2),z=G-y,b=s?0:y,C=k*l,Q=C/10;W-=C,I+=C,w.clearRect(K,0,G,I-W),w.beginPath(),w.fillStyle=_;var B=r(N/Q)*Q-m;for(S=B;I>S;S+=Q)w.rect(K+b,S,z,1);for(S=B;S>W;S-=Q)w.rect(K+b,S,z,1);for(w.fill(),b=s?0:1,w.beginPath(),w.fillStyle=q,B=r(N/C)*C-m,S=B;I>S;S+=C)w.rect(K+b,S,G-1,1);for(S=B;S>W;S-=C)w.rect(K+b,S,G-1,1);w.fill();var J=D(/\d+px/.exec(o)[0]),v=(J||10)/2,e=90*E/180;w.textBaseline="middle",b=s?G-v:v+2,e=s?-e:e,w.beginPath(),w.fillStyle=U,w.font=o;var j=r(N/C)*C/l;for(S=B,L=j;I>S;S+=C,L+=k)O(K,b,S,e,L,s);for(S=B,L=j;S>W;S-=C,L-=k)O(K,b,S,e,L,s);w.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var P=this,q=P._component,Y=P._view;q&&P.removeComponentPropertyChangeListener(q,P.$14k),Y&&(C(Y,"mousemove",P.$15k),T(Y.parentNode,Y),P._view=null)}})}(this,Object);