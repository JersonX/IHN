!function(Q){"use strict";var e="ht",y=Q[e],p=Math,j=p.max,S=p.min,C=p.abs,i=p.atan2,I=p.cos,L=p.sin,U=p.ceil,n=y.Default,x=n.getInternal(),w=y.List,c=x.Mat,u=x.getNodeRect,M=x.intersectionLineRect,X=n.getDistance,P=n.setEdgeType,o="left",k="right",K="top",B="bottom",d="edge.type",T="edge.gap",a="edge.center",s="edge.extend",Y=function(K,i){return u(K,i).width},D=function(p,U){return u(p,U).height},F=function(o,_){var t=x.getPosition(_.s("edge.source.position"),u(o,_._40I));return t.x+=_.s("edge.source.offset.x"),t.y+=_.s("edge.source.offset.y"),t},O=function(L,X){var s=x.getPosition(X.s("edge.target.position"),u(L,X._41I));return s.x+=X.s("edge.target.offset.x"),s.y+=X.s("edge.target.offset.y"),s},g=function(u,O){var U=u.s(d),Z=u.getEdgeGroup();if(Z){var c=0;if(Z.eachSiblingEdge(function(M){O.isVisible(M)&&M.s(d)==U&&c++}),c>1)return u.s(T)*(c-1)/2}return 0},h=function(n,U){var u=n.s(d),K=n.isLooped();if(!n.getEdgeGroup())return K?n.s(T):0;var j,M=0,i=0,Q=0;return n.getEdgeGroup().getSiblings().each(function(P){P.each(function(r){if(r._40I===n._40I&&r.s(d)==u&&U.isVisible(r)){var e=r.s(T);j?(i+=Q/2+e/2,Q=e):(j=r,Q=e),r===n&&(M=i)}})}),K?i-M+Q:M-i/2},m=function(_,E){var Q=_.size(),V=E.s("edge.corner.radius");if(0===V)return{points:_,segments:new w([1,Q])};if(0>V)return{points:_};var n,z=new w,O=new w,D=_.get(0);z.add(D),O.add(1);for(var k=1;Q>k;k++)if(Q>k+1){var M=_.get(k),R=_.get(k+1),Z=D.x,j=D.y,J=M.x,r=M.y,o=r-j,m=J-Z,b=i(o,m);n=S(.99*X(D,M),V),z.add({x:J-n*I(b),y:r-n*L(b)}),z.add(M),Z=M.x,j=M.y,J=R.x,r=R.y,o=r-j,m=J-Z,b=i(o,m),n=S(.99*X(M,R),V),D={x:Z+n*I(b),y:j+n*L(b)},z.add(D),O.addAll([2,3])}else z.add(_.get(k)),O.add(2);return{points:z,segments:O}};x.addMethod(y.Style,{"edge.ripple.elevation":-20,"edge.ripple.size":1,"edge.ripple.both":!1,"edge.ripple.straight":!1,"edge.ripple.length":-1,"edge.corner.radius":-1,"edge.ortho":.5,"edge.flex":20,"edge.extend":20},!0),P("boundary",function(v,n,T,j){j||(n=-n);var d,R=F(T,v),B=O(T,v),Z=u(T,v._40I),_=u(T,v._41I),h=new c(i(B.y-R.y,B.x-R.x)),q=X(R,B),s=R.x,P=R.y;return d=h.tf(0,n),R={x:d.x+s,y:d.y+P},d=h.tf(q,n),B={x:d.x+s,y:d.y+P},d=M(R,B,Z),d&&(R={x:d[0],y:d[1]}),d=M(R,B,_),d&&(B={x:d[0],y:d[1]}),{points:new w([R,B])}}),P("ripple",function(n,b,l,I){I||(b=-b);var C=F(l,n),H=O(l,n),R=X(C,H),k=S(n.s("edge.offset"),R/2),E=n.s("edge.ripple.size"),m=n.s("edge.ripple.length"),M=n.s("edge.ripple.both"),d=n.s(a),Z=n.s("edge.ripple.elevation"),G=new w,P=n.s("edge.ripple.straight")?null:new w,o=new c(i(H.y-C.y,H.x-C.x));I||(Z=-Z),R-=2*k,m>0&&(E=U(R/m));var N=R/E;P&&P.add(1);for(var u=0;E>u;u++)P&&P.add(3),0===u?G.add({x:k+N*u,y:d?0:b}):G.add({x:k+N*u,y:b}),G.add({x:k+N*u+N/2,y:Z+b}),M&&(Z=-Z);for(G.add({x:k+R,y:d?0:b}),u=0;u<G.size();u++){var e=o.tf(G.get(u));e.x+=C.x,e.y+=C.y,G.set(u,e)}return{points:G,segments:P}}),P("h.v",function(u,A,P){A=h(u,P);var N=new w,n=u.s(a),L=F(P,u),s=L.x,l=L.y,B=O(P,u),x=B.x,G=B.y,t=0,j=0,g=x-s,V=G-l;return n||(t=Y(P,u._40I)/2,j=D(P,u._41I)/2),g>=0&&0>=V?(N.add({x:s+t,y:l+A}),N.add({x:x+A,y:l+A}),N.add({x:x+A,y:G+j})):0>=g&&V>=0?(N.add({x:s-t,y:l+A}),N.add({x:x+A,y:l+A}),N.add({x:x+A,y:G-j})):g>=0&&V>=0?(N.add({x:s+t,y:l+A}),N.add({x:x-A,y:l+A}),N.add({x:x-A,y:G-j})):(N.add({x:s-t,y:l+A}),N.add({x:x-A,y:l+A}),N.add({x:x-A,y:G+j})),m(N,u)}),P("v.h",function(J,S,c){S=h(J,c);var z=new w,s=J.s(a),C=F(c,J),G=C.x,e=C.y,y=O(c,J),o=y.x,b=y.y,u=0,I=0,A=o-G,R=b-e;return s||(u=Y(c,J._41I)/2,I=D(c,J._40I)/2),A>=0&&0>=R?(z.add({x:G+S,y:e-I}),z.add({x:G+S,y:b+S}),z.add({x:o-u,y:b+S})):0>=A&&R>=0?(z.add({x:G+S,y:e+I}),z.add({x:G+S,y:b+S}),z.add({x:o+u,y:b+S})):A>=0&&R>=0?(z.add({x:G-S,y:e+I}),z.add({x:G-S,y:b+S}),z.add({x:o-u,y:b+S})):(z.add({x:G-S,y:e-I}),z.add({x:G-S,y:b+S}),z.add({x:o+u,y:b+S})),m(z,J)}),P("ortho",function(n,E,b){var M=new w,u=n.s(a),H=n.s("edge.ortho"),_=n._40I,e=n._41I,J=F(b,n),G=J.x,s=J.y,X=O(b,n),U=X.x,k=X.y,$=U-G,L=k-s,W=u?0:Y(b,_)/2,B=u?0:D(b,_)/2,T=u?0:Y(b,e)/2,j=u?0:D(b,e)/2,P=($-(W+T)*($>0?1:-1))*H,I=(L-(B+j)*(L>0?1:-1))*H;return C($)<C(L)?$>=0&&0>=L?(M.add({x:G+E,y:s-B}),M.add({x:G+E,y:s+I+E-B}),M.add({x:U+E,y:s+I+E-B}),M.add({x:U+E,y:k+j})):0>=$&&L>=0?(M.add({x:G+E,y:s+B}),M.add({x:G+E,y:s+I+E+B}),M.add({x:U+E,y:s+I+E+B}),M.add({x:U+E,y:k-j})):$>=0&&L>=0?(M.add({x:G+E,y:s+B}),M.add({x:G+E,y:s+I-E+B}),M.add({x:U+E,y:s+I-E+B}),M.add({x:U+E,y:k-j})):(M.add({x:G+E,y:s-B}),M.add({x:G+E,y:s+I-E-B}),M.add({x:U+E,y:s+I-E-B}),M.add({x:U+E,y:k+j})):$>=0&&0>=L?(M.add({x:G+W,y:s+E}),M.add({x:G+P+E+W,y:s+E}),M.add({x:G+P+E+W,y:k+E}),M.add({x:U-T,y:k+E})):0>=$&&L>=0?(M.add({x:G-W,y:s+E}),M.add({x:G+P+E-W,y:s+E}),M.add({x:G+P+E-W,y:k+E}),M.add({x:U+T,y:k+E})):$>=0&&L>=0?(M.add({x:G+W,y:s+E}),M.add({x:G+P-E+W,y:s+E}),M.add({x:G+P-E+W,y:k+E}),M.add({x:U-T,y:k+E})):(M.add({x:G-W,y:s+E}),M.add({x:G+P-E-W,y:s+E}),M.add({x:G+P-E-W,y:k+E}),M.add({x:U+T,y:k+E})),m(M,n)}),P("flex",function(k,V,v){var X=new w,J=k.s("edge.flex")+g(k,v),G=k.s(a),b=k._40I,o=k._41I,c=F(v,k),j=c.x,l=c.y,t=O(v,k),Q=t.x,x=t.y,Z=Q-j,M=x-l,A=G?0:Y(v,b)/2,f=G?0:D(v,b)/2,$=G?0:Y(v,o)/2,q=G?0:D(v,o)/2,U=Z>0?J:-J,N=M>0?J:-J;return C(Z)<C(M)?Z>=0&&0>=M?(X.add({x:j+V,y:l-f}),X.add({x:j+V,y:l+N+V-f}),X.add({x:Q+V,y:x-N+V+q}),X.add({x:Q+V,y:x+q})):0>=Z&&M>=0?(X.add({x:j+V,y:l+f}),X.add({x:j+V,y:l+N+V+f}),X.add({x:Q+V,y:x-N+V-q}),X.add({x:Q+V,y:x-q})):Z>=0&&M>=0?(X.add({x:j+V,y:l+f}),X.add({x:j+V,y:l+N-V+f}),X.add({x:Q+V,y:x-N-V-q}),X.add({x:Q+V,y:x-q})):(X.add({x:j+V,y:l-f}),X.add({x:j+V,y:l+N-V-f}),X.add({x:Q+V,y:x-N-V+q}),X.add({x:Q+V,y:x+q})):Z>=0&&0>=M?(X.add({x:j+A,y:l+V}),X.add({x:j+U+V+A,y:l+V}),X.add({x:Q-U+V-$,y:x+V}),X.add({x:Q-$,y:x+V})):0>=Z&&M>=0?(X.add({x:j-A,y:l+V}),X.add({x:j+U+V-A,y:l+V}),X.add({x:Q-U+V+$,y:x+V}),X.add({x:Q+$,y:x+V})):Z>=0&&M>=0?(X.add({x:j+A,y:l+V}),X.add({x:j+U-V+A,y:l+V}),X.add({x:Q-U-V-$,y:x+V}),X.add({x:Q-$,y:x+V})):(X.add({x:j-A,y:l+V}),X.add({x:j+U-V-A,y:l+V}),X.add({x:Q-U-V+$,y:x+V}),X.add({x:Q+$,y:x+V})),m(X,k)}),P("extend.east",function(I,G,K){var u=new w,L=I.s(s)+g(I,K),M=I.s(a),C=F(K,I),J=C.x+(M?0:Y(K,I._40I)/2),B=C.y,H=O(K,I),e=H.x+(M?0:Y(K,I._41I)/2),p=H.y,x=j(J,e)+L;return B>p?(u.add({x:J,y:B+G}),u.add({x:x+G,y:B+G}),u.add({x:x+G,y:p-G}),u.add({x:e,y:p-G})):(u.add({x:J,y:B-G}),u.add({x:x+G,y:B-G}),u.add({x:x+G,y:p+G}),u.add({x:e,y:p+G})),m(u,I)}),P("extend.west",function(q,t,e){var A=new w,M=q.s(s)+g(q,e),E=q.s(a),r=F(e,q),P=r.x-(E?0:Y(e,q._40I)/2),K=r.y,p=O(e,q),N=p.x-(E?0:Y(e,q._41I)/2),W=p.y,h=S(P,N)-M;return K>W?(A.add({x:P,y:K+t}),A.add({x:h-t,y:K+t}),A.add({x:h-t,y:W-t}),A.add({x:N,y:W-t})):(A.add({x:P,y:K-t}),A.add({x:h-t,y:K-t}),A.add({x:h-t,y:W+t}),A.add({x:N,y:W+t})),m(A,q)}),P("extend.north",function(b,l,E){var T=new w,f=b.s(s)+g(b,E),c=b.s(a),G=F(E,b),q=G.x,I=G.y-(c?0:D(E,b._40I)/2),C=O(E,b),p=C.x,t=C.y-(c?0:D(E,b._41I)/2),y=S(I,t)-f;return q>p?(T.add({y:I,x:q+l}),T.add({y:y-l,x:q+l}),T.add({y:y-l,x:p-l}),T.add({y:t,x:p-l})):(T.add({y:I,x:q-l}),T.add({y:y-l,x:q-l}),T.add({y:y-l,x:p+l}),T.add({y:t,x:p+l})),m(T,b)}),P("extend.south",function(C,d,b){var Z=new w,E=C.s(s)+g(C,b),N=C.s(a),P=F(b,C),H=P.x,e=P.y+(N?0:D(b,C._40I)/2),o=O(b,C),p=o.x,l=o.y+(N?0:D(b,C._41I)/2),_=j(e,l)+E;return H>p?(Z.add({y:e,x:H+d}),Z.add({y:_+d,x:H+d}),Z.add({y:_+d,x:p-d}),Z.add({y:l,x:p-d})):(Z.add({y:e,x:H-d}),Z.add({y:_+d,x:H-d}),Z.add({y:_+d,x:p+d}),Z.add({y:l,x:p+d})),m(Z,C)});var _=function(L,K,$,z,O){if(z.sort(function(q,x){var Y=q.getSourceAgent()===K?q.getTargetAgent():q.getSourceAgent(),L=x.getSourceAgent()===K?x.getTargetAgent():x.getSourceAgent(),S=Y.p(),y=L.p();if($===o||$===k){if(S.y>y.y)return 1;if(S.y<y.y)return-1}else{if(S.x>y.x)return 1;if(S.x<y.x)return-1}return n.sortFunc(q.getId(),x.getId())}),O){for(var t,Q,P,U=L.getSourceAgent(),f=L.getTargetAgent(),R=0;R<z.size();R++){var m=z.get(R);m.getSourceAgent()===U&&m.getTargetAgent()===f||m.getTargetAgent()===U&&m.getSourceAgent()===f?(Q||(Q=new w),Q.add(m,0)):Q?(P||(P=new w),P.add(m)):(t||(t=new w),t.add(m))}z.clear(),t&&z.addAll(t),Q&&z.addAll(Q),P&&z.addAll(P)}var W=z.indexOf(L),F=z.size(),H=L.s(T);return{side:$,index:W,size:F,offset:-H*(F-1)/2+H*W}},Z=function(f,O,F,E,w){var C=O.s(d);return _(O,F,E,F.getAgentEdges().toList(function(Y){return f.isVisible(Y)&&Y.s(d)===C}),w)},t=function(X,Q){var W=X.getSourceAgent()===Q?X.getTargetAgent():X.getSourceAgent(),O=Q.p(),G=W.p(),$=G.x-O.x,U=G.y-O.y;return $>0&&C(U)<=$?k:0>$&&C(U)<=-$?o:U>0&&C($)<=U?B:K},R=function(L,w,o){var N=w.s(d),h=t(w,o);return _(w,o,h,o.getAgentEdges().toList(function(O){return L.isVisible(O)&&O.s(d)===N&&t(O,o)===h}))},A=function(N,v){var s=N.getSourceAgent()===v,z=s?N.getTargetAgent():N.getSourceAgent(),R=v.p(),$=z.p();return s?R.y>$.y?K:B:R.x<$.x?k:o},W=function(J,l,z){var H=l.s(d),F=A(l,z);return _(l,z,F,z.getAgentEdges().toList(function(i){return J.isVisible(i)&&i.s(d)===H&&A(i,z)===F}),F===k||F===B)},V=function(m,t){var v=m.getSourceAgent()===t,r=v?m.getTargetAgent():m.getSourceAgent(),Y=t.p(),i=r.p();return v?Y.x<i.x?k:o:Y.y>i.y?K:B},r=function(m,b,z){var D=b.s(d),h=V(b,z);return _(b,z,h,z.getAgentEdges().toList(function(W){return m.isVisible(W)&&W.s(d)===D&&V(W,z)===h}),h===k||h===B)},f=function(A,y,u){var O=A.getSourceAgent(),S=A.getTargetAgent(),F=O.getId()>S.getId(),p=F?S:O,V=F?O:S,W=p.p(),Q=V.p(),N=u(y,A,p),J=u(y,A,V),i=A.s(a),d=i?0:Y(y,p)/2,n=i?0:Y(y,V)/2,H=i?0:D(y,p)/2,h=i?0:D(y,V)/2,I=N.offset,t=J.offset,R=N.side,v=J.side,P=new w;return R===K?(P.add({x:W.x+I,y:W.y-H}),P.add({x:W.x+I,y:Q.y+t}),v===o?P.add({x:Q.x-n,y:Q.y+t}):P.add({x:Q.x+n,y:Q.y+t})):R===B?(P.add({x:W.x+I,y:W.y+H}),P.add({x:W.x+I,y:Q.y+t}),v===o?P.add({x:Q.x-n,y:Q.y+t}):P.add({x:Q.x+n,y:Q.y+t})):R===o?(P.add({x:W.x-d,y:W.y+I}),P.add({x:Q.x+t,y:W.y+I}),v===B?P.add({x:Q.x+t,y:Q.y+h}):P.add({x:Q.x+t,y:Q.y-h})):R===k&&(P.add({x:W.x+d,y:W.y+I}),P.add({x:Q.x+t,y:W.y+I}),v===B?P.add({x:Q.x+t,y:Q.y+h}):P.add({x:Q.x+t,y:Q.y-h})),F&&P.reverse(),m(P,A)};P("ortho2",function(h,u,s){var i,j,S=h.s(a),I=h.s("edge.ortho"),x=h.getSourceAgent(),F=h.getTargetAgent(),e=x.getId()>F.getId(),C=e?F:x,v=e?x:F,f=C.p(),U=v.p(),L=R(s,h,C),T=R(s,h,v),g=S?0:Y(s,C)/2,Q=S?0:D(s,C)/2,q=S?0:Y(s,v)/2,M=S?0:D(s,v)/2,J=new w,A=L.offset,W=T.offset,V=L.side;return V===k?(i=U.y>f.y?-A:A,j=f.x+g+(U.x-q-f.x-g)*I,J.add({x:f.x+g,y:f.y+A}),J.add({x:j+i,y:f.y+A}),J.add({x:j+i,y:U.y+W}),J.add({x:U.x-q,y:U.y+W})):V===o?(i=U.y>f.y?-A:A,j=f.x-g-(f.x-g-U.x-q)*I,J.add({x:f.x-g,y:f.y+A}),J.add({x:j-i,y:f.y+A}),J.add({x:j-i,y:U.y+W}),J.add({x:U.x+q,y:U.y+W})):V===B?(i=U.x>f.x?-A:A,j=f.y+Q+(U.y-M-f.y-Q)*I,J.add({x:f.x+A,y:f.y+Q}),J.add({x:f.x+A,y:j+i}),J.add({x:U.x+W,y:j+i}),J.add({x:U.x+W,y:U.y-M})):V===K&&(i=U.x>f.x?-A:A,j=f.y-Q-(f.y-Q-U.y-M)*I,J.add({x:f.x+A,y:f.y-Q}),J.add({x:f.x+A,y:j-i}),J.add({x:U.x+W,y:j-i}),J.add({x:U.x+W,y:U.y+M})),e&&J.reverse(),m(J,h)},!0),P("flex2",function(r,z,Z){var G,g=r.getSourceAgent(),E=r.getTargetAgent(),u=g.getId()>E.getId(),h=u?E:g,X=u?g:E,C=h.p(),I=X.p(),d=R(Z,r,h),$=R(Z,r,X),t=r.s(a),J=r.s("edge.flex")+(d.size-1)/2*r.s(T),_=t?0:Y(Z,h)/2,e=t?0:D(Z,h)/2,Q=t?0:Y(Z,X)/2,O=t?0:D(Z,X)/2,U=new w,p=d.offset,f=$.offset,N=d.side;return N===k?(G=I.y>C.y?-p:p,U.add({x:C.x+_,y:C.y+p}),U.add({x:C.x+_+J+G,y:C.y+p}),U.add({x:I.x-Q-J+G,y:I.y+f}),U.add({x:I.x-Q,y:I.y+f})):N===o?(G=I.y>C.y?-p:p,U.add({x:C.x-_,y:C.y+p}),U.add({x:C.x-_-J-G,y:C.y+p}),U.add({x:I.x+Q+J-G,y:I.y+f}),U.add({x:I.x+Q,y:I.y+f})):N===B?(G=I.x>C.x?-p:p,U.add({x:C.x+p,y:C.y+e}),U.add({x:C.x+p,y:C.y+e+J+G}),U.add({x:I.x+f,y:I.y-O-J+G}),U.add({x:I.x+f,y:I.y-O})):N===K&&(G=I.x>C.x?-p:p,U.add({x:C.x+p,y:C.y-e}),U.add({x:C.x+p,y:C.y-e-J-G}),U.add({x:I.x+f,y:I.y+O+J-G}),U.add({x:I.x+f,y:I.y+O})),u&&U.reverse(),m(U,r)},!0),P("extend.north2",function(W,F,p){var y=W.getSourceAgent(),R=W.getTargetAgent(),o=y.getId()>R.getId(),Q=o?R:y,E=o?y:R,u=Q.p(),r=E.p(),e=Z(p,W,Q,K),M=Z(p,W,E,K,!0),c=W.s(a),C=c?0:D(p,Q)/2,O=c?0:D(p,E)/2,I=e.offset,d=M.offset,X=W.s(s)+(e.size-1)/2*W.s(T),V=S(u.y-C,r.y-O)-X+(u.x<r.x?I:-I),U=new w;return U.add({x:u.x+I,y:u.y-C}),U.add({x:u.x+I,y:V}),U.add({x:r.x+d,y:V}),U.add({x:r.x+d,y:r.y-O}),o&&U.reverse(),m(U,W)},!0),P("extend.south2",function(J,H,L){var x=J.getSourceAgent(),v=J.getTargetAgent(),y=x.getId()>v.getId(),I=y?v:x,V=y?x:v,M=I.p(),p=V.p(),h=Z(L,J,I,B),r=Z(L,J,V,B,!0),e=J.s(a),W=e?0:D(L,I)/2,X=e?0:D(L,V)/2,q=h.offset,C=r.offset,S=J.s(s)+(h.size-1)/2*J.s(T),O=j(M.y+W,p.y+X)+S+(M.x>p.x?q:-q),R=new w;return R.add({x:M.x+q,y:M.y+W}),R.add({x:M.x+q,y:O}),R.add({x:p.x+C,y:O}),R.add({x:p.x+C,y:p.y+X}),y&&R.reverse(),m(R,J)},!0),P("extend.west2",function(D,f,o){var e=D.getSourceAgent(),J=D.getTargetAgent(),U=e.getId()>J.getId(),I=U?J:e,u=U?e:J,Q=I.p(),$=u.p(),H=Z(o,D,I,K),j=Z(o,D,u,K,!0),N=D.s(a),O=N?0:Y(o,I)/2,g=N?0:Y(o,u)/2,P=H.offset,V=j.offset,h=D.s(s)+(H.size-1)/2*D.s(T),B=S(Q.x-O,$.x-g)-h+(Q.y<$.y?P:-P),F=new w;return F.add({x:Q.x-O,y:Q.y+P}),F.add({x:B,y:Q.y+P}),F.add({x:B,y:$.y+V}),F.add({x:$.x-g,y:$.y+V}),U&&F.reverse(),m(F,D)},!0),P("extend.east2",function(u,U,d){var G=u.getSourceAgent(),V=u.getTargetAgent(),b=G.getId()>V.getId(),v=b?V:G,f=b?G:V,N=v.p(),r=f.p(),R=Z(d,u,v,K),_=Z(d,u,f,K,!0),q=u.s(a),i=q?0:Y(d,v)/2,x=q?0:Y(d,f)/2,J=R.offset,C=_.offset,e=u.s(s)+(R.size-1)/2*u.s(T),X=j(N.x+i,r.x+x)+e+(N.y>r.y?J:-J),g=new w;return g.add({x:N.x+i,y:N.y+J}),g.add({x:X,y:N.y+J}),g.add({x:X,y:r.y+C}),g.add({x:r.x+x,y:r.y+C}),b&&g.reverse(),m(g,u)},!0),P("v.h2",function(n,k,F){return f(n,F,W)},!0),P("h.v2",function(U,T,o){return f(U,o,r)},!0)}(this,Object);